(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();/**
* @vue/shared v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Fa(e){const t=Object.create(null);for(const n of e.split(","))t[n]=1;return n=>n in t}const vt={},pr=[],Fe=()=>{},vh=()=>!1,Wi=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),Ua=e=>e.startsWith("onUpdate:"),ie=Object.assign,Ba=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},kp=Object.prototype.hasOwnProperty,gt=(e,t)=>kp.call(e,t),et=Array.isArray,mr=e=>xs(e)==="[object Map]",Qi=e=>xs(e)==="[object Set]",Nc=e=>xs(e)==="[object Date]",it=e=>typeof e=="function",Mt=e=>typeof e=="string",He=e=>typeof e=="symbol",At=e=>e!==null&&typeof e=="object",wh=e=>(At(e)||it(e))&&it(e.then)&&it(e.catch),Ih=Object.prototype.toString,xs=e=>Ih.call(e),Lp=e=>xs(e).slice(8,-1),Ah=e=>xs(e)==="[object Object]",ja=e=>Mt(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,as=Fa(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Yi=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},Fp=/-\w/g,wn=Yi(e=>e.replace(Fp,t=>t.slice(1).toUpperCase())),Up=/\B([A-Z])/g,Jn=Yi(e=>e.replace(Up,"-$1").toLowerCase()),bh=Yi(e=>e.charAt(0).toUpperCase()+e.slice(1)),Lo=Yi(e=>e?`on${bh(e)}`:""),gn=(e,t)=>!Object.is(e,t),li=(e,...t)=>{for(let n=0;n<e.length;n++)e[n](...t)},Rh=(e,t,n,r=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:r,value:n})},Ti=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let Oc;const Xi=()=>Oc||(Oc=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function $a(e){if(et(e)){const t={};for(let n=0;n<e.length;n++){const r=e[n],s=Mt(r)?qp(r):$a(r);if(s)for(const i in s)t[i]=s[i]}return t}else if(Mt(e)||At(e))return e}const Bp=/;(?![^(]*\))/g,jp=/:([^]+)/,$p=/\/\*[^]*?\*\//g;function qp(e){const t={};return e.replace($p,"").split(Bp).forEach(n=>{if(n){const r=n.split(jp);r.length>1&&(t[r[0].trim()]=r[1].trim())}}),t}function Ji(e){let t="";if(Mt(e))t=e;else if(et(e))for(let n=0;n<e.length;n++){const r=Ji(e[n]);r&&(t+=r+" ")}else if(At(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}const Hp="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",zp=Fa(Hp);function Sh(e){return!!e||e===""}function Kp(e,t){if(e.length!==t.length)return!1;let n=!0;for(let r=0;n&&r<e.length;r++)n=Zi(e[r],t[r]);return n}function Zi(e,t){if(e===t)return!0;let n=Nc(e),r=Nc(t);if(n||r)return n&&r?e.getTime()===t.getTime():!1;if(n=He(e),r=He(t),n||r)return e===t;if(n=et(e),r=et(t),n||r)return n&&r?Kp(e,t):!1;if(n=At(e),r=At(t),n||r){if(!n||!r)return!1;const s=Object.keys(e).length,i=Object.keys(t).length;if(s!==i)return!1;for(const a in e){const l=e.hasOwnProperty(a),u=t.hasOwnProperty(a);if(l&&!u||!l&&u||!Zi(e[a],t[a]))return!1}}return String(e)===String(t)}function Gp(e,t){return e.findIndex(n=>Zi(n,t))}const Ch=e=>!!(e&&e.__v_isRef===!0),Ae=e=>Mt(e)?e:e==null?"":et(e)||At(e)&&(e.toString===Ih||!it(e.toString))?Ch(e)?Ae(e.value):JSON.stringify(e,Ph,2):String(e),Ph=(e,t)=>Ch(t)?Ph(e,t.value):mr(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((n,[r,s],i)=>(n[Fo(r,i)+" =>"]=s,n),{})}:Qi(t)?{[`Set(${t.size})`]:[...t.values()].map(n=>Fo(n))}:He(t)?Fo(t):At(t)&&!et(t)&&!Ah(t)?String(t):t,Fo=(e,t="")=>{var n;return He(e)?`Symbol(${(n=e.description)!=null?n:t})`:e};/**
* @vue/reactivity v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let oe;class Wp{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=oe,!t&&oe&&(this.index=(oe.scopes||(oe.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].pause();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].resume();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].resume()}}run(t){if(this._active){const n=oe;try{return oe=this,t()}finally{oe=n}}}on(){++this._on===1&&(this.prevScope=oe,oe=this)}off(){this._on>0&&--this._on===0&&(oe=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let n,r;for(n=0,r=this.effects.length;n<r;n++)this.effects[n].stop();for(this.effects.length=0,n=0,r=this.cleanups.length;n<r;n++)this.cleanups[n]();if(this.cleanups.length=0,this.scopes){for(n=0,r=this.scopes.length;n<r;n++)this.scopes[n].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function Qp(){return oe}let wt;const Uo=new WeakSet;class Vh{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,oe&&oe.active&&oe.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Uo.has(this)&&(Uo.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||xh(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Mc(this),Nh(this);const t=wt,n=Re;wt=this,Re=!0;try{return this.fn()}finally{Oh(this),wt=t,Re=n,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)za(t);this.deps=this.depsTail=void 0,Mc(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Uo.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){na(this)&&this.run()}get dirty(){return na(this)}}let Dh=0,ls,cs;function xh(e,t=!1){if(e.flags|=8,t){e.next=cs,cs=e;return}e.next=ls,ls=e}function qa(){Dh++}function Ha(){if(--Dh>0)return;if(cs){let t=cs;for(cs=void 0;t;){const n=t.next;t.next=void 0,t.flags&=-9,t=n}}let e;for(;ls;){let t=ls;for(ls=void 0;t;){const n=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(r){e||(e=r)}t=n}}if(e)throw e}function Nh(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function Oh(e){let t,n=e.depsTail,r=n;for(;r;){const s=r.prevDep;r.version===-1?(r===n&&(n=s),za(r),Yp(r)):t=r,r.dep.activeLink=r.prevActiveLink,r.prevActiveLink=void 0,r=s}e.deps=t,e.depsTail=n}function na(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(Mh(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function Mh(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===Es)||(e.globalVersion=Es,!e.isSSR&&e.flags&128&&(!e.deps&&!e._dirty||!na(e))))return;e.flags|=2;const t=e.dep,n=wt,r=Re;wt=e,Re=!0;try{Nh(e);const s=e.fn(e._value);(t.version===0||gn(s,e._value))&&(e.flags|=128,e._value=s,t.version++)}catch(s){throw t.version++,s}finally{wt=n,Re=r,Oh(e),e.flags&=-3}}function za(e,t=!1){const{dep:n,prevSub:r,nextSub:s}=e;if(r&&(r.nextSub=s,e.prevSub=void 0),s&&(s.prevSub=r,e.nextSub=void 0),n.subs===e&&(n.subs=r,!r&&n.computed)){n.computed.flags&=-5;for(let i=n.computed.deps;i;i=i.nextDep)za(i,!0)}!t&&!--n.sc&&n.map&&n.map.delete(n.key)}function Yp(e){const{prevDep:t,nextDep:n}=e;t&&(t.nextDep=n,e.prevDep=void 0),n&&(n.prevDep=t,e.nextDep=void 0)}let Re=!0;const kh=[];function Ze(){kh.push(Re),Re=!1}function tn(){const e=kh.pop();Re=e===void 0?!0:e}function Mc(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const n=wt;wt=void 0;try{t()}finally{wt=n}}}let Es=0;class Xp{constructor(t,n){this.sub=t,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Ka{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!wt||!Re||wt===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==wt)n=this.activeLink=new Xp(wt,this),wt.deps?(n.prevDep=wt.depsTail,wt.depsTail.nextDep=n,wt.depsTail=n):wt.deps=wt.depsTail=n,Lh(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const r=n.nextDep;r.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=r),n.prevDep=wt.depsTail,n.nextDep=void 0,wt.depsTail.nextDep=n,wt.depsTail=n,wt.deps===n&&(wt.deps=r)}return n}trigger(t){this.version++,Es++,this.notify(t)}notify(t){qa();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{Ha()}}}function Lh(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let r=t.deps;r;r=r.nextDep)Lh(r)}const n=e.dep.subs;n!==e&&(e.prevSub=n,n&&(n.nextSub=e)),e.dep.subs=e}}const ra=new WeakMap,Kn=Symbol(""),sa=Symbol(""),Ts=Symbol("");function Jt(e,t,n){if(Re&&wt){let r=ra.get(e);r||ra.set(e,r=new Map);let s=r.get(n);s||(r.set(n,s=new Ka),s.map=r,s.key=n),s.track()}}function Xe(e,t,n,r,s,i){const a=ra.get(e);if(!a){Es++;return}const l=u=>{u&&u.trigger()};if(qa(),t==="clear")a.forEach(l);else{const u=et(e),f=u&&ja(n);if(u&&n==="length"){const d=Number(r);a.forEach((p,g)=>{(g==="length"||g===Ts||!He(g)&&g>=d)&&l(p)})}else switch((n!==void 0||a.has(void 0))&&l(a.get(n)),f&&l(a.get(Ts)),t){case"add":u?f&&l(a.get("length")):(l(a.get(Kn)),mr(e)&&l(a.get(sa)));break;case"delete":u||(l(a.get(Kn)),mr(e)&&l(a.get(sa)));break;case"set":mr(e)&&l(a.get(Kn));break}}Ha()}function lr(e){const t=mt(e);return t===e?t:(Jt(t,"iterate",Ts),ve(e)?t:t.map(zt))}function to(e){return Jt(e=mt(e),"iterate",Ts),e}const Jp={__proto__:null,[Symbol.iterator](){return Bo(this,Symbol.iterator,zt)},concat(...e){return lr(this).concat(...e.map(t=>et(t)?lr(t):t))},entries(){return Bo(this,"entries",e=>(e[1]=zt(e[1]),e))},every(e,t){return Qe(this,"every",e,t,void 0,arguments)},filter(e,t){return Qe(this,"filter",e,t,n=>n.map(zt),arguments)},find(e,t){return Qe(this,"find",e,t,zt,arguments)},findIndex(e,t){return Qe(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return Qe(this,"findLast",e,t,zt,arguments)},findLastIndex(e,t){return Qe(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return Qe(this,"forEach",e,t,void 0,arguments)},includes(...e){return jo(this,"includes",e)},indexOf(...e){return jo(this,"indexOf",e)},join(e){return lr(this).join(e)},lastIndexOf(...e){return jo(this,"lastIndexOf",e)},map(e,t){return Qe(this,"map",e,t,void 0,arguments)},pop(){return Jr(this,"pop")},push(...e){return Jr(this,"push",e)},reduce(e,...t){return kc(this,"reduce",e,t)},reduceRight(e,...t){return kc(this,"reduceRight",e,t)},shift(){return Jr(this,"shift")},some(e,t){return Qe(this,"some",e,t,void 0,arguments)},splice(...e){return Jr(this,"splice",e)},toReversed(){return lr(this).toReversed()},toSorted(e){return lr(this).toSorted(e)},toSpliced(...e){return lr(this).toSpliced(...e)},unshift(...e){return Jr(this,"unshift",e)},values(){return Bo(this,"values",zt)}};function Bo(e,t,n){const r=to(e),s=r[t]();return r!==e&&!ve(e)&&(s._next=s.next,s.next=()=>{const i=s._next();return i.done||(i.value=n(i.value)),i}),s}const Zp=Array.prototype;function Qe(e,t,n,r,s,i){const a=to(e),l=a!==e&&!ve(e),u=a[t];if(u!==Zp[t]){const p=u.apply(e,i);return l?zt(p):p}let f=n;a!==e&&(l?f=function(p,g){return n.call(this,zt(p),g,e)}:n.length>2&&(f=function(p,g){return n.call(this,p,g,e)}));const d=u.call(a,f,r);return l&&s?s(d):d}function kc(e,t,n,r){const s=to(e);let i=n;return s!==e&&(ve(e)?n.length>3&&(i=function(a,l,u){return n.call(this,a,l,u,e)}):i=function(a,l,u){return n.call(this,a,zt(l),u,e)}),s[t](i,...r)}function jo(e,t,n){const r=mt(e);Jt(r,"iterate",Ts);const s=r[t](...n);return(s===-1||s===!1)&&Ya(n[0])?(n[0]=mt(n[0]),r[t](...n)):s}function Jr(e,t,n=[]){Ze(),qa();const r=mt(e)[t].apply(e,n);return Ha(),tn(),r}const tm=Fa("__proto__,__v_isRef,__isVue"),Fh=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(He));function em(e){He(e)||(e=String(e));const t=mt(this);return Jt(t,"has",e),t.hasOwnProperty(e)}class Uh{constructor(t=!1,n=!1){this._isReadonly=t,this._isShallow=n}get(t,n,r){if(n==="__v_skip")return t.__v_skip;const s=this._isReadonly,i=this._isShallow;if(n==="__v_isReactive")return!s;if(n==="__v_isReadonly")return s;if(n==="__v_isShallow")return i;if(n==="__v_raw")return r===(s?i?hm:qh:i?$h:jh).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(r)?t:void 0;const a=et(t);if(!s){let u;if(a&&(u=Jp[n]))return u;if(n==="hasOwnProperty")return em}const l=Reflect.get(t,n,te(t)?t:r);if((He(n)?Fh.has(n):tm(n))||(s||Jt(t,"get",n),i))return l;if(te(l)){const u=a&&ja(n)?l:l.value;return s&&At(u)?oa(u):u}return At(l)?s?oa(l):Wa(l):l}}class Bh extends Uh{constructor(t=!1){super(!1,t)}set(t,n,r,s){let i=t[n];if(!this._isShallow){const u=In(i);if(!ve(r)&&!In(r)&&(i=mt(i),r=mt(r)),!et(t)&&te(i)&&!te(r))return u||(i.value=r),!0}const a=et(t)&&ja(n)?Number(n)<t.length:gt(t,n),l=Reflect.set(t,n,r,te(t)?t:s);return t===mt(s)&&(a?gn(r,i)&&Xe(t,"set",n,r):Xe(t,"add",n,r)),l}deleteProperty(t,n){const r=gt(t,n);t[n];const s=Reflect.deleteProperty(t,n);return s&&r&&Xe(t,"delete",n,void 0),s}has(t,n){const r=Reflect.has(t,n);return(!He(n)||!Fh.has(n))&&Jt(t,"has",n),r}ownKeys(t){return Jt(t,"iterate",et(t)?"length":Kn),Reflect.ownKeys(t)}}class nm extends Uh{constructor(t=!1){super(!0,t)}set(t,n){return!0}deleteProperty(t,n){return!0}}const rm=new Bh,sm=new nm,im=new Bh(!0);const ia=e=>e,Js=e=>Reflect.getPrototypeOf(e);function om(e,t,n){return function(...r){const s=this.__v_raw,i=mt(s),a=mr(i),l=e==="entries"||e===Symbol.iterator&&a,u=e==="keys"&&a,f=s[e](...r),d=n?ia:t?vi:zt;return!t&&Jt(i,"iterate",u?sa:Kn),{next(){const{value:p,done:g}=f.next();return g?{value:p,done:g}:{value:l?[d(p[0]),d(p[1])]:d(p),done:g}},[Symbol.iterator](){return this}}}}function Zs(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function am(e,t){const n={get(s){const i=this.__v_raw,a=mt(i),l=mt(s);e||(gn(s,l)&&Jt(a,"get",s),Jt(a,"get",l));const{has:u}=Js(a),f=t?ia:e?vi:zt;if(u.call(a,s))return f(i.get(s));if(u.call(a,l))return f(i.get(l));i!==a&&i.get(s)},get size(){const s=this.__v_raw;return!e&&Jt(mt(s),"iterate",Kn),s.size},has(s){const i=this.__v_raw,a=mt(i),l=mt(s);return e||(gn(s,l)&&Jt(a,"has",s),Jt(a,"has",l)),s===l?i.has(s):i.has(s)||i.has(l)},forEach(s,i){const a=this,l=a.__v_raw,u=mt(l),f=t?ia:e?vi:zt;return!e&&Jt(u,"iterate",Kn),l.forEach((d,p)=>s.call(i,f(d),f(p),a))}};return ie(n,e?{add:Zs("add"),set:Zs("set"),delete:Zs("delete"),clear:Zs("clear")}:{add(s){!t&&!ve(s)&&!In(s)&&(s=mt(s));const i=mt(this);return Js(i).has.call(i,s)||(i.add(s),Xe(i,"add",s,s)),this},set(s,i){!t&&!ve(i)&&!In(i)&&(i=mt(i));const a=mt(this),{has:l,get:u}=Js(a);let f=l.call(a,s);f||(s=mt(s),f=l.call(a,s));const d=u.call(a,s);return a.set(s,i),f?gn(i,d)&&Xe(a,"set",s,i):Xe(a,"add",s,i),this},delete(s){const i=mt(this),{has:a,get:l}=Js(i);let u=a.call(i,s);u||(s=mt(s),u=a.call(i,s)),l&&l.call(i,s);const f=i.delete(s);return u&&Xe(i,"delete",s,void 0),f},clear(){const s=mt(this),i=s.size!==0,a=s.clear();return i&&Xe(s,"clear",void 0,void 0),a}}),["keys","values","entries",Symbol.iterator].forEach(s=>{n[s]=om(s,e,t)}),n}function Ga(e,t){const n=am(e,t);return(r,s,i)=>s==="__v_isReactive"?!e:s==="__v_isReadonly"?e:s==="__v_raw"?r:Reflect.get(gt(n,s)&&s in r?n:r,s,i)}const lm={get:Ga(!1,!1)},cm={get:Ga(!1,!0)},um={get:Ga(!0,!1)};const jh=new WeakMap,$h=new WeakMap,qh=new WeakMap,hm=new WeakMap;function fm(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function dm(e){return e.__v_skip||!Object.isExtensible(e)?0:fm(Lp(e))}function Wa(e){return In(e)?e:Qa(e,!1,rm,lm,jh)}function pm(e){return Qa(e,!1,im,cm,$h)}function oa(e){return Qa(e,!0,sm,um,qh)}function Qa(e,t,n,r,s){if(!At(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const i=dm(e);if(i===0)return e;const a=s.get(e);if(a)return a;const l=new Proxy(e,i===2?r:n);return s.set(e,l),l}function gr(e){return In(e)?gr(e.__v_raw):!!(e&&e.__v_isReactive)}function In(e){return!!(e&&e.__v_isReadonly)}function ve(e){return!!(e&&e.__v_isShallow)}function Ya(e){return e?!!e.__v_raw:!1}function mt(e){const t=e&&e.__v_raw;return t?mt(t):e}function mm(e){return!gt(e,"__v_skip")&&Object.isExtensible(e)&&Rh(e,"__v_skip",!0),e}const zt=e=>At(e)?Wa(e):e,vi=e=>At(e)?oa(e):e;function te(e){return e?e.__v_isRef===!0:!1}function ae(e){return gm(e,!1)}function gm(e,t){return te(e)?e:new _m(e,t)}class _m{constructor(t,n){this.dep=new Ka,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?t:mt(t),this._value=n?t:zt(t),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(t){const n=this._rawValue,r=this.__v_isShallow||ve(t)||In(t);t=r?t:mt(t),gn(t,n)&&(this._rawValue=t,this._value=r?t:zt(t),this.dep.trigger())}}function es(e){return te(e)?e.value:e}const ym={get:(e,t,n)=>t==="__v_raw"?e:es(Reflect.get(e,t,n)),set:(e,t,n,r)=>{const s=e[t];return te(s)&&!te(n)?(s.value=n,!0):Reflect.set(e,t,n,r)}};function Hh(e){return gr(e)?e:new Proxy(e,ym)}class Em{constructor(t,n,r){this.fn=t,this.setter=n,this._value=void 0,this.dep=new Ka(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Es-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=r}notify(){if(this.flags|=16,!(this.flags&8)&&wt!==this)return xh(this,!0),!0}get value(){const t=this.dep.track();return Mh(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function Tm(e,t,n=!1){let r,s;return it(e)?r=e:(r=e.get,s=e.set),new Em(r,s,n)}const ti={},wi=new WeakMap;let $n;function vm(e,t=!1,n=$n){if(n){let r=wi.get(n);r||wi.set(n,r=[]),r.push(e)}}function wm(e,t,n=vt){const{immediate:r,deep:s,once:i,scheduler:a,augmentJob:l,call:u}=n,f=G=>s?G:ve(G)||s===!1||s===0?Je(G,1):Je(G);let d,p,g,v,V=!1,P=!1;if(te(e)?(p=()=>e.value,V=ve(e)):gr(e)?(p=()=>f(e),V=!0):et(e)?(P=!0,V=e.some(G=>gr(G)||ve(G)),p=()=>e.map(G=>{if(te(G))return G.value;if(gr(G))return f(G);if(it(G))return u?u(G,2):G()})):it(e)?t?p=u?()=>u(e,2):e:p=()=>{if(g){Ze();try{g()}finally{tn()}}const G=$n;$n=d;try{return u?u(e,3,[v]):e(v)}finally{$n=G}}:p=Fe,t&&s){const G=p,ut=s===!0?1/0:s;p=()=>Je(G(),ut)}const x=Qp(),$=()=>{d.stop(),x&&x.active&&Ba(x.effects,d)};if(i&&t){const G=t;t=(...ut)=>{G(...ut),$()}}let W=P?new Array(e.length).fill(ti):ti;const Q=G=>{if(!(!(d.flags&1)||!d.dirty&&!G))if(t){const ut=d.run();if(s||V||(P?ut.some((yt,I)=>gn(yt,W[I])):gn(ut,W))){g&&g();const yt=$n;$n=d;try{const I=[ut,W===ti?void 0:P&&W[0]===ti?[]:W,v];W=ut,u?u(t,3,I):t(...I)}finally{$n=yt}}}else d.run()};return l&&l(Q),d=new Vh(p),d.scheduler=a?()=>a(Q,!1):Q,v=G=>vm(G,!1,d),g=d.onStop=()=>{const G=wi.get(d);if(G){if(u)u(G,4);else for(const ut of G)ut();wi.delete(d)}},t?r?Q(!0):W=d.run():a?a(Q.bind(null,!0),!0):d.run(),$.pause=d.pause.bind(d),$.resume=d.resume.bind(d),$.stop=$,$}function Je(e,t=1/0,n){if(t<=0||!At(e)||e.__v_skip||(n=n||new Map,(n.get(e)||0)>=t))return e;if(n.set(e,t),t--,te(e))Je(e.value,t,n);else if(et(e))for(let r=0;r<e.length;r++)Je(e[r],t,n);else if(Qi(e)||mr(e))e.forEach(r=>{Je(r,t,n)});else if(Ah(e)){for(const r in e)Je(e[r],t,n);for(const r of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,r)&&Je(e[r],t,n)}return e}/**
* @vue/runtime-core v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Ns(e,t,n,r){try{return r?e(...r):e()}catch(s){eo(s,t,n)}}function ze(e,t,n,r){if(it(e)){const s=Ns(e,t,n,r);return s&&wh(s)&&s.catch(i=>{eo(i,t,n)}),s}if(et(e)){const s=[];for(let i=0;i<e.length;i++)s.push(ze(e[i],t,n,r));return s}}function eo(e,t,n,r=!0){const s=t?t.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:a}=t&&t.appContext.config||vt;if(t){let l=t.parent;const u=t.proxy,f=`https://vuejs.org/error-reference/#runtime-${n}`;for(;l;){const d=l.ec;if(d){for(let p=0;p<d.length;p++)if(d[p](e,u,f)===!1)return}l=l.parent}if(i){Ze(),Ns(i,null,10,[e,u,f]),tn();return}}Im(e,n,s,r,a)}function Im(e,t,n,r=!0,s=!1){if(s)throw e;console.error(e)}const re=[];let Me=-1;const _r=[];let dn=null,cr=0;const zh=Promise.resolve();let Ii=null;function Kh(e){const t=Ii||zh;return e?t.then(this?e.bind(this):e):t}function Am(e){let t=Me+1,n=re.length;for(;t<n;){const r=t+n>>>1,s=re[r],i=vs(s);i<e||i===e&&s.flags&2?t=r+1:n=r}return t}function Xa(e){if(!(e.flags&1)){const t=vs(e),n=re[re.length-1];!n||!(e.flags&2)&&t>=vs(n)?re.push(e):re.splice(Am(t),0,e),e.flags|=1,Gh()}}function Gh(){Ii||(Ii=zh.then(Qh))}function bm(e){et(e)?_r.push(...e):dn&&e.id===-1?dn.splice(cr+1,0,e):e.flags&1||(_r.push(e),e.flags|=1),Gh()}function Lc(e,t,n=Me+1){for(;n<re.length;n++){const r=re[n];if(r&&r.flags&2){if(e&&r.id!==e.uid)continue;re.splice(n,1),n--,r.flags&4&&(r.flags&=-2),r(),r.flags&4||(r.flags&=-2)}}}function Wh(e){if(_r.length){const t=[...new Set(_r)].sort((n,r)=>vs(n)-vs(r));if(_r.length=0,dn){dn.push(...t);return}for(dn=t,cr=0;cr<dn.length;cr++){const n=dn[cr];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}dn=null,cr=0}}const vs=e=>e.id==null?e.flags&2?-1:1/0:e.id;function Qh(e){try{for(Me=0;Me<re.length;Me++){const t=re[Me];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),Ns(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;Me<re.length;Me++){const t=re[Me];t&&(t.flags&=-2)}Me=-1,re.length=0,Wh(),Ii=null,(re.length||_r.length)&&Qh()}}let Te=null,Yh=null;function Ai(e){const t=Te;return Te=e,Yh=e&&e.type.__scopeId||null,t}function Rm(e,t=Te,n){if(!t||e._n)return e;const r=(...s)=>{r._d&&Gc(-1);const i=Ai(t);let a;try{a=e(...s)}finally{Ai(i),r._d&&Gc(1)}return a};return r._n=!0,r._c=!0,r._d=!0,r}function Zr(e,t){if(Te===null)return e;const n=oo(Te),r=e.dirs||(e.dirs=[]);for(let s=0;s<t.length;s++){let[i,a,l,u=vt]=t[s];i&&(it(i)&&(i={mounted:i,updated:i}),i.deep&&Je(a),r.push({dir:i,instance:n,value:a,oldValue:void 0,arg:l,modifiers:u}))}return e}function Bn(e,t,n,r){const s=e.dirs,i=t&&t.dirs;for(let a=0;a<s.length;a++){const l=s[a];i&&(l.oldValue=i[a].value);let u=l.dir[r];u&&(Ze(),ze(u,n,8,[e.el,l,e,t]),tn())}}const Sm=Symbol("_vte"),Cm=e=>e.__isTeleport,Pm=Symbol("_leaveCb");function Ja(e,t){e.shapeFlag&6&&e.component?(e.transition=t,Ja(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function Xh(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}const bi=new WeakMap;function us(e,t,n,r,s=!1){if(et(e)){e.forEach((V,P)=>us(V,t&&(et(t)?t[P]:t),n,r,s));return}if(hs(r)&&!s){r.shapeFlag&512&&r.type.__asyncResolved&&r.component.subTree.component&&us(e,t,n,r.component.subTree);return}const i=r.shapeFlag&4?oo(r.component):r.el,a=s?null:i,{i:l,r:u}=e,f=t&&t.r,d=l.refs===vt?l.refs={}:l.refs,p=l.setupState,g=mt(p),v=p===vt?vh:V=>gt(g,V);if(f!=null&&f!==u){if(Fc(t),Mt(f))d[f]=null,v(f)&&(p[f]=null);else if(te(f)){f.value=null;const V=t;V.k&&(d[V.k]=null)}}if(it(u))Ns(u,l,12,[a,d]);else{const V=Mt(u),P=te(u);if(V||P){const x=()=>{if(e.f){const $=V?v(u)?p[u]:d[u]:u.value;if(s)et($)&&Ba($,i);else if(et($))$.includes(i)||$.push(i);else if(V)d[u]=[i],v(u)&&(p[u]=d[u]);else{const W=[i];u.value=W,e.k&&(d[e.k]=W)}}else V?(d[u]=a,v(u)&&(p[u]=a)):P&&(u.value=a,e.k&&(d[e.k]=a))};if(a){const $=()=>{x(),bi.delete(e)};$.id=-1,bi.set(e,$),pe($,n)}else Fc(e),x()}}}function Fc(e){const t=bi.get(e);t&&(t.flags|=8,bi.delete(e))}Xi().requestIdleCallback;Xi().cancelIdleCallback;const hs=e=>!!e.type.__asyncLoader,Jh=e=>e.type.__isKeepAlive;function Vm(e,t){Zh(e,"a",t)}function Dm(e,t){Zh(e,"da",t)}function Zh(e,t,n=se){const r=e.__wdc||(e.__wdc=()=>{let s=n;for(;s;){if(s.isDeactivated)return;s=s.parent}return e()});if(no(t,r,n),n){let s=n.parent;for(;s&&s.parent;)Jh(s.parent.vnode)&&xm(r,t,n,s),s=s.parent}}function xm(e,t,n,r){const s=no(t,e,r,!0);ro(()=>{Ba(r[t],s)},n)}function no(e,t,n=se,r=!1){if(n){const s=n[e]||(n[e]=[]),i=t.__weh||(t.__weh=(...a)=>{Ze();const l=Os(n),u=ze(t,n,e,a);return l(),tn(),u});return r?s.unshift(i):s.push(i),i}}const sn=e=>(t,n=se)=>{(!Is||e==="sp")&&no(e,(...r)=>t(...r),n)},Nm=sn("bm"),Za=sn("m"),Om=sn("bu"),Mm=sn("u"),km=sn("bum"),ro=sn("um"),Lm=sn("sp"),Fm=sn("rtg"),Um=sn("rtc");function Bm(e,t=se){no("ec",e,t)}const jm=Symbol.for("v-ndc");function tf(e,t,n,r){let s;const i=n,a=et(e);if(a||Mt(e)){const l=a&&gr(e);let u=!1,f=!1;l&&(u=!ve(e),f=In(e),e=to(e)),s=new Array(e.length);for(let d=0,p=e.length;d<p;d++)s[d]=t(u?f?vi(zt(e[d])):zt(e[d]):e[d],d,void 0,i)}else if(typeof e=="number"){s=new Array(e);for(let l=0;l<e;l++)s[l]=t(l+1,l,void 0,i)}else if(At(e))if(e[Symbol.iterator])s=Array.from(e,(l,u)=>t(l,u,void 0,i));else{const l=Object.keys(e);s=new Array(l.length);for(let u=0,f=l.length;u<f;u++){const d=l[u];s[u]=t(e[d],d,u,i)}}else s=[];return s}const aa=e=>e?wf(e)?oo(e):aa(e.parent):null,fs=ie(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>aa(e.parent),$root:e=>aa(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>nf(e),$forceUpdate:e=>e.f||(e.f=()=>{Xa(e.update)}),$nextTick:e=>e.n||(e.n=Kh.bind(e.proxy)),$watch:e=>cg.bind(e)}),$o=(e,t)=>e!==vt&&!e.__isScriptSetup&&gt(e,t),$m={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:n,setupState:r,data:s,props:i,accessCache:a,type:l,appContext:u}=e;let f;if(t[0]!=="$"){const v=a[t];if(v!==void 0)switch(v){case 1:return r[t];case 2:return s[t];case 4:return n[t];case 3:return i[t]}else{if($o(r,t))return a[t]=1,r[t];if(s!==vt&&gt(s,t))return a[t]=2,s[t];if((f=e.propsOptions[0])&&gt(f,t))return a[t]=3,i[t];if(n!==vt&&gt(n,t))return a[t]=4,n[t];la&&(a[t]=0)}}const d=fs[t];let p,g;if(d)return t==="$attrs"&&Jt(e.attrs,"get",""),d(e);if((p=l.__cssModules)&&(p=p[t]))return p;if(n!==vt&&gt(n,t))return a[t]=4,n[t];if(g=u.config.globalProperties,gt(g,t))return g[t]},set({_:e},t,n){const{data:r,setupState:s,ctx:i}=e;return $o(s,t)?(s[t]=n,!0):r!==vt&&gt(r,t)?(r[t]=n,!0):gt(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(i[t]=n,!0)},has({_:{data:e,setupState:t,accessCache:n,ctx:r,appContext:s,propsOptions:i,type:a}},l){let u,f;return!!(n[l]||e!==vt&&l[0]!=="$"&&gt(e,l)||$o(t,l)||(u=i[0])&&gt(u,l)||gt(r,l)||gt(fs,l)||gt(s.config.globalProperties,l)||(f=a.__cssModules)&&f[l])},defineProperty(e,t,n){return n.get!=null?e._.accessCache[t]=0:gt(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};function Uc(e){return et(e)?e.reduce((t,n)=>(t[n]=null,t),{}):e}let la=!0;function qm(e){const t=nf(e),n=e.proxy,r=e.ctx;la=!1,t.beforeCreate&&Bc(t.beforeCreate,e,"bc");const{data:s,computed:i,methods:a,watch:l,provide:u,inject:f,created:d,beforeMount:p,mounted:g,beforeUpdate:v,updated:V,activated:P,deactivated:x,beforeDestroy:$,beforeUnmount:W,destroyed:Q,unmounted:G,render:ut,renderTracked:yt,renderTriggered:I,errorCaptured:_,serverPrefetch:T,expose:A,inheritAttrs:w,components:R,directives:y,filters:Ft}=t;if(f&&Hm(f,r,null),a)for(const bt in a){const pt=a[bt];it(pt)&&(r[bt]=pt.bind(n))}if(s){const bt=s.call(n,n);At(bt)&&(e.data=Wa(bt))}if(la=!0,i)for(const bt in i){const pt=i[bt],_e=it(pt)?pt.bind(n,n):it(pt.get)?pt.get.bind(n,n):Fe,nr=!it(pt)&&it(pt.set)?pt.set.bind(n):Fe,De=Ng({get:_e,set:nr});Object.defineProperty(r,bt,{enumerable:!0,configurable:!0,get:()=>De.value,set:ue=>De.value=ue})}if(l)for(const bt in l)ef(l[bt],r,n,bt);if(u){const bt=it(u)?u.call(n):u;Reflect.ownKeys(bt).forEach(pt=>{Ym(pt,bt[pt])})}d&&Bc(d,e,"c");function $t(bt,pt){et(pt)?pt.forEach(_e=>bt(_e.bind(n))):pt&&bt(pt.bind(n))}if($t(Nm,p),$t(Za,g),$t(Om,v),$t(Mm,V),$t(Vm,P),$t(Dm,x),$t(Bm,_),$t(Um,yt),$t(Fm,I),$t(km,W),$t(ro,G),$t(Lm,T),et(A))if(A.length){const bt=e.exposed||(e.exposed={});A.forEach(pt=>{Object.defineProperty(bt,pt,{get:()=>n[pt],set:_e=>n[pt]=_e,enumerable:!0})})}else e.exposed||(e.exposed={});ut&&e.render===Fe&&(e.render=ut),w!=null&&(e.inheritAttrs=w),R&&(e.components=R),y&&(e.directives=y),T&&Xh(e)}function Hm(e,t,n=Fe){et(e)&&(e=ca(e));for(const r in e){const s=e[r];let i;At(s)?"default"in s?i=ci(s.from||r,s.default,!0):i=ci(s.from||r):i=ci(s),te(i)?Object.defineProperty(t,r,{enumerable:!0,configurable:!0,get:()=>i.value,set:a=>i.value=a}):t[r]=i}}function Bc(e,t,n){ze(et(e)?e.map(r=>r.bind(t.proxy)):e.bind(t.proxy),t,n)}function ef(e,t,n,r){let s=r.includes(".")?gf(n,r):()=>n[r];if(Mt(e)){const i=t[e];it(i)&&ui(s,i)}else if(it(e))ui(s,e.bind(n));else if(At(e))if(et(e))e.forEach(i=>ef(i,t,n,r));else{const i=it(e.handler)?e.handler.bind(n):t[e.handler];it(i)&&ui(s,i,e)}}function nf(e){const t=e.type,{mixins:n,extends:r}=t,{mixins:s,optionsCache:i,config:{optionMergeStrategies:a}}=e.appContext,l=i.get(t);let u;return l?u=l:!s.length&&!n&&!r?u=t:(u={},s.length&&s.forEach(f=>Ri(u,f,a,!0)),Ri(u,t,a)),At(t)&&i.set(t,u),u}function Ri(e,t,n,r=!1){const{mixins:s,extends:i}=t;i&&Ri(e,i,n,!0),s&&s.forEach(a=>Ri(e,a,n,!0));for(const a in t)if(!(r&&a==="expose")){const l=zm[a]||n&&n[a];e[a]=l?l(e[a],t[a]):t[a]}return e}const zm={data:jc,props:$c,emits:$c,methods:ns,computed:ns,beforeCreate:ne,created:ne,beforeMount:ne,mounted:ne,beforeUpdate:ne,updated:ne,beforeDestroy:ne,beforeUnmount:ne,destroyed:ne,unmounted:ne,activated:ne,deactivated:ne,errorCaptured:ne,serverPrefetch:ne,components:ns,directives:ns,watch:Gm,provide:jc,inject:Km};function jc(e,t){return t?e?function(){return ie(it(e)?e.call(this,this):e,it(t)?t.call(this,this):t)}:t:e}function Km(e,t){return ns(ca(e),ca(t))}function ca(e){if(et(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function ne(e,t){return e?[...new Set([].concat(e,t))]:t}function ns(e,t){return e?ie(Object.create(null),e,t):t}function $c(e,t){return e?et(e)&&et(t)?[...new Set([...e,...t])]:ie(Object.create(null),Uc(e),Uc(t??{})):t}function Gm(e,t){if(!e)return t;if(!t)return e;const n=ie(Object.create(null),e);for(const r in t)n[r]=ne(e[r],t[r]);return n}function rf(){return{app:null,config:{isNativeTag:vh,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Wm=0;function Qm(e,t){return function(r,s=null){it(r)||(r=ie({},r)),s!=null&&!At(s)&&(s=null);const i=rf(),a=new WeakSet,l=[];let u=!1;const f=i.app={_uid:Wm++,_component:r,_props:s,_container:null,_context:i,_instance:null,version:Og,get config(){return i.config},set config(d){},use(d,...p){return a.has(d)||(d&&it(d.install)?(a.add(d),d.install(f,...p)):it(d)&&(a.add(d),d(f,...p))),f},mixin(d){return i.mixins.includes(d)||i.mixins.push(d),f},component(d,p){return p?(i.components[d]=p,f):i.components[d]},directive(d,p){return p?(i.directives[d]=p,f):i.directives[d]},mount(d,p,g){if(!u){const v=f._ceVNode||Se(r,s);return v.appContext=i,g===!0?g="svg":g===!1&&(g=void 0),e(v,d,g),u=!0,f._container=d,d.__vue_app__=f,oo(v.component)}},onUnmount(d){l.push(d)},unmount(){u&&(ze(l,f._instance,16),e(null,f._container),delete f._container.__vue_app__)},provide(d,p){return i.provides[d]=p,f},runWithContext(d){const p=yr;yr=f;try{return d()}finally{yr=p}}};return f}}let yr=null;function Ym(e,t){if(se){let n=se.provides;const r=se.parent&&se.parent.provides;r===n&&(n=se.provides=Object.create(r)),n[e]=t}}function ci(e,t,n=!1){const r=Sg();if(r||yr){let s=yr?yr._context.provides:r?r.parent==null||r.ce?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:void 0;if(s&&e in s)return s[e];if(arguments.length>1)return n&&it(t)?t.call(r&&r.proxy):t}}const sf={},of=()=>Object.create(sf),af=e=>Object.getPrototypeOf(e)===sf;function Xm(e,t,n,r=!1){const s={},i=of();e.propsDefaults=Object.create(null),lf(e,t,s,i);for(const a in e.propsOptions[0])a in s||(s[a]=void 0);n?e.props=r?s:pm(s):e.type.props?e.props=s:e.props=i,e.attrs=i}function Jm(e,t,n,r){const{props:s,attrs:i,vnode:{patchFlag:a}}=e,l=mt(s),[u]=e.propsOptions;let f=!1;if((r||a>0)&&!(a&16)){if(a&8){const d=e.vnode.dynamicProps;for(let p=0;p<d.length;p++){let g=d[p];if(so(e.emitsOptions,g))continue;const v=t[g];if(u)if(gt(i,g))v!==i[g]&&(i[g]=v,f=!0);else{const V=wn(g);s[V]=ua(u,l,V,v,e,!1)}else v!==i[g]&&(i[g]=v,f=!0)}}}else{lf(e,t,s,i)&&(f=!0);let d;for(const p in l)(!t||!gt(t,p)&&((d=Jn(p))===p||!gt(t,d)))&&(u?n&&(n[p]!==void 0||n[d]!==void 0)&&(s[p]=ua(u,l,p,void 0,e,!0)):delete s[p]);if(i!==l)for(const p in i)(!t||!gt(t,p))&&(delete i[p],f=!0)}f&&Xe(e.attrs,"set","")}function lf(e,t,n,r){const[s,i]=e.propsOptions;let a=!1,l;if(t)for(let u in t){if(as(u))continue;const f=t[u];let d;s&&gt(s,d=wn(u))?!i||!i.includes(d)?n[d]=f:(l||(l={}))[d]=f:so(e.emitsOptions,u)||(!(u in r)||f!==r[u])&&(r[u]=f,a=!0)}if(i){const u=mt(n),f=l||vt;for(let d=0;d<i.length;d++){const p=i[d];n[p]=ua(s,u,p,f[p],e,!gt(f,p))}}return a}function ua(e,t,n,r,s,i){const a=e[n];if(a!=null){const l=gt(a,"default");if(l&&r===void 0){const u=a.default;if(a.type!==Function&&!a.skipFactory&&it(u)){const{propsDefaults:f}=s;if(n in f)r=f[n];else{const d=Os(s);r=f[n]=u.call(null,t),d()}}else r=u;s.ce&&s.ce._setProp(n,r)}a[0]&&(i&&!l?r=!1:a[1]&&(r===""||r===Jn(n))&&(r=!0))}return r}const Zm=new WeakMap;function cf(e,t,n=!1){const r=n?Zm:t.propsCache,s=r.get(e);if(s)return s;const i=e.props,a={},l=[];let u=!1;if(!it(e)){const d=p=>{u=!0;const[g,v]=cf(p,t,!0);ie(a,g),v&&l.push(...v)};!n&&t.mixins.length&&t.mixins.forEach(d),e.extends&&d(e.extends),e.mixins&&e.mixins.forEach(d)}if(!i&&!u)return At(e)&&r.set(e,pr),pr;if(et(i))for(let d=0;d<i.length;d++){const p=wn(i[d]);qc(p)&&(a[p]=vt)}else if(i)for(const d in i){const p=wn(d);if(qc(p)){const g=i[d],v=a[p]=et(g)||it(g)?{type:g}:ie({},g),V=v.type;let P=!1,x=!0;if(et(V))for(let $=0;$<V.length;++$){const W=V[$],Q=it(W)&&W.name;if(Q==="Boolean"){P=!0;break}else Q==="String"&&(x=!1)}else P=it(V)&&V.name==="Boolean";v[0]=P,v[1]=x,(P||gt(v,"default"))&&l.push(p)}}const f=[a,l];return At(e)&&r.set(e,f),f}function qc(e){return e[0]!=="$"&&!as(e)}const tl=e=>e==="_"||e==="_ctx"||e==="$stable",el=e=>et(e)?e.map(Le):[Le(e)],tg=(e,t,n)=>{if(t._n)return t;const r=Rm((...s)=>el(t(...s)),n);return r._c=!1,r},uf=(e,t,n)=>{const r=e._ctx;for(const s in e){if(tl(s))continue;const i=e[s];if(it(i))t[s]=tg(s,i,r);else if(i!=null){const a=el(i);t[s]=()=>a}}},hf=(e,t)=>{const n=el(t);e.slots.default=()=>n},ff=(e,t,n)=>{for(const r in t)(n||!tl(r))&&(e[r]=t[r])},eg=(e,t,n)=>{const r=e.slots=of();if(e.vnode.shapeFlag&32){const s=t._;s?(ff(r,t,n),n&&Rh(r,"_",s,!0)):uf(t,r)}else t&&hf(e,t)},ng=(e,t,n)=>{const{vnode:r,slots:s}=e;let i=!0,a=vt;if(r.shapeFlag&32){const l=t._;l?n&&l===1?i=!1:ff(s,t,n):(i=!t.$stable,uf(t,s)),a=t}else t&&(hf(e,t),a={default:1});if(i)for(const l in s)!tl(l)&&a[l]==null&&delete s[l]},pe=_g;function rg(e){return sg(e)}function sg(e,t){const n=Xi();n.__VUE__=!0;const{insert:r,remove:s,patchProp:i,createElement:a,createText:l,createComment:u,setText:f,setElementText:d,parentNode:p,nextSibling:g,setScopeId:v=Fe,insertStaticContent:V}=e,P=(E,b,D,B=null,M=null,k=null,q=void 0,U=null,L=!!b.dynamicChildren)=>{if(E===b)return;E&&!ts(E,b)&&(B=on(E),ue(E,M,k,!0),E=null),b.patchFlag===-2&&(L=!1,b.dynamicChildren=null);const{type:F,ref:J,shapeFlag:H}=b;switch(F){case io:x(E,b,D,B);break;case An:$(E,b,D,B);break;case Ho:E==null&&W(b,D,B,q);break;case Ie:R(E,b,D,B,M,k,q,U,L);break;default:H&1?ut(E,b,D,B,M,k,q,U,L):H&6?y(E,b,D,B,M,k,q,U,L):(H&64||H&128)&&F.process(E,b,D,B,M,k,q,U,L,On)}J!=null&&M?us(J,E&&E.ref,k,b||E,!b):J==null&&E&&E.ref!=null&&us(E.ref,null,k,E,!0)},x=(E,b,D,B)=>{if(E==null)r(b.el=l(b.children),D,B);else{const M=b.el=E.el;b.children!==E.children&&f(M,b.children)}},$=(E,b,D,B)=>{E==null?r(b.el=u(b.children||""),D,B):b.el=E.el},W=(E,b,D,B)=>{[E.el,E.anchor]=V(E.children,b,D,B,E.el,E.anchor)},Q=({el:E,anchor:b},D,B)=>{let M;for(;E&&E!==b;)M=g(E),r(E,D,B),E=M;r(b,D,B)},G=({el:E,anchor:b})=>{let D;for(;E&&E!==b;)D=g(E),s(E),E=D;s(b)},ut=(E,b,D,B,M,k,q,U,L)=>{b.type==="svg"?q="svg":b.type==="math"&&(q="mathml"),E==null?yt(b,D,B,M,k,q,U,L):T(E,b,M,k,q,U,L)},yt=(E,b,D,B,M,k,q,U)=>{let L,F;const{props:J,shapeFlag:H,transition:X,dirs:Z}=E;if(L=E.el=a(E.type,k,J&&J.is,J),H&8?d(L,E.children):H&16&&_(E.children,L,null,B,M,qo(E,k),q,U),Z&&Bn(E,null,B,"created"),I(L,E,E.scopeId,q,B),J){for(const Et in J)Et!=="value"&&!as(Et)&&i(L,Et,null,J[Et],k,B);"value"in J&&i(L,"value",null,J.value,k),(F=J.onVnodeBeforeMount)&&Oe(F,B,E)}Z&&Bn(E,null,B,"beforeMount");const at=ig(M,X);at&&X.beforeEnter(L),r(L,b,D),((F=J&&J.onVnodeMounted)||at||Z)&&pe(()=>{F&&Oe(F,B,E),at&&X.enter(L),Z&&Bn(E,null,B,"mounted")},M)},I=(E,b,D,B,M)=>{if(D&&v(E,D),B)for(let k=0;k<B.length;k++)v(E,B[k]);if(M){let k=M.subTree;if(b===k||yf(k.type)&&(k.ssContent===b||k.ssFallback===b)){const q=M.vnode;I(E,q,q.scopeId,q.slotScopeIds,M.parent)}}},_=(E,b,D,B,M,k,q,U,L=0)=>{for(let F=L;F<E.length;F++){const J=E[F]=U?pn(E[F]):Le(E[F]);P(null,J,b,D,B,M,k,q,U)}},T=(E,b,D,B,M,k,q)=>{const U=b.el=E.el;let{patchFlag:L,dynamicChildren:F,dirs:J}=b;L|=E.patchFlag&16;const H=E.props||vt,X=b.props||vt;let Z;if(D&&jn(D,!1),(Z=X.onVnodeBeforeUpdate)&&Oe(Z,D,b,E),J&&Bn(b,E,D,"beforeUpdate"),D&&jn(D,!0),(H.innerHTML&&X.innerHTML==null||H.textContent&&X.textContent==null)&&d(U,""),F?A(E.dynamicChildren,F,U,D,B,qo(b,M),k):q||pt(E,b,U,null,D,B,qo(b,M),k,!1),L>0){if(L&16)w(U,H,X,D,M);else if(L&2&&H.class!==X.class&&i(U,"class",null,X.class,M),L&4&&i(U,"style",H.style,X.style,M),L&8){const at=b.dynamicProps;for(let Et=0;Et<at.length;Et++){const dt=at[Et],Wt=H[dt],Qt=X[dt];(Qt!==Wt||dt==="value")&&i(U,dt,Wt,Qt,M,D)}}L&1&&E.children!==b.children&&d(U,b.children)}else!q&&F==null&&w(U,H,X,D,M);((Z=X.onVnodeUpdated)||J)&&pe(()=>{Z&&Oe(Z,D,b,E),J&&Bn(b,E,D,"updated")},B)},A=(E,b,D,B,M,k,q)=>{for(let U=0;U<b.length;U++){const L=E[U],F=b[U],J=L.el&&(L.type===Ie||!ts(L,F)||L.shapeFlag&198)?p(L.el):D;P(L,F,J,null,B,M,k,q,!0)}},w=(E,b,D,B,M)=>{if(b!==D){if(b!==vt)for(const k in b)!as(k)&&!(k in D)&&i(E,k,b[k],null,M,B);for(const k in D){if(as(k))continue;const q=D[k],U=b[k];q!==U&&k!=="value"&&i(E,k,U,q,M,B)}"value"in D&&i(E,"value",b.value,D.value,M)}},R=(E,b,D,B,M,k,q,U,L)=>{const F=b.el=E?E.el:l(""),J=b.anchor=E?E.anchor:l("");let{patchFlag:H,dynamicChildren:X,slotScopeIds:Z}=b;Z&&(U=U?U.concat(Z):Z),E==null?(r(F,D,B),r(J,D,B),_(b.children||[],D,J,M,k,q,U,L)):H>0&&H&64&&X&&E.dynamicChildren?(A(E.dynamicChildren,X,D,M,k,q,U),(b.key!=null||M&&b===M.subTree)&&df(E,b,!0)):pt(E,b,D,J,M,k,q,U,L)},y=(E,b,D,B,M,k,q,U,L)=>{b.slotScopeIds=U,E==null?b.shapeFlag&512?M.ctx.activate(b,D,B,q,L):Ft(b,D,B,M,k,q,L):Ve(E,b,L)},Ft=(E,b,D,B,M,k,q)=>{const U=E.component=Rg(E,B,M);if(Jh(E)&&(U.ctx.renderer=On),Cg(U,!1,q),U.asyncDep){if(M&&M.registerDep(U,$t,q),!E.el){const L=U.subTree=Se(An);$(null,L,b,D),E.placeholder=L.el}}else $t(U,E,b,D,M,k,q)},Ve=(E,b,D)=>{const B=b.component=E.component;if(mg(E,b,D))if(B.asyncDep&&!B.asyncResolved){bt(B,b,D);return}else B.next=b,B.update();else b.el=E.el,B.vnode=b},$t=(E,b,D,B,M,k,q)=>{const U=()=>{if(E.isMounted){let{next:H,bu:X,u:Z,parent:at,vnode:Et}=E;{const fe=pf(E);if(fe){H&&(H.el=Et.el,bt(E,H,q)),fe.asyncDep.then(()=>{E.isUnmounted||U()});return}}let dt=H,Wt;jn(E,!1),H?(H.el=Et.el,bt(E,H,q)):H=Et,X&&li(X),(Wt=H.props&&H.props.onVnodeBeforeUpdate)&&Oe(Wt,at,H,Et),jn(E,!0);const Qt=zc(E),he=E.subTree;E.subTree=Qt,P(he,Qt,p(he.el),on(he),E,M,k),H.el=Qt.el,dt===null&&gg(E,Qt.el),Z&&pe(Z,M),(Wt=H.props&&H.props.onVnodeUpdated)&&pe(()=>Oe(Wt,at,H,Et),M)}else{let H;const{el:X,props:Z}=b,{bm:at,m:Et,parent:dt,root:Wt,type:Qt}=E,he=hs(b);jn(E,!1),at&&li(at),!he&&(H=Z&&Z.onVnodeBeforeMount)&&Oe(H,dt,b),jn(E,!0);{Wt.ce&&Wt.ce._def.shadowRoot!==!1&&Wt.ce._injectChildStyle(Qt);const fe=E.subTree=zc(E);P(null,fe,D,B,E,M,k),b.el=fe.el}if(Et&&pe(Et,M),!he&&(H=Z&&Z.onVnodeMounted)){const fe=b;pe(()=>Oe(H,dt,fe),M)}(b.shapeFlag&256||dt&&hs(dt.vnode)&&dt.vnode.shapeFlag&256)&&E.a&&pe(E.a,M),E.isMounted=!0,b=D=B=null}};E.scope.on();const L=E.effect=new Vh(U);E.scope.off();const F=E.update=L.run.bind(L),J=E.job=L.runIfDirty.bind(L);J.i=E,J.id=E.uid,L.scheduler=()=>Xa(J),jn(E,!0),F()},bt=(E,b,D)=>{b.component=E;const B=E.vnode.props;E.vnode=b,E.next=null,Jm(E,b.props,B,D),ng(E,b.children,D),Ze(),Lc(E),tn()},pt=(E,b,D,B,M,k,q,U,L=!1)=>{const F=E&&E.children,J=E?E.shapeFlag:0,H=b.children,{patchFlag:X,shapeFlag:Z}=b;if(X>0){if(X&128){nr(F,H,D,B,M,k,q,U,L);return}else if(X&256){_e(F,H,D,B,M,k,q,U,L);return}}Z&8?(J&16&&We(F,M,k),H!==F&&d(D,H)):J&16?Z&16?nr(F,H,D,B,M,k,q,U,L):We(F,M,k,!0):(J&8&&d(D,""),Z&16&&_(H,D,B,M,k,q,U,L))},_e=(E,b,D,B,M,k,q,U,L)=>{E=E||pr,b=b||pr;const F=E.length,J=b.length,H=Math.min(F,J);let X;for(X=0;X<H;X++){const Z=b[X]=L?pn(b[X]):Le(b[X]);P(E[X],Z,D,null,M,k,q,U,L)}F>J?We(E,M,k,!0,!1,H):_(b,D,B,M,k,q,U,L,H)},nr=(E,b,D,B,M,k,q,U,L)=>{let F=0;const J=b.length;let H=E.length-1,X=J-1;for(;F<=H&&F<=X;){const Z=E[F],at=b[F]=L?pn(b[F]):Le(b[F]);if(ts(Z,at))P(Z,at,D,null,M,k,q,U,L);else break;F++}for(;F<=H&&F<=X;){const Z=E[H],at=b[X]=L?pn(b[X]):Le(b[X]);if(ts(Z,at))P(Z,at,D,null,M,k,q,U,L);else break;H--,X--}if(F>H){if(F<=X){const Z=X+1,at=Z<J?b[Z].el:B;for(;F<=X;)P(null,b[F]=L?pn(b[F]):Le(b[F]),D,at,M,k,q,U,L),F++}}else if(F>X)for(;F<=H;)ue(E[F],M,k,!0),F++;else{const Z=F,at=F,Et=new Map;for(F=at;F<=X;F++){const qt=b[F]=L?pn(b[F]):Le(b[F]);qt.key!=null&&Et.set(qt.key,F)}let dt,Wt=0;const Qt=X-at+1;let he=!1,fe=0;const we=new Array(Qt);for(F=0;F<Qt;F++)we[F]=0;for(F=Z;F<=H;F++){const qt=E[F];if(Wt>=Qt){ue(qt,M,k,!0);continue}let Ut;if(qt.key!=null)Ut=Et.get(qt.key);else for(dt=at;dt<=X;dt++)if(we[dt-at]===0&&ts(qt,b[dt])){Ut=dt;break}Ut===void 0?ue(qt,M,k,!0):(we[Ut-at]=F+1,Ut>=fe?fe=Ut:he=!0,P(qt,b[Ut],D,null,M,k,q,U,L),Wt++)}const sr=he?og(we):pr;for(dt=sr.length-1,F=Qt-1;F>=0;F--){const qt=at+F,Ut=b[qt],Lr=b[qt+1],Mn=qt+1<J?Lr.el||Lr.placeholder:B;we[F]===0?P(null,Ut,D,Mn,M,k,q,U,L):he&&(dt<0||F!==sr[dt]?De(Ut,D,Mn,2):dt--)}}},De=(E,b,D,B,M=null)=>{const{el:k,type:q,transition:U,children:L,shapeFlag:F}=E;if(F&6){De(E.component.subTree,b,D,B);return}if(F&128){E.suspense.move(b,D,B);return}if(F&64){q.move(E,b,D,On);return}if(q===Ie){r(k,b,D);for(let H=0;H<L.length;H++)De(L[H],b,D,B);r(E.anchor,b,D);return}if(q===Ho){Q(E,b,D);return}if(B!==2&&F&1&&U)if(B===0)U.beforeEnter(k),r(k,b,D),pe(()=>U.enter(k),M);else{const{leave:H,delayLeave:X,afterLeave:Z}=U,at=()=>{E.ctx.isUnmounted?s(k):r(k,b,D)},Et=()=>{k._isLeaving&&k[Pm](!0),H(k,()=>{at(),Z&&Z()})};X?X(k,at,Et):Et()}else r(k,b,D)},ue=(E,b,D,B=!1,M=!1)=>{const{type:k,props:q,ref:U,children:L,dynamicChildren:F,shapeFlag:J,patchFlag:H,dirs:X,cacheIndex:Z}=E;if(H===-2&&(M=!1),U!=null&&(Ze(),us(U,null,D,E,!0),tn()),Z!=null&&(b.renderCache[Z]=void 0),J&256){b.ctx.deactivate(E);return}const at=J&1&&X,Et=!hs(E);let dt;if(Et&&(dt=q&&q.onVnodeBeforeUnmount)&&Oe(dt,b,E),J&6)Mr(E.component,D,B);else{if(J&128){E.suspense.unmount(D,B);return}at&&Bn(E,null,b,"beforeUnmount"),J&64?E.type.remove(E,b,D,On,B):F&&!F.hasOnce&&(k!==Ie||H>0&&H&64)?We(F,b,D,!1,!0):(k===Ie&&H&384||!M&&J&16)&&We(L,b,D),B&&Or(E)}(Et&&(dt=q&&q.onVnodeUnmounted)||at)&&pe(()=>{dt&&Oe(dt,b,E),at&&Bn(E,null,b,"unmounted")},D)},Or=E=>{const{type:b,el:D,anchor:B,transition:M}=E;if(b===Ie){rr(D,B);return}if(b===Ho){G(E);return}const k=()=>{s(D),M&&!M.persisted&&M.afterLeave&&M.afterLeave()};if(E.shapeFlag&1&&M&&!M.persisted){const{leave:q,delayLeave:U}=M,L=()=>q(D,k);U?U(E.el,k,L):L()}else k()},rr=(E,b)=>{let D;for(;E!==b;)D=g(E),s(E),E=D;s(b)},Mr=(E,b,D)=>{const{bum:B,scope:M,job:k,subTree:q,um:U,m:L,a:F}=E;Hc(L),Hc(F),B&&li(B),M.stop(),k&&(k.flags|=8,ue(q,E,b,D)),U&&pe(U,b),pe(()=>{E.isUnmounted=!0},b)},We=(E,b,D,B=!1,M=!1,k=0)=>{for(let q=k;q<E.length;q++)ue(E[q],b,D,B,M)},on=E=>{if(E.shapeFlag&6)return on(E.component.subTree);if(E.shapeFlag&128)return E.suspense.next();const b=g(E.anchor||E.el),D=b&&b[Sm];return D?g(D):b};let Nn=!1;const kr=(E,b,D)=>{E==null?b._vnode&&ue(b._vnode,null,null,!0):P(b._vnode||null,E,b,null,null,null,D),b._vnode=E,Nn||(Nn=!0,Lc(),Wh(),Nn=!1)},On={p:P,um:ue,m:De,r:Or,mt:Ft,mc:_,pc:pt,pbc:A,n:on,o:e};return{render:kr,hydrate:void 0,createApp:Qm(kr)}}function qo({type:e,props:t},n){return n==="svg"&&e==="foreignObject"||n==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:n}function jn({effect:e,job:t},n){n?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function ig(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function df(e,t,n=!1){const r=e.children,s=t.children;if(et(r)&&et(s))for(let i=0;i<r.length;i++){const a=r[i];let l=s[i];l.shapeFlag&1&&!l.dynamicChildren&&((l.patchFlag<=0||l.patchFlag===32)&&(l=s[i]=pn(s[i]),l.el=a.el),!n&&l.patchFlag!==-2&&df(a,l)),l.type===io&&l.patchFlag!==-1&&(l.el=a.el),l.type===An&&!l.el&&(l.el=a.el)}}function og(e){const t=e.slice(),n=[0];let r,s,i,a,l;const u=e.length;for(r=0;r<u;r++){const f=e[r];if(f!==0){if(s=n[n.length-1],e[s]<f){t[r]=s,n.push(r);continue}for(i=0,a=n.length-1;i<a;)l=i+a>>1,e[n[l]]<f?i=l+1:a=l;f<e[n[i]]&&(i>0&&(t[r]=n[i-1]),n[i]=r)}}for(i=n.length,a=n[i-1];i-- >0;)n[i]=a,a=t[a];return n}function pf(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:pf(t)}function Hc(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}const ag=Symbol.for("v-scx"),lg=()=>ci(ag);function ui(e,t,n){return mf(e,t,n)}function mf(e,t,n=vt){const{immediate:r,deep:s,flush:i,once:a}=n,l=ie({},n),u=t&&r||!t&&i!=="post";let f;if(Is){if(i==="sync"){const v=lg();f=v.__watcherHandles||(v.__watcherHandles=[])}else if(!u){const v=()=>{};return v.stop=Fe,v.resume=Fe,v.pause=Fe,v}}const d=se;l.call=(v,V,P)=>ze(v,d,V,P);let p=!1;i==="post"?l.scheduler=v=>{pe(v,d&&d.suspense)}:i!=="sync"&&(p=!0,l.scheduler=(v,V)=>{V?v():Xa(v)}),l.augmentJob=v=>{t&&(v.flags|=4),p&&(v.flags|=2,d&&(v.id=d.uid,v.i=d))};const g=wm(e,t,l);return Is&&(f?f.push(g):u&&g()),g}function cg(e,t,n){const r=this.proxy,s=Mt(e)?e.includes(".")?gf(r,e):()=>r[e]:e.bind(r,r);let i;it(t)?i=t:(i=t.handler,n=t);const a=Os(this),l=mf(s,i.bind(r),n);return a(),l}function gf(e,t){const n=t.split(".");return()=>{let r=e;for(let s=0;s<n.length&&r;s++)r=r[n[s]];return r}}const ug=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${wn(t)}Modifiers`]||e[`${Jn(t)}Modifiers`];function hg(e,t,...n){if(e.isUnmounted)return;const r=e.vnode.props||vt;let s=n;const i=t.startsWith("update:"),a=i&&ug(r,t.slice(7));a&&(a.trim&&(s=n.map(d=>Mt(d)?d.trim():d)),a.number&&(s=n.map(Ti)));let l,u=r[l=Lo(t)]||r[l=Lo(wn(t))];!u&&i&&(u=r[l=Lo(Jn(t))]),u&&ze(u,e,6,s);const f=r[l+"Once"];if(f){if(!e.emitted)e.emitted={};else if(e.emitted[l])return;e.emitted[l]=!0,ze(f,e,6,s)}}const fg=new WeakMap;function _f(e,t,n=!1){const r=n?fg:t.emitsCache,s=r.get(e);if(s!==void 0)return s;const i=e.emits;let a={},l=!1;if(!it(e)){const u=f=>{const d=_f(f,t,!0);d&&(l=!0,ie(a,d))};!n&&t.mixins.length&&t.mixins.forEach(u),e.extends&&u(e.extends),e.mixins&&e.mixins.forEach(u)}return!i&&!l?(At(e)&&r.set(e,null),null):(et(i)?i.forEach(u=>a[u]=null):ie(a,i),At(e)&&r.set(e,a),a)}function so(e,t){return!e||!Wi(t)?!1:(t=t.slice(2).replace(/Once$/,""),gt(e,t[0].toLowerCase()+t.slice(1))||gt(e,Jn(t))||gt(e,t))}function zc(e){const{type:t,vnode:n,proxy:r,withProxy:s,propsOptions:[i],slots:a,attrs:l,emit:u,render:f,renderCache:d,props:p,data:g,setupState:v,ctx:V,inheritAttrs:P}=e,x=Ai(e);let $,W;try{if(n.shapeFlag&4){const G=s||r,ut=G;$=Le(f.call(ut,G,d,p,v,g,V)),W=l}else{const G=t;$=Le(G.length>1?G(p,{attrs:l,slots:a,emit:u}):G(p,null)),W=t.props?l:dg(l)}}catch(G){ds.length=0,eo(G,e,1),$=Se(An)}let Q=$;if(W&&P!==!1){const G=Object.keys(W),{shapeFlag:ut}=Q;G.length&&ut&7&&(i&&G.some(Ua)&&(W=pg(W,i)),Q=wr(Q,W,!1,!0))}return n.dirs&&(Q=wr(Q,null,!1,!0),Q.dirs=Q.dirs?Q.dirs.concat(n.dirs):n.dirs),n.transition&&Ja(Q,n.transition),$=Q,Ai(x),$}const dg=e=>{let t;for(const n in e)(n==="class"||n==="style"||Wi(n))&&((t||(t={}))[n]=e[n]);return t},pg=(e,t)=>{const n={};for(const r in e)(!Ua(r)||!(r.slice(9)in t))&&(n[r]=e[r]);return n};function mg(e,t,n){const{props:r,children:s,component:i}=e,{props:a,children:l,patchFlag:u}=t,f=i.emitsOptions;if(t.dirs||t.transition)return!0;if(n&&u>=0){if(u&1024)return!0;if(u&16)return r?Kc(r,a,f):!!a;if(u&8){const d=t.dynamicProps;for(let p=0;p<d.length;p++){const g=d[p];if(a[g]!==r[g]&&!so(f,g))return!0}}}else return(s||l)&&(!l||!l.$stable)?!0:r===a?!1:r?a?Kc(r,a,f):!0:!!a;return!1}function Kc(e,t,n){const r=Object.keys(t);if(r.length!==Object.keys(e).length)return!0;for(let s=0;s<r.length;s++){const i=r[s];if(t[i]!==e[i]&&!so(n,i))return!0}return!1}function gg({vnode:e,parent:t},n){for(;t;){const r=t.subTree;if(r.suspense&&r.suspense.activeBranch===e&&(r.el=e.el),r===e)(e=t.vnode).el=n,t=t.parent;else break}}const yf=e=>e.__isSuspense;function _g(e,t){t&&t.pendingBranch?et(e)?t.effects.push(...e):t.effects.push(e):bm(e)}const Ie=Symbol.for("v-fgt"),io=Symbol.for("v-txt"),An=Symbol.for("v-cmt"),Ho=Symbol.for("v-stc"),ds=[];let me=null;function ye(e=!1){ds.push(me=e?null:[])}function yg(){ds.pop(),me=ds[ds.length-1]||null}let ws=1;function Gc(e,t=!1){ws+=e,e<0&&me&&t&&(me.hasOnce=!0)}function Ef(e){return e.dynamicChildren=ws>0?me||pr:null,yg(),ws>0&&me&&me.push(e),e}function be(e,t,n,r,s,i){return Ef(st(e,t,n,r,s,i,!0))}function Eg(e,t,n,r,s){return Ef(Se(e,t,n,r,s,!0))}function Tf(e){return e?e.__v_isVNode===!0:!1}function ts(e,t){return e.type===t.type&&e.key===t.key}const vf=({key:e})=>e??null,hi=({ref:e,ref_key:t,ref_for:n})=>(typeof e=="number"&&(e=""+e),e!=null?Mt(e)||te(e)||it(e)?{i:Te,r:e,k:t,f:!!n}:e:null);function st(e,t=null,n=null,r=0,s=null,i=e===Ie?0:1,a=!1,l=!1){const u={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&vf(t),ref:t&&hi(t),scopeId:Yh,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:r,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:Te};return l?(nl(u,n),i&128&&e.normalize(u)):n&&(u.shapeFlag|=Mt(n)?8:16),ws>0&&!a&&me&&(u.patchFlag>0||i&6)&&u.patchFlag!==32&&me.push(u),u}const Se=Tg;function Tg(e,t=null,n=null,r=0,s=null,i=!1){if((!e||e===jm)&&(e=An),Tf(e)){const l=wr(e,t,!0);return n&&nl(l,n),ws>0&&!i&&me&&(l.shapeFlag&6?me[me.indexOf(e)]=l:me.push(l)),l.patchFlag=-2,l}if(xg(e)&&(e=e.__vccOpts),t){t=vg(t);let{class:l,style:u}=t;l&&!Mt(l)&&(t.class=Ji(l)),At(u)&&(Ya(u)&&!et(u)&&(u=ie({},u)),t.style=$a(u))}const a=Mt(e)?1:yf(e)?128:Cm(e)?64:At(e)?4:it(e)?2:0;return st(e,t,n,r,s,a,i,!0)}function vg(e){return e?Ya(e)||af(e)?ie({},e):e:null}function wr(e,t,n=!1,r=!1){const{props:s,ref:i,patchFlag:a,children:l,transition:u}=e,f=t?Ig(s||{},t):s,d={__v_isVNode:!0,__v_skip:!0,type:e.type,props:f,key:f&&vf(f),ref:t&&t.ref?n&&i?et(i)?i.concat(hi(t)):[i,hi(t)]:hi(t):i,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:l,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Ie?a===-1?16:a|16:a,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:u,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&wr(e.ssContent),ssFallback:e.ssFallback&&wr(e.ssFallback),placeholder:e.placeholder,el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return u&&r&&Ja(d,u.clone(d)),d}function wg(e=" ",t=0){return Se(io,null,e,t)}function Si(e="",t=!1){return t?(ye(),Eg(An,null,e)):Se(An,null,e)}function Le(e){return e==null||typeof e=="boolean"?Se(An):et(e)?Se(Ie,null,e.slice()):Tf(e)?pn(e):Se(io,null,String(e))}function pn(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:wr(e)}function nl(e,t){let n=0;const{shapeFlag:r}=e;if(t==null)t=null;else if(et(t))n=16;else if(typeof t=="object")if(r&65){const s=t.default;s&&(s._c&&(s._d=!1),nl(e,s()),s._c&&(s._d=!0));return}else{n=32;const s=t._;!s&&!af(t)?t._ctx=Te:s===3&&Te&&(Te.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else it(t)?(t={default:t,_ctx:Te},n=32):(t=String(t),r&64?(n=16,t=[wg(t)]):n=8);e.children=t,e.shapeFlag|=n}function Ig(...e){const t={};for(let n=0;n<e.length;n++){const r=e[n];for(const s in r)if(s==="class")t.class!==r.class&&(t.class=Ji([t.class,r.class]));else if(s==="style")t.style=$a([t.style,r.style]);else if(Wi(s)){const i=t[s],a=r[s];a&&i!==a&&!(et(i)&&i.includes(a))&&(t[s]=i?[].concat(i,a):a)}else s!==""&&(t[s]=r[s])}return t}function Oe(e,t,n,r=null){ze(e,t,7,[n,r])}const Ag=rf();let bg=0;function Rg(e,t,n){const r=e.type,s=(t?t.appContext:e.appContext)||Ag,i={uid:bg++,vnode:e,type:r,parent:t,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Wp(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(s.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:cf(r,s),emitsOptions:_f(r,s),emit:null,emitted:null,propsDefaults:vt,inheritAttrs:r.inheritAttrs,ctx:vt,data:vt,props:vt,attrs:vt,slots:vt,refs:vt,setupState:vt,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=t?t.root:i,i.emit=hg.bind(null,i),e.ce&&e.ce(i),i}let se=null;const Sg=()=>se||Te;let Ci,ha;{const e=Xi(),t=(n,r)=>{let s;return(s=e[n])||(s=e[n]=[]),s.push(r),i=>{s.length>1?s.forEach(a=>a(i)):s[0](i)}};Ci=t("__VUE_INSTANCE_SETTERS__",n=>se=n),ha=t("__VUE_SSR_SETTERS__",n=>Is=n)}const Os=e=>{const t=se;return Ci(e),e.scope.on(),()=>{e.scope.off(),Ci(t)}},Wc=()=>{se&&se.scope.off(),Ci(null)};function wf(e){return e.vnode.shapeFlag&4}let Is=!1;function Cg(e,t=!1,n=!1){t&&ha(t);const{props:r,children:s}=e.vnode,i=wf(e);Xm(e,r,i,t),eg(e,s,n||t);const a=i?Pg(e,t):void 0;return t&&ha(!1),a}function Pg(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,$m);const{setup:r}=n;if(r){Ze();const s=e.setupContext=r.length>1?Dg(e):null,i=Os(e),a=Ns(r,e,0,[e.props,s]),l=wh(a);if(tn(),i(),(l||e.sp)&&!hs(e)&&Xh(e),l){if(a.then(Wc,Wc),t)return a.then(u=>{Qc(e,u)}).catch(u=>{eo(u,e,0)});e.asyncDep=a}else Qc(e,a)}else If(e)}function Qc(e,t,n){it(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:At(t)&&(e.setupState=Hh(t)),If(e)}function If(e,t,n){const r=e.type;e.render||(e.render=r.render||Fe);{const s=Os(e);Ze();try{qm(e)}finally{tn(),s()}}}const Vg={get(e,t){return Jt(e,"get",""),e[t]}};function Dg(e){const t=n=>{e.exposed=n||{}};return{attrs:new Proxy(e.attrs,Vg),slots:e.slots,emit:e.emit,expose:t}}function oo(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(Hh(mm(e.exposed)),{get(t,n){if(n in t)return t[n];if(n in fs)return fs[n](e)},has(t,n){return n in t||n in fs}})):e.proxy}function xg(e){return it(e)&&"__vccOpts"in e}const Ng=(e,t)=>Tm(e,t,Is),Og="3.5.22";/**
* @vue/runtime-dom v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let fa;const Yc=typeof window<"u"&&window.trustedTypes;if(Yc)try{fa=Yc.createPolicy("vue",{createHTML:e=>e})}catch{}const Af=fa?e=>fa.createHTML(e):e=>e,Mg="http://www.w3.org/2000/svg",kg="http://www.w3.org/1998/Math/MathML",Ye=typeof document<"u"?document:null,Xc=Ye&&Ye.createElement("template"),Lg={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,r)=>{const s=t==="svg"?Ye.createElementNS(Mg,e):t==="mathml"?Ye.createElementNS(kg,e):n?Ye.createElement(e,{is:n}):Ye.createElement(e);return e==="select"&&r&&r.multiple!=null&&s.setAttribute("multiple",r.multiple),s},createText:e=>Ye.createTextNode(e),createComment:e=>Ye.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Ye.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,n,r,s,i){const a=n?n.previousSibling:t.lastChild;if(s&&(s===i||s.nextSibling))for(;t.insertBefore(s.cloneNode(!0),n),!(s===i||!(s=s.nextSibling)););else{Xc.innerHTML=Af(r==="svg"?`<svg>${e}</svg>`:r==="mathml"?`<math>${e}</math>`:e);const l=Xc.content;if(r==="svg"||r==="mathml"){const u=l.firstChild;for(;u.firstChild;)l.appendChild(u.firstChild);l.removeChild(u)}t.insertBefore(l,n)}return[a?a.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}},Fg=Symbol("_vtc");function Ug(e,t,n){const r=e[Fg];r&&(t=(t?[t,...r]:[...r]).join(" ")),t==null?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}const Jc=Symbol("_vod"),Bg=Symbol("_vsh"),jg=Symbol(""),$g=/(?:^|;)\s*display\s*:/;function qg(e,t,n){const r=e.style,s=Mt(n);let i=!1;if(n&&!s){if(t)if(Mt(t))for(const a of t.split(";")){const l=a.slice(0,a.indexOf(":")).trim();n[l]==null&&fi(r,l,"")}else for(const a in t)n[a]==null&&fi(r,a,"");for(const a in n)a==="display"&&(i=!0),fi(r,a,n[a])}else if(s){if(t!==n){const a=r[jg];a&&(n+=";"+a),r.cssText=n,i=$g.test(n)}}else t&&e.removeAttribute("style");Jc in e&&(e[Jc]=i?r.display:"",e[Bg]&&(r.display="none"))}const Zc=/\s*!important$/;function fi(e,t,n){if(et(n))n.forEach(r=>fi(e,t,r));else if(n==null&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const r=Hg(e,t);Zc.test(n)?e.setProperty(Jn(r),n.replace(Zc,""),"important"):e[r]=n}}const tu=["Webkit","Moz","ms"],zo={};function Hg(e,t){const n=zo[t];if(n)return n;let r=wn(t);if(r!=="filter"&&r in e)return zo[t]=r;r=bh(r);for(let s=0;s<tu.length;s++){const i=tu[s]+r;if(i in e)return zo[t]=i}return t}const eu="http://www.w3.org/1999/xlink";function nu(e,t,n,r,s,i=zp(t)){r&&t.startsWith("xlink:")?n==null?e.removeAttributeNS(eu,t.slice(6,t.length)):e.setAttributeNS(eu,t,n):n==null||i&&!Sh(n)?e.removeAttribute(t):e.setAttribute(t,i?"":He(n)?String(n):n)}function ru(e,t,n,r,s){if(t==="innerHTML"||t==="textContent"){n!=null&&(e[t]=t==="innerHTML"?Af(n):n);return}const i=e.tagName;if(t==="value"&&i!=="PROGRESS"&&!i.includes("-")){const l=i==="OPTION"?e.getAttribute("value")||"":e.value,u=n==null?e.type==="checkbox"?"on":"":String(n);(l!==u||!("_value"in e))&&(e.value=u),n==null&&e.removeAttribute(t),e._value=n;return}let a=!1;if(n===""||n==null){const l=typeof e[t];l==="boolean"?n=Sh(n):n==null&&l==="string"?(n="",a=!0):l==="number"&&(n=0,a=!0)}try{e[t]=n}catch{}a&&e.removeAttribute(s||t)}function Hn(e,t,n,r){e.addEventListener(t,n,r)}function zg(e,t,n,r){e.removeEventListener(t,n,r)}const su=Symbol("_vei");function Kg(e,t,n,r,s=null){const i=e[su]||(e[su]={}),a=i[t];if(r&&a)a.value=r;else{const[l,u]=Gg(t);if(r){const f=i[t]=Yg(r,s);Hn(e,l,f,u)}else a&&(zg(e,l,a,u),i[t]=void 0)}}const iu=/(?:Once|Passive|Capture)$/;function Gg(e){let t;if(iu.test(e)){t={};let r;for(;r=e.match(iu);)e=e.slice(0,e.length-r[0].length),t[r[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Jn(e.slice(2)),t]}let Ko=0;const Wg=Promise.resolve(),Qg=()=>Ko||(Wg.then(()=>Ko=0),Ko=Date.now());function Yg(e,t){const n=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=n.attached)return;ze(Xg(r,n.value),t,5,[r])};return n.value=e,n.attached=Qg(),n}function Xg(e,t){if(et(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map(r=>s=>!s._stopped&&r&&r(s))}else return t}const ou=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,Jg=(e,t,n,r,s,i)=>{const a=s==="svg";t==="class"?Ug(e,r,a):t==="style"?qg(e,n,r):Wi(t)?Ua(t)||Kg(e,t,n,r,i):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):Zg(e,t,r,a))?(ru(e,t,r),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&nu(e,t,r,a,i,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!Mt(r))?ru(e,wn(t),r,i,t):(t==="true-value"?e._trueValue=r:t==="false-value"&&(e._falseValue=r),nu(e,t,r,a))};function Zg(e,t,n,r){if(r)return!!(t==="innerHTML"||t==="textContent"||t in e&&ou(t)&&it(n));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const s=e.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return ou(t)&&Mt(n)?!1:t in e}const Pi=e=>{const t=e.props["onUpdate:modelValue"]||!1;return et(t)?n=>li(t,n):t};function t_(e){e.target.composing=!0}function au(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Er=Symbol("_assign"),ei={created(e,{modifiers:{lazy:t,trim:n,number:r}},s){e[Er]=Pi(s);const i=r||s.props&&s.props.type==="number";Hn(e,t?"change":"input",a=>{if(a.target.composing)return;let l=e.value;n&&(l=l.trim()),i&&(l=Ti(l)),e[Er](l)}),n&&Hn(e,"change",()=>{e.value=e.value.trim()}),t||(Hn(e,"compositionstart",t_),Hn(e,"compositionend",au),Hn(e,"change",au))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:n,modifiers:{lazy:r,trim:s,number:i}},a){if(e[Er]=Pi(a),e.composing)return;const l=(i||e.type==="number")&&!/^0\d/.test(e.value)?Ti(e.value):e.value,u=t??"";l!==u&&(document.activeElement===e&&e.type!=="range"&&(r&&t===n||s&&e.value.trim()===u)||(e.value=u))}},e_={deep:!0,created(e,{value:t,modifiers:{number:n}},r){const s=Qi(t);Hn(e,"change",()=>{const i=Array.prototype.filter.call(e.options,a=>a.selected).map(a=>n?Ti(Vi(a)):Vi(a));e[Er](e.multiple?s?new Set(i):i:i[0]),e._assigning=!0,Kh(()=>{e._assigning=!1})}),e[Er]=Pi(r)},mounted(e,{value:t}){lu(e,t)},beforeUpdate(e,t,n){e[Er]=Pi(n)},updated(e,{value:t}){e._assigning||lu(e,t)}};function lu(e,t){const n=e.multiple,r=et(t);if(!(n&&!r&&!Qi(t))){for(let s=0,i=e.options.length;s<i;s++){const a=e.options[s],l=Vi(a);if(n)if(r){const u=typeof l;u==="string"||u==="number"?a.selected=t.some(f=>String(f)===String(l)):a.selected=Gp(t,l)>-1}else a.selected=t.has(l);else if(Zi(Vi(a),t)){e.selectedIndex!==s&&(e.selectedIndex=s);return}}!n&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function Vi(e){return"_value"in e?e._value:e.value}const n_=["ctrl","shift","alt","meta"],r_={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>n_.some(n=>e[`${n}Key`]&&!t.includes(n))},bf=(e,t)=>{const n=e._withMods||(e._withMods={}),r=t.join(".");return n[r]||(n[r]=(s,...i)=>{for(let a=0;a<t.length;a++){const l=r_[t[a]];if(l&&l(s,t))return}return e(s,...i)})},s_=ie({patchProp:Jg},Lg);let cu;function i_(){return cu||(cu=rg(s_))}const o_=(...e)=>{const t=i_().createApp(...e),{mount:n}=t;return t.mount=r=>{const s=l_(r);if(!s)return;const i=t._component;!it(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const a=n(s,!1,a_(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),a},t};function a_(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function l_(e){return Mt(e)?document.querySelector(e):e}const c_="cb053df10ee265cc352d6f92f4942439";let ni=null;function Di(){return typeof window>"u"?Promise.reject(new Error("window is undefined")):window.kakao&&window.kakao.maps?Promise.resolve({kakao:window.kakao}):ni||(ni=new Promise((e,t)=>{const n=document.createElement("script"),r=`https://dapi.kakao.com/v2/maps/sdk.js?autoload=false&appkey=${c_}&libraries=services`;n.src=r,n.async=!0,n.onload=()=>{window.kakao.maps.load(()=>e({kakao:window.kakao}))},n.onerror=()=>t(new Error("카카오 지도 스크립트 로드 실패")),document.head.appendChild(n)}),ni)}async function u_(e){const{kakao:t}=await Di();return new Promise(n=>{new t.maps.services.Geocoder().addressSearch(e,(s,i)=>{if(i===t.maps.services.Status.OK&&s&&s.length>0){const{y:a,x:l}=s[0];n({lat:parseFloat(a),lng:parseFloat(l)})}else n(null)})})}const rl=(e,t)=>{const n=e.__vccOpts||e;for(const[r,s]of t)n[r]=s;return n},h_={key:0,class:"address-results"},f_=["onClick"],d_={class:"address-main"},p_={class:"address-detail"},m_=["disabled"],g_={key:1,class:"error"},__={__name:"HospitalForm",emits:["added"],setup(e,{emit:t}){const n=t,r=ae(""),s=ae(""),i=ae(""),a=ae(""),l=ae([]),u=ae(0),f=ae(!1),d=ae("");async function p(){if(a.value.length<2){l.value=[];return}try{const{kakao:V}=await Di();new V.maps.services.Places().keywordSearch(a.value,(x,$)=>{if($===V.maps.services.Status.OK){const W=x.filter(Q=>Q.category_name.includes("의료")||Q.place_name.includes("병원")||Q.place_name.includes("의원")||Q.place_name.includes("클리닉"));l.value=W.slice(0,5)}else l.value=[]})}catch(V){console.error("주소 검색 오류:",V),l.value=[]}}function g(V){s.value=V.place_name,i.value=V.address_name,a.value="",l.value=[]}async function v(){if(!(!r.value||!s.value||!i.value||u.value==null))try{f.value=!0,d.value="";const{kakao:V}=await Di();new V.maps.services.Geocoder().addressSearch(i.value,(x,$)=>{if($===V.maps.services.Status.OK&&x&&x.length>0){const{y:W,x:Q}=x[0];n("added",{id:`${Date.now()}`,YEAR:r.value,HOSPITAL_NM:s.value,ADDR:i.value,NUM:u.value??0,lat:parseFloat(W),lng:parseFloat(Q)}),r.value="",s.value="",i.value="",a.value="",u.value=0}else d.value="주소를 찾을 수 없습니다.";f.value=!1})}catch(V){d.value=(V==null?void 0:V.message)||"등록 중 오류가 발생했습니다.",f.value=!1}}return(V,P)=>(ye(),be("form",{class:"form",onSubmit:bf(v,["prevent"])},[st("label",null,[P[6]||(P[6]=st("span",null,"등록 연도",-1)),Zr(st("select",{"onUpdate:modelValue":P[0]||(P[0]=x=>r.value=x),required:""},[...P[5]||(P[5]=[st("option",{value:""},"연도를 선택하세요",-1),st("option",{value:"2024"},"2024년",-1),st("option",{value:"2025"},"2025년",-1)])],512),[[e_,r.value]])]),st("label",null,[P[7]||(P[7]=st("span",null,"병원 주소 검색",-1)),Zr(st("input",{"onUpdate:modelValue":P[1]||(P[1]=x=>a.value=x),onInput:p,placeholder:"주소를 입력하세요 (예: 서울특별시 강남구)"},null,544),[[ei,a.value,void 0,{trim:!0}]])]),st("label",null,[P[8]||(P[8]=st("span",null,"병원 이름",-1)),Zr(st("input",{"onUpdate:modelValue":P[2]||(P[2]=x=>s.value=x),required:"",placeholder:"예) 행복병원"},null,512),[[ei,s.value,void 0,{trim:!0}]])]),l.value.length>0?(ye(),be("div",h_,[(ye(!0),be(Ie,null,tf(l.value,(x,$)=>(ye(),be("div",{key:$,class:"address-item",onClick:W=>g(x)},[st("div",d_,Ae(x.place_name),1),st("div",p_,Ae(x.address_name),1)],8,f_))),128))])):Si("",!0),st("label",null,[P[9]||(P[9]=st("span",null,"병원 주소",-1)),Zr(st("input",{"onUpdate:modelValue":P[3]||(P[3]=x=>i.value=x),required:"",placeholder:"주소를 검색하여 선택하세요",readonly:""},null,512),[[ei,i.value,void 0,{trim:!0}]])]),st("label",null,[P[10]||(P[10]=st("span",null,"모집인원 수",-1)),Zr(st("input",{"onUpdate:modelValue":P[4]||(P[4]=x=>u.value=x),type:"number",min:"0",required:""},null,512),[[ei,u.value,void 0,{number:!0}]])]),st("button",{disabled:f.value},Ae(f.value?"등록 중…":"등록"),9,m_),d.value?(ye(),be("p",g_,Ae(d.value),1)):Si("",!0)],32))}},y_=rl(__,[["__scopeId","data-v-e6307935"]]),E_=()=>{};var uu={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rf=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let s=e.charCodeAt(r);s<128?t[n++]=s:s<2048?(t[n++]=s>>6|192,t[n++]=s&63|128):(s&64512)===55296&&r+1<e.length&&(e.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(e.charCodeAt(++r)&1023),t[n++]=s>>18|240,t[n++]=s>>12&63|128,t[n++]=s>>6&63|128,t[n++]=s&63|128):(t[n++]=s>>12|224,t[n++]=s>>6&63|128,t[n++]=s&63|128)}return t},T_=function(e){const t=[];let n=0,r=0;for(;n<e.length;){const s=e[n++];if(s<128)t[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=e[n++];t[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=e[n++],a=e[n++],l=e[n++],u=((s&7)<<18|(i&63)<<12|(a&63)<<6|l&63)-65536;t[r++]=String.fromCharCode(55296+(u>>10)),t[r++]=String.fromCharCode(56320+(u&1023))}else{const i=e[n++],a=e[n++];t[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return t.join("")},Sf={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<e.length;s+=3){const i=e[s],a=s+1<e.length,l=a?e[s+1]:0,u=s+2<e.length,f=u?e[s+2]:0,d=i>>2,p=(i&3)<<4|l>>4;let g=(l&15)<<2|f>>6,v=f&63;u||(v=64,a||(g=64)),r.push(n[d],n[p],n[g],n[v])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(Rf(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):T_(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<e.length;){const i=n[e.charAt(s++)],l=s<e.length?n[e.charAt(s)]:0;++s;const f=s<e.length?n[e.charAt(s)]:64;++s;const p=s<e.length?n[e.charAt(s)]:64;if(++s,i==null||l==null||f==null||p==null)throw new v_;const g=i<<2|l>>4;if(r.push(g),f!==64){const v=l<<4&240|f>>2;if(r.push(v),p!==64){const V=f<<6&192|p;r.push(V)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class v_ extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const w_=function(e){const t=Rf(e);return Sf.encodeByteArray(t,!0)},xi=function(e){return w_(e).replace(/\./g,"")},I_=function(e){try{return Sf.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A_(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b_=()=>A_().__FIREBASE_DEFAULTS__,R_=()=>{if(typeof process>"u"||typeof uu>"u")return;const e=uu.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},S_=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&I_(e[1]);return t&&JSON.parse(t)},sl=()=>{try{return E_()||b_()||R_()||S_()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},C_=e=>{var t,n;return(n=(t=sl())==null?void 0:t.emulatorHosts)==null?void 0:n[e]},P_=e=>{const t=C_(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return t[0]==="["?[t.substring(1,n-1),r]:[t.substring(0,n),r]},Cf=()=>{var e;return(e=sl())==null?void 0:e.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V_{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}wrapCallback(t){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(n):t(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function il(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch{return!1}}async function D_(e){return(await fetch(e,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x_(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=t||"demo-project",s=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...e};return[xi(JSON.stringify(n)),xi(JSON.stringify(a)),""].join(".")}const ps={};function N_(){const e={prod:[],emulator:[]};for(const t of Object.keys(ps))ps[t]?e.emulator.push(t):e.prod.push(t);return e}function O_(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),n=!0),{created:n,element:t}}let hu=!1;function M_(e,t){if(typeof window>"u"||typeof document>"u"||!il(window.location.host)||ps[e]===t||ps[e]||hu)return;ps[e]=t;function n(g){return`__firebase__banner__${g}`}const r="__firebase__banner",i=N_().prod.length>0;function a(){const g=document.getElementById(r);g&&g.remove()}function l(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function u(g,v){g.setAttribute("width","24"),g.setAttribute("id",v),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function f(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{hu=!0,a()},g}function d(g,v){g.setAttribute("id",v),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function p(){const g=O_(r),v=n("text"),V=document.getElementById(v)||document.createElement("span"),P=n("learnmore"),x=document.getElementById(P)||document.createElement("a"),$=n("preprendIcon"),W=document.getElementById($)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const Q=g.element;l(Q),d(x,P);const G=f();u(W,$),Q.append(W,V,x,G),document.body.appendChild(Q)}i?(V.innerText="Preview backend disconnected.",W.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(W.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,V.innerText="Preview backend running in this workspace."),V.setAttribute("id",v)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k_(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function L_(){var t;const e=(t=sl())==null?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function F_(){return!L_()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function U_(){try{return typeof indexedDB=="object"}catch{return!1}}function B_(){return new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;t(((i=s.error)==null?void 0:i.message)||"")}}catch(n){t(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j_="FirebaseError";class Pr extends Error{constructor(t,n,r){super(n),this.code=t,this.customData=r,this.name=j_,Object.setPrototypeOf(this,Pr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Pf.prototype.create)}}class Pf{constructor(t,n,r){this.service=t,this.serviceName=n,this.errors=r}create(t,...n){const r=n[0]||{},s=`${this.service}/${t}`,i=this.errors[t],a=i?$_(i,r):"Error",l=`${this.serviceName}: ${a} (${s}).`;return new Pr(s,l,r)}}function $_(e,t){return e.replace(q_,(n,r)=>{const s=t[r];return s!=null?String(s):`<${r}?>`})}const q_=/\{\$([^}]+)}/g;function Ni(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const s of n){if(!r.includes(s))return!1;const i=e[s],a=t[s];if(fu(i)&&fu(a)){if(!Ni(i,a))return!1}else if(i!==a)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function fu(e){return e!==null&&typeof e=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ke(e){return e&&e._delegate?e._delegate:e}class As{constructor(t,n,r){this.name=t,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qn="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H_{constructor(t,n){this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const n=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(n)){const r=new V_;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(t){const n=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),r=(t==null?void 0:t.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(K_(t))try{this.getOrInitializeService({instanceIdentifier:qn})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(t=qn){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...t.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=qn){return this.instances.has(t)}getOptions(t=qn){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:n={}}=t,r=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,a]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&a.resolve(s)}return s}onInit(t,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(t),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&t(i,r),()=>{s.delete(t)}}invokeOnInitCallbacks(t,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(t,n)}catch{}}getOrInitializeService({instanceIdentifier:t,options:n={}}){let r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:z_(t),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch{}return r||null}normalizeInstanceIdentifier(t=qn){return this.component?this.component.multipleInstances?t:qn:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function z_(e){return e===qn?void 0:e}function K_(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G_{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const n=this.getProvider(t.name);if(n.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);n.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const n=new H_(t,this);return this.providers.set(t,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ft;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(ft||(ft={}));const W_={debug:ft.DEBUG,verbose:ft.VERBOSE,info:ft.INFO,warn:ft.WARN,error:ft.ERROR,silent:ft.SILENT},Q_=ft.INFO,Y_={[ft.DEBUG]:"log",[ft.VERBOSE]:"log",[ft.INFO]:"info",[ft.WARN]:"warn",[ft.ERROR]:"error"},X_=(e,t,...n)=>{if(t<e.logLevel)return;const r=new Date().toISOString(),s=Y_[t];if(s)console[s](`[${r}]  ${e.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class Vf{constructor(t){this.name=t,this._logLevel=Q_,this._logHandler=X_,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in ft))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?W_[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,ft.DEBUG,...t),this._logHandler(this,ft.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,ft.VERBOSE,...t),this._logHandler(this,ft.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,ft.INFO,...t),this._logHandler(this,ft.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,ft.WARN,...t),this._logHandler(this,ft.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,ft.ERROR,...t),this._logHandler(this,ft.ERROR,...t)}}const J_=(e,t)=>t.some(n=>e instanceof n);let du,pu;function Z_(){return du||(du=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ty(){return pu||(pu=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Df=new WeakMap,da=new WeakMap,xf=new WeakMap,Go=new WeakMap,ol=new WeakMap;function ey(e){const t=new Promise((n,r)=>{const s=()=>{e.removeEventListener("success",i),e.removeEventListener("error",a)},i=()=>{n(_n(e.result)),s()},a=()=>{r(e.error),s()};e.addEventListener("success",i),e.addEventListener("error",a)});return t.then(n=>{n instanceof IDBCursor&&Df.set(n,e)}).catch(()=>{}),ol.set(t,e),t}function ny(e){if(da.has(e))return;const t=new Promise((n,r)=>{const s=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",a),e.removeEventListener("abort",a)},i=()=>{n(),s()},a=()=>{r(e.error||new DOMException("AbortError","AbortError")),s()};e.addEventListener("complete",i),e.addEventListener("error",a),e.addEventListener("abort",a)});da.set(e,t)}let pa={get(e,t,n){if(e instanceof IDBTransaction){if(t==="done")return da.get(e);if(t==="objectStoreNames")return e.objectStoreNames||xf.get(e);if(t==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return _n(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function ry(e){pa=e(pa)}function sy(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...n){const r=e.call(Wo(this),t,...n);return xf.set(r,t.sort?t.sort():[t]),_n(r)}:ty().includes(e)?function(...t){return e.apply(Wo(this),t),_n(Df.get(this))}:function(...t){return _n(e.apply(Wo(this),t))}}function iy(e){return typeof e=="function"?sy(e):(e instanceof IDBTransaction&&ny(e),J_(e,Z_())?new Proxy(e,pa):e)}function _n(e){if(e instanceof IDBRequest)return ey(e);if(Go.has(e))return Go.get(e);const t=iy(e);return t!==e&&(Go.set(e,t),ol.set(t,e)),t}const Wo=e=>ol.get(e);function oy(e,t,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const a=indexedDB.open(e,t),l=_n(a);return r&&a.addEventListener("upgradeneeded",u=>{r(_n(a.result),u.oldVersion,u.newVersion,_n(a.transaction),u)}),n&&a.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),l.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",f=>s(f.oldVersion,f.newVersion,f))}).catch(()=>{}),l}const ay=["get","getKey","getAll","getAllKeys","count"],ly=["put","add","delete","clear"],Qo=new Map;function mu(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(Qo.get(t))return Qo.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,s=ly.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||ay.includes(n)))return;const i=async function(a,...l){const u=this.transaction(a,s?"readwrite":"readonly");let f=u.store;return r&&(f=f.index(l.shift())),(await Promise.all([f[n](...l),s&&u.done]))[0]};return Qo.set(t,i),i}ry(e=>({...e,get:(t,n,r)=>mu(t,n)||e.get(t,n,r),has:(t,n)=>!!mu(t,n)||e.has(t,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cy{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(uy(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function uy(e){const t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}const ma="@firebase/app",gu="0.14.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const en=new Vf("@firebase/app"),hy="@firebase/app-compat",fy="@firebase/analytics-compat",dy="@firebase/analytics",py="@firebase/app-check-compat",my="@firebase/app-check",gy="@firebase/auth",_y="@firebase/auth-compat",yy="@firebase/database",Ey="@firebase/data-connect",Ty="@firebase/database-compat",vy="@firebase/functions",wy="@firebase/functions-compat",Iy="@firebase/installations",Ay="@firebase/installations-compat",by="@firebase/messaging",Ry="@firebase/messaging-compat",Sy="@firebase/performance",Cy="@firebase/performance-compat",Py="@firebase/remote-config",Vy="@firebase/remote-config-compat",Dy="@firebase/storage",xy="@firebase/storage-compat",Ny="@firebase/firestore",Oy="@firebase/ai",My="@firebase/firestore-compat",ky="firebase",Ly="12.4.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ga="[DEFAULT]",Fy={[ma]:"fire-core",[hy]:"fire-core-compat",[dy]:"fire-analytics",[fy]:"fire-analytics-compat",[my]:"fire-app-check",[py]:"fire-app-check-compat",[gy]:"fire-auth",[_y]:"fire-auth-compat",[yy]:"fire-rtdb",[Ey]:"fire-data-connect",[Ty]:"fire-rtdb-compat",[vy]:"fire-fn",[wy]:"fire-fn-compat",[Iy]:"fire-iid",[Ay]:"fire-iid-compat",[by]:"fire-fcm",[Ry]:"fire-fcm-compat",[Sy]:"fire-perf",[Cy]:"fire-perf-compat",[Py]:"fire-rc",[Vy]:"fire-rc-compat",[Dy]:"fire-gcs",[xy]:"fire-gcs-compat",[Ny]:"fire-fst",[My]:"fire-fst-compat",[Oy]:"fire-vertex","fire-js":"fire-js",[ky]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oi=new Map,Uy=new Map,_a=new Map;function _u(e,t){try{e.container.addComponent(t)}catch(n){en.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function Mi(e){const t=e.name;if(_a.has(t))return en.debug(`There were multiple attempts to register component ${t}.`),!1;_a.set(t,e);for(const n of Oi.values())_u(n,e);for(const n of Uy.values())_u(n,e);return!0}function By(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function jy(e){return e==null?!1:e.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $y={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},yn=new Pf("app","Firebase",$y);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qy{constructor(t,n,r){this._isDeleted=!1,this._options={...t},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new As("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw yn.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hy=Ly;function Nf(e,t={}){let n=e;typeof t!="object"&&(t={name:t});const r={name:ga,automaticDataCollectionEnabled:!0,...t},s=r.name;if(typeof s!="string"||!s)throw yn.create("bad-app-name",{appName:String(s)});if(n||(n=Cf()),!n)throw yn.create("no-options");const i=Oi.get(s);if(i){if(Ni(n,i.options)&&Ni(r,i.config))return i;throw yn.create("duplicate-app",{appName:s})}const a=new G_(s);for(const u of _a.values())a.addComponent(u);const l=new qy(n,r,a);return Oi.set(s,l),l}function zy(e=ga){const t=Oi.get(e);if(!t&&e===ga&&Cf())return Nf();if(!t)throw yn.create("no-app",{appName:e});return t}function Tr(e,t,n){let r=Fy[e]??e;n&&(r+=`-${n}`);const s=r.match(/\s|\//),i=t.match(/\s|\//);if(s||i){const a=[`Unable to register library "${r}" with version "${t}":`];s&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&a.push("and"),i&&a.push(`version name "${t}" contains illegal characters (whitespace or "/")`),en.warn(a.join(" "));return}Mi(new As(`${r}-version`,()=>({library:r,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ky="firebase-heartbeat-database",Gy=1,bs="firebase-heartbeat-store";let Yo=null;function Of(){return Yo||(Yo=oy(Ky,Gy,{upgrade:(e,t)=>{switch(t){case 0:try{e.createObjectStore(bs)}catch(n){console.warn(n)}}}}).catch(e=>{throw yn.create("idb-open",{originalErrorMessage:e.message})})),Yo}async function Wy(e){try{const n=(await Of()).transaction(bs),r=await n.objectStore(bs).get(Mf(e));return await n.done,r}catch(t){if(t instanceof Pr)en.warn(t.message);else{const n=yn.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});en.warn(n.message)}}}async function yu(e,t){try{const r=(await Of()).transaction(bs,"readwrite");await r.objectStore(bs).put(t,Mf(e)),await r.done}catch(n){if(n instanceof Pr)en.warn(n.message);else{const r=yn.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});en.warn(r.message)}}}function Mf(e){return`${e.name}!${e.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qy=1024,Yy=30;class Xy{constructor(t){this.container=t,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new Zy(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var t,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Eu();if(((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>Yy){const a=tE(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){en.warn(r)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Eu(),{heartbeatsToSend:r,unsentEntries:s}=Jy(this._heartbeatsCache.heartbeats),i=xi(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return en.warn(n),""}}}function Eu(){return new Date().toISOString().substring(0,10)}function Jy(e,t=Qy){const n=[];let r=e.slice();for(const s of e){const i=n.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),Tu(n)>t){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Tu(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class Zy{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return U_()?B_().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await Wy(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){if(await this._canUseIndexedDBPromise){const r=await this.read();return yu(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){if(await this._canUseIndexedDBPromise){const r=await this.read();return yu(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...t.heartbeats]})}else return}}function Tu(e){return xi(JSON.stringify({version:2,heartbeats:e})).length}function tE(e){if(e.length===0)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eE(e){Mi(new As("platform-logger",t=>new cy(t),"PRIVATE")),Mi(new As("heartbeat",t=>new Xy(t),"PRIVATE")),Tr(ma,gu,e),Tr(ma,gu,"esm2020"),Tr("fire-js","")}eE("");var vu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var En,kf;(function(){var e;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(I,_){function T(){}T.prototype=_.prototype,I.F=_.prototype,I.prototype=new T,I.prototype.constructor=I,I.D=function(A,w,R){for(var y=Array(arguments.length-2),Ft=2;Ft<arguments.length;Ft++)y[Ft-2]=arguments[Ft];return _.prototype[w].apply(A,y)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}t(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(I,_,T){T||(T=0);const A=Array(16);if(typeof _=="string")for(var w=0;w<16;++w)A[w]=_.charCodeAt(T++)|_.charCodeAt(T++)<<8|_.charCodeAt(T++)<<16|_.charCodeAt(T++)<<24;else for(w=0;w<16;++w)A[w]=_[T++]|_[T++]<<8|_[T++]<<16|_[T++]<<24;_=I.g[0],T=I.g[1],w=I.g[2];let R=I.g[3],y;y=_+(R^T&(w^R))+A[0]+3614090360&4294967295,_=T+(y<<7&4294967295|y>>>25),y=R+(w^_&(T^w))+A[1]+3905402710&4294967295,R=_+(y<<12&4294967295|y>>>20),y=w+(T^R&(_^T))+A[2]+606105819&4294967295,w=R+(y<<17&4294967295|y>>>15),y=T+(_^w&(R^_))+A[3]+3250441966&4294967295,T=w+(y<<22&4294967295|y>>>10),y=_+(R^T&(w^R))+A[4]+4118548399&4294967295,_=T+(y<<7&4294967295|y>>>25),y=R+(w^_&(T^w))+A[5]+1200080426&4294967295,R=_+(y<<12&4294967295|y>>>20),y=w+(T^R&(_^T))+A[6]+2821735955&4294967295,w=R+(y<<17&4294967295|y>>>15),y=T+(_^w&(R^_))+A[7]+4249261313&4294967295,T=w+(y<<22&4294967295|y>>>10),y=_+(R^T&(w^R))+A[8]+1770035416&4294967295,_=T+(y<<7&4294967295|y>>>25),y=R+(w^_&(T^w))+A[9]+2336552879&4294967295,R=_+(y<<12&4294967295|y>>>20),y=w+(T^R&(_^T))+A[10]+4294925233&4294967295,w=R+(y<<17&4294967295|y>>>15),y=T+(_^w&(R^_))+A[11]+2304563134&4294967295,T=w+(y<<22&4294967295|y>>>10),y=_+(R^T&(w^R))+A[12]+1804603682&4294967295,_=T+(y<<7&4294967295|y>>>25),y=R+(w^_&(T^w))+A[13]+4254626195&4294967295,R=_+(y<<12&4294967295|y>>>20),y=w+(T^R&(_^T))+A[14]+2792965006&4294967295,w=R+(y<<17&4294967295|y>>>15),y=T+(_^w&(R^_))+A[15]+1236535329&4294967295,T=w+(y<<22&4294967295|y>>>10),y=_+(w^R&(T^w))+A[1]+4129170786&4294967295,_=T+(y<<5&4294967295|y>>>27),y=R+(T^w&(_^T))+A[6]+3225465664&4294967295,R=_+(y<<9&4294967295|y>>>23),y=w+(_^T&(R^_))+A[11]+643717713&4294967295,w=R+(y<<14&4294967295|y>>>18),y=T+(R^_&(w^R))+A[0]+3921069994&4294967295,T=w+(y<<20&4294967295|y>>>12),y=_+(w^R&(T^w))+A[5]+3593408605&4294967295,_=T+(y<<5&4294967295|y>>>27),y=R+(T^w&(_^T))+A[10]+38016083&4294967295,R=_+(y<<9&4294967295|y>>>23),y=w+(_^T&(R^_))+A[15]+3634488961&4294967295,w=R+(y<<14&4294967295|y>>>18),y=T+(R^_&(w^R))+A[4]+3889429448&4294967295,T=w+(y<<20&4294967295|y>>>12),y=_+(w^R&(T^w))+A[9]+568446438&4294967295,_=T+(y<<5&4294967295|y>>>27),y=R+(T^w&(_^T))+A[14]+3275163606&4294967295,R=_+(y<<9&4294967295|y>>>23),y=w+(_^T&(R^_))+A[3]+4107603335&4294967295,w=R+(y<<14&4294967295|y>>>18),y=T+(R^_&(w^R))+A[8]+1163531501&4294967295,T=w+(y<<20&4294967295|y>>>12),y=_+(w^R&(T^w))+A[13]+2850285829&4294967295,_=T+(y<<5&4294967295|y>>>27),y=R+(T^w&(_^T))+A[2]+4243563512&4294967295,R=_+(y<<9&4294967295|y>>>23),y=w+(_^T&(R^_))+A[7]+1735328473&4294967295,w=R+(y<<14&4294967295|y>>>18),y=T+(R^_&(w^R))+A[12]+2368359562&4294967295,T=w+(y<<20&4294967295|y>>>12),y=_+(T^w^R)+A[5]+4294588738&4294967295,_=T+(y<<4&4294967295|y>>>28),y=R+(_^T^w)+A[8]+2272392833&4294967295,R=_+(y<<11&4294967295|y>>>21),y=w+(R^_^T)+A[11]+1839030562&4294967295,w=R+(y<<16&4294967295|y>>>16),y=T+(w^R^_)+A[14]+4259657740&4294967295,T=w+(y<<23&4294967295|y>>>9),y=_+(T^w^R)+A[1]+2763975236&4294967295,_=T+(y<<4&4294967295|y>>>28),y=R+(_^T^w)+A[4]+1272893353&4294967295,R=_+(y<<11&4294967295|y>>>21),y=w+(R^_^T)+A[7]+4139469664&4294967295,w=R+(y<<16&4294967295|y>>>16),y=T+(w^R^_)+A[10]+3200236656&4294967295,T=w+(y<<23&4294967295|y>>>9),y=_+(T^w^R)+A[13]+681279174&4294967295,_=T+(y<<4&4294967295|y>>>28),y=R+(_^T^w)+A[0]+3936430074&4294967295,R=_+(y<<11&4294967295|y>>>21),y=w+(R^_^T)+A[3]+3572445317&4294967295,w=R+(y<<16&4294967295|y>>>16),y=T+(w^R^_)+A[6]+76029189&4294967295,T=w+(y<<23&4294967295|y>>>9),y=_+(T^w^R)+A[9]+3654602809&4294967295,_=T+(y<<4&4294967295|y>>>28),y=R+(_^T^w)+A[12]+3873151461&4294967295,R=_+(y<<11&4294967295|y>>>21),y=w+(R^_^T)+A[15]+530742520&4294967295,w=R+(y<<16&4294967295|y>>>16),y=T+(w^R^_)+A[2]+3299628645&4294967295,T=w+(y<<23&4294967295|y>>>9),y=_+(w^(T|~R))+A[0]+4096336452&4294967295,_=T+(y<<6&4294967295|y>>>26),y=R+(T^(_|~w))+A[7]+1126891415&4294967295,R=_+(y<<10&4294967295|y>>>22),y=w+(_^(R|~T))+A[14]+2878612391&4294967295,w=R+(y<<15&4294967295|y>>>17),y=T+(R^(w|~_))+A[5]+4237533241&4294967295,T=w+(y<<21&4294967295|y>>>11),y=_+(w^(T|~R))+A[12]+1700485571&4294967295,_=T+(y<<6&4294967295|y>>>26),y=R+(T^(_|~w))+A[3]+2399980690&4294967295,R=_+(y<<10&4294967295|y>>>22),y=w+(_^(R|~T))+A[10]+4293915773&4294967295,w=R+(y<<15&4294967295|y>>>17),y=T+(R^(w|~_))+A[1]+2240044497&4294967295,T=w+(y<<21&4294967295|y>>>11),y=_+(w^(T|~R))+A[8]+1873313359&4294967295,_=T+(y<<6&4294967295|y>>>26),y=R+(T^(_|~w))+A[15]+4264355552&4294967295,R=_+(y<<10&4294967295|y>>>22),y=w+(_^(R|~T))+A[6]+2734768916&4294967295,w=R+(y<<15&4294967295|y>>>17),y=T+(R^(w|~_))+A[13]+1309151649&4294967295,T=w+(y<<21&4294967295|y>>>11),y=_+(w^(T|~R))+A[4]+4149444226&4294967295,_=T+(y<<6&4294967295|y>>>26),y=R+(T^(_|~w))+A[11]+3174756917&4294967295,R=_+(y<<10&4294967295|y>>>22),y=w+(_^(R|~T))+A[2]+718787259&4294967295,w=R+(y<<15&4294967295|y>>>17),y=T+(R^(w|~_))+A[9]+3951481745&4294967295,I.g[0]=I.g[0]+_&4294967295,I.g[1]=I.g[1]+(w+(y<<21&4294967295|y>>>11))&4294967295,I.g[2]=I.g[2]+w&4294967295,I.g[3]=I.g[3]+R&4294967295}r.prototype.v=function(I,_){_===void 0&&(_=I.length);const T=_-this.blockSize,A=this.C;let w=this.h,R=0;for(;R<_;){if(w==0)for(;R<=T;)s(this,I,R),R+=this.blockSize;if(typeof I=="string"){for(;R<_;)if(A[w++]=I.charCodeAt(R++),w==this.blockSize){s(this,A),w=0;break}}else for(;R<_;)if(A[w++]=I[R++],w==this.blockSize){s(this,A),w=0;break}}this.h=w,this.o+=_},r.prototype.A=function(){var I=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);I[0]=128;for(var _=1;_<I.length-8;++_)I[_]=0;_=this.o*8;for(var T=I.length-8;T<I.length;++T)I[T]=_&255,_/=256;for(this.v(I),I=Array(16),_=0,T=0;T<4;++T)for(let A=0;A<32;A+=8)I[_++]=this.g[T]>>>A&255;return I};function i(I,_){var T=l;return Object.prototype.hasOwnProperty.call(T,I)?T[I]:T[I]=_(I)}function a(I,_){this.h=_;const T=[];let A=!0;for(let w=I.length-1;w>=0;w--){const R=I[w]|0;A&&R==_||(T[w]=R,A=!1)}this.g=T}var l={};function u(I){return-128<=I&&I<128?i(I,function(_){return new a([_|0],_<0?-1:0)}):new a([I|0],I<0?-1:0)}function f(I){if(isNaN(I)||!isFinite(I))return p;if(I<0)return x(f(-I));const _=[];let T=1;for(let A=0;I>=T;A++)_[A]=I/T|0,T*=4294967296;return new a(_,0)}function d(I,_){if(I.length==0)throw Error("number format error: empty string");if(_=_||10,_<2||36<_)throw Error("radix out of range: "+_);if(I.charAt(0)=="-")return x(d(I.substring(1),_));if(I.indexOf("-")>=0)throw Error('number format error: interior "-" character');const T=f(Math.pow(_,8));let A=p;for(let R=0;R<I.length;R+=8){var w=Math.min(8,I.length-R);const y=parseInt(I.substring(R,R+w),_);w<8?(w=f(Math.pow(_,w)),A=A.j(w).add(f(y))):(A=A.j(T),A=A.add(f(y)))}return A}var p=u(0),g=u(1),v=u(16777216);e=a.prototype,e.m=function(){if(P(this))return-x(this).m();let I=0,_=1;for(let T=0;T<this.g.length;T++){const A=this.i(T);I+=(A>=0?A:4294967296+A)*_,_*=4294967296}return I},e.toString=function(I){if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(V(this))return"0";if(P(this))return"-"+x(this).toString(I);const _=f(Math.pow(I,6));var T=this;let A="";for(;;){const w=G(T,_).g;T=$(T,w.j(_));let R=((T.g.length>0?T.g[0]:T.h)>>>0).toString(I);if(T=w,V(T))return R+A;for(;R.length<6;)R="0"+R;A=R+A}},e.i=function(I){return I<0?0:I<this.g.length?this.g[I]:this.h};function V(I){if(I.h!=0)return!1;for(let _=0;_<I.g.length;_++)if(I.g[_]!=0)return!1;return!0}function P(I){return I.h==-1}e.l=function(I){return I=$(this,I),P(I)?-1:V(I)?0:1};function x(I){const _=I.g.length,T=[];for(let A=0;A<_;A++)T[A]=~I.g[A];return new a(T,~I.h).add(g)}e.abs=function(){return P(this)?x(this):this},e.add=function(I){const _=Math.max(this.g.length,I.g.length),T=[];let A=0;for(let w=0;w<=_;w++){let R=A+(this.i(w)&65535)+(I.i(w)&65535),y=(R>>>16)+(this.i(w)>>>16)+(I.i(w)>>>16);A=y>>>16,R&=65535,y&=65535,T[w]=y<<16|R}return new a(T,T[T.length-1]&-2147483648?-1:0)};function $(I,_){return I.add(x(_))}e.j=function(I){if(V(this)||V(I))return p;if(P(this))return P(I)?x(this).j(x(I)):x(x(this).j(I));if(P(I))return x(this.j(x(I)));if(this.l(v)<0&&I.l(v)<0)return f(this.m()*I.m());const _=this.g.length+I.g.length,T=[];for(var A=0;A<2*_;A++)T[A]=0;for(A=0;A<this.g.length;A++)for(let w=0;w<I.g.length;w++){const R=this.i(A)>>>16,y=this.i(A)&65535,Ft=I.i(w)>>>16,Ve=I.i(w)&65535;T[2*A+2*w]+=y*Ve,W(T,2*A+2*w),T[2*A+2*w+1]+=R*Ve,W(T,2*A+2*w+1),T[2*A+2*w+1]+=y*Ft,W(T,2*A+2*w+1),T[2*A+2*w+2]+=R*Ft,W(T,2*A+2*w+2)}for(I=0;I<_;I++)T[I]=T[2*I+1]<<16|T[2*I];for(I=_;I<2*_;I++)T[I]=0;return new a(T,0)};function W(I,_){for(;(I[_]&65535)!=I[_];)I[_+1]+=I[_]>>>16,I[_]&=65535,_++}function Q(I,_){this.g=I,this.h=_}function G(I,_){if(V(_))throw Error("division by zero");if(V(I))return new Q(p,p);if(P(I))return _=G(x(I),_),new Q(x(_.g),x(_.h));if(P(_))return _=G(I,x(_)),new Q(x(_.g),_.h);if(I.g.length>30){if(P(I)||P(_))throw Error("slowDivide_ only works with positive integers.");for(var T=g,A=_;A.l(I)<=0;)T=ut(T),A=ut(A);var w=yt(T,1),R=yt(A,1);for(A=yt(A,2),T=yt(T,2);!V(A);){var y=R.add(A);y.l(I)<=0&&(w=w.add(T),R=y),A=yt(A,1),T=yt(T,1)}return _=$(I,w.j(_)),new Q(w,_)}for(w=p;I.l(_)>=0;){for(T=Math.max(1,Math.floor(I.m()/_.m())),A=Math.ceil(Math.log(T)/Math.LN2),A=A<=48?1:Math.pow(2,A-48),R=f(T),y=R.j(_);P(y)||y.l(I)>0;)T-=A,R=f(T),y=R.j(_);V(R)&&(R=g),w=w.add(R),I=$(I,y)}return new Q(w,I)}e.B=function(I){return G(this,I).h},e.and=function(I){const _=Math.max(this.g.length,I.g.length),T=[];for(let A=0;A<_;A++)T[A]=this.i(A)&I.i(A);return new a(T,this.h&I.h)},e.or=function(I){const _=Math.max(this.g.length,I.g.length),T=[];for(let A=0;A<_;A++)T[A]=this.i(A)|I.i(A);return new a(T,this.h|I.h)},e.xor=function(I){const _=Math.max(this.g.length,I.g.length),T=[];for(let A=0;A<_;A++)T[A]=this.i(A)^I.i(A);return new a(T,this.h^I.h)};function ut(I){const _=I.g.length+1,T=[];for(let A=0;A<_;A++)T[A]=I.i(A)<<1|I.i(A-1)>>>31;return new a(T,I.h)}function yt(I,_){const T=_>>5;_%=32;const A=I.g.length-T,w=[];for(let R=0;R<A;R++)w[R]=_>0?I.i(R+T)>>>_|I.i(R+T+1)<<32-_:I.i(R+T);return new a(w,I.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,kf=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=f,a.fromString=d,En=a}).apply(typeof vu<"u"?vu:typeof self<"u"?self:typeof window<"u"?window:{});var ri=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Lf,rs,Ff,di,ya,Uf,Bf,jf;(function(){var e,t=Object.defineProperty;function n(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof ri=="object"&&ri];for(var c=0;c<o.length;++c){var h=o[c];if(h&&h.Math==Math)return h}throw Error("Cannot find global object")}var r=n(this);function s(o,c){if(c)t:{var h=r;o=o.split(".");for(var m=0;m<o.length-1;m++){var S=o[m];if(!(S in h))break t;h=h[S]}o=o[o.length-1],m=h[o],c=c(m),c!=m&&c!=null&&t(h,o,{configurable:!0,writable:!0,value:c})}}s("Symbol.dispose",function(o){return o||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(o){return o||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(o){return o||function(c){var h=[],m;for(m in c)Object.prototype.hasOwnProperty.call(c,m)&&h.push([m,c[m]]);return h}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},a=this||self;function l(o){var c=typeof o;return c=="object"&&o!=null||c=="function"}function u(o,c,h){return o.call.apply(o.bind,arguments)}function f(o,c,h){return f=u,f.apply(null,arguments)}function d(o,c){var h=Array.prototype.slice.call(arguments,1);return function(){var m=h.slice();return m.push.apply(m,arguments),o.apply(this,m)}}function p(o,c){function h(){}h.prototype=c.prototype,o.Z=c.prototype,o.prototype=new h,o.prototype.constructor=o,o.Ob=function(m,S,C){for(var j=Array(arguments.length-2),ot=2;ot<arguments.length;ot++)j[ot-2]=arguments[ot];return c.prototype[S].apply(m,j)}}var g=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?o=>o&&AsyncContext.Snapshot.wrap(o):o=>o;function v(o){const c=o.length;if(c>0){const h=Array(c);for(let m=0;m<c;m++)h[m]=o[m];return h}return[]}function V(o,c){for(let m=1;m<arguments.length;m++){const S=arguments[m];var h=typeof S;if(h=h!="object"?h:S?Array.isArray(S)?"array":h:"null",h=="array"||h=="object"&&typeof S.length=="number"){h=o.length||0;const C=S.length||0;o.length=h+C;for(let j=0;j<C;j++)o[h+j]=S[j]}else o.push(S)}}class P{constructor(c,h){this.i=c,this.j=h,this.h=0,this.g=null}get(){let c;return this.h>0?(this.h--,c=this.g,this.g=c.next,c.next=null):c=this.i(),c}}function x(o){a.setTimeout(()=>{throw o},0)}function $(){var o=I;let c=null;return o.g&&(c=o.g,o.g=o.g.next,o.g||(o.h=null),c.next=null),c}class W{constructor(){this.h=this.g=null}add(c,h){const m=Q.get();m.set(c,h),this.h?this.h.next=m:this.g=m,this.h=m}}var Q=new P(()=>new G,o=>o.reset());class G{constructor(){this.next=this.g=this.h=null}set(c,h){this.h=c,this.g=h,this.next=null}reset(){this.next=this.g=this.h=null}}let ut,yt=!1,I=new W,_=()=>{const o=Promise.resolve(void 0);ut=()=>{o.then(T)}};function T(){for(var o;o=$();){try{o.h.call(o.g)}catch(h){x(h)}var c=Q;c.j(o),c.h<100&&(c.h++,o.next=c.g,c.g=o)}yt=!1}function A(){this.u=this.u,this.C=this.C}A.prototype.u=!1,A.prototype.dispose=function(){this.u||(this.u=!0,this.N())},A.prototype[Symbol.dispose]=function(){this.dispose()},A.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function w(o,c){this.type=o,this.g=this.target=c,this.defaultPrevented=!1}w.prototype.h=function(){this.defaultPrevented=!0};var R=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var o=!1,c=Object.defineProperty({},"passive",{get:function(){o=!0}});try{const h=()=>{};a.addEventListener("test",h,c),a.removeEventListener("test",h,c)}catch{}return o}();function y(o){return/^[\s\xa0]*$/.test(o)}function Ft(o,c){w.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o&&this.init(o,c)}p(Ft,w),Ft.prototype.init=function(o,c){const h=this.type=o.type,m=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;this.target=o.target||o.srcElement,this.g=c,c=o.relatedTarget,c||(h=="mouseover"?c=o.fromElement:h=="mouseout"&&(c=o.toElement)),this.relatedTarget=c,m?(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=o.pointerType,this.state=o.state,this.i=o,o.defaultPrevented&&Ft.Z.h.call(this)},Ft.prototype.h=function(){Ft.Z.h.call(this);const o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var Ve="closure_listenable_"+(Math.random()*1e6|0),$t=0;function bt(o,c,h,m,S){this.listener=o,this.proxy=null,this.src=c,this.type=h,this.capture=!!m,this.ha=S,this.key=++$t,this.da=this.fa=!1}function pt(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function _e(o,c,h){for(const m in o)c.call(h,o[m],m,o)}function nr(o,c){for(const h in o)c.call(void 0,o[h],h,o)}function De(o){const c={};for(const h in o)c[h]=o[h];return c}const ue="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Or(o,c){let h,m;for(let S=1;S<arguments.length;S++){m=arguments[S];for(h in m)o[h]=m[h];for(let C=0;C<ue.length;C++)h=ue[C],Object.prototype.hasOwnProperty.call(m,h)&&(o[h]=m[h])}}function rr(o){this.src=o,this.g={},this.h=0}rr.prototype.add=function(o,c,h,m,S){const C=o.toString();o=this.g[C],o||(o=this.g[C]=[],this.h++);const j=We(o,c,m,S);return j>-1?(c=o[j],h||(c.fa=!1)):(c=new bt(c,this.src,C,!!m,S),c.fa=h,o.push(c)),c};function Mr(o,c){const h=c.type;if(h in o.g){var m=o.g[h],S=Array.prototype.indexOf.call(m,c,void 0),C;(C=S>=0)&&Array.prototype.splice.call(m,S,1),C&&(pt(c),o.g[h].length==0&&(delete o.g[h],o.h--))}}function We(o,c,h,m){for(let S=0;S<o.length;++S){const C=o[S];if(!C.da&&C.listener==c&&C.capture==!!h&&C.ha==m)return S}return-1}var on="closure_lm_"+(Math.random()*1e6|0),Nn={};function kr(o,c,h,m,S){if(Array.isArray(c)){for(let C=0;C<c.length;C++)kr(o,c[C],h,m,S);return null}return h=q(h),o&&o[Ve]?o.J(c,h,l(m)?!!m.capture:!1,S):On(o,c,h,!1,m,S)}function On(o,c,h,m,S,C){if(!c)throw Error("Invalid event type");const j=l(S)?!!S.capture:!!S;let ot=M(o);if(ot||(o[on]=ot=new rr(o)),h=ot.add(c,h,m,j,C),h.proxy)return h;if(m=Hl(),h.proxy=m,m.src=o,m.listener=h,o.addEventListener)R||(S=j),S===void 0&&(S=!1),o.addEventListener(c.toString(),m,S);else if(o.attachEvent)o.attachEvent(D(c.toString()),m);else if(o.addListener&&o.removeListener)o.addListener(m);else throw Error("addEventListener and attachEvent are unavailable.");return h}function Hl(){function o(h){return c.call(o.src,o.listener,h)}const c=B;return o}function E(o,c,h,m,S){if(Array.isArray(c))for(var C=0;C<c.length;C++)E(o,c[C],h,m,S);else m=l(m)?!!m.capture:!!m,h=q(h),o&&o[Ve]?(o=o.i,C=String(c).toString(),C in o.g&&(c=o.g[C],h=We(c,h,m,S),h>-1&&(pt(c[h]),Array.prototype.splice.call(c,h,1),c.length==0&&(delete o.g[C],o.h--)))):o&&(o=M(o))&&(c=o.g[c.toString()],o=-1,c&&(o=We(c,h,m,S)),(h=o>-1?c[o]:null)&&b(h))}function b(o){if(typeof o!="number"&&o&&!o.da){var c=o.src;if(c&&c[Ve])Mr(c.i,o);else{var h=o.type,m=o.proxy;c.removeEventListener?c.removeEventListener(h,m,o.capture):c.detachEvent?c.detachEvent(D(h),m):c.addListener&&c.removeListener&&c.removeListener(m),(h=M(c))?(Mr(h,o),h.h==0&&(h.src=null,c[on]=null)):pt(o)}}}function D(o){return o in Nn?Nn[o]:Nn[o]="on"+o}function B(o,c){if(o.da)o=!0;else{c=new Ft(c,this);const h=o.listener,m=o.ha||o.src;o.fa&&b(o),o=h.call(m,c)}return o}function M(o){return o=o[on],o instanceof rr?o:null}var k="__closure_events_fn_"+(Math.random()*1e9>>>0);function q(o){return typeof o=="function"?o:(o[k]||(o[k]=function(c){return o.handleEvent(c)}),o[k])}function U(){A.call(this),this.i=new rr(this),this.M=this,this.G=null}p(U,A),U.prototype[Ve]=!0,U.prototype.removeEventListener=function(o,c,h,m){E(this,o,c,h,m)};function L(o,c){var h,m=o.G;if(m)for(h=[];m;m=m.G)h.push(m);if(o=o.M,m=c.type||c,typeof c=="string")c=new w(c,o);else if(c instanceof w)c.target=c.target||o;else{var S=c;c=new w(m,o),Or(c,S)}S=!0;let C,j;if(h)for(j=h.length-1;j>=0;j--)C=c.g=h[j],S=F(C,m,!0,c)&&S;if(C=c.g=o,S=F(C,m,!0,c)&&S,S=F(C,m,!1,c)&&S,h)for(j=0;j<h.length;j++)C=c.g=h[j],S=F(C,m,!1,c)&&S}U.prototype.N=function(){if(U.Z.N.call(this),this.i){var o=this.i;for(const c in o.g){const h=o.g[c];for(let m=0;m<h.length;m++)pt(h[m]);delete o.g[c],o.h--}}this.G=null},U.prototype.J=function(o,c,h,m){return this.i.add(String(o),c,!1,h,m)},U.prototype.K=function(o,c,h,m){return this.i.add(String(o),c,!0,h,m)};function F(o,c,h,m){if(c=o.i.g[String(c)],!c)return!0;c=c.concat();let S=!0;for(let C=0;C<c.length;++C){const j=c[C];if(j&&!j.da&&j.capture==h){const ot=j.listener,kt=j.ha||j.src;j.fa&&Mr(o.i,j),S=ot.call(kt,m)!==!1&&S}}return S&&!m.defaultPrevented}function J(o,c){if(typeof o!="function")if(o&&typeof o.handleEvent=="function")o=f(o.handleEvent,o);else throw Error("Invalid listener argument");return Number(c)>2147483647?-1:a.setTimeout(o,c||0)}function H(o){o.g=J(()=>{o.g=null,o.i&&(o.i=!1,H(o))},o.l);const c=o.h;o.h=null,o.m.apply(null,c)}class X extends A{constructor(c,h){super(),this.m=c,this.l=h,this.h=null,this.i=!1,this.g=null}j(c){this.h=arguments,this.g?this.i=!0:H(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Z(o){A.call(this),this.h=o,this.g={}}p(Z,A);var at=[];function Et(o){_e(o.g,function(c,h){this.g.hasOwnProperty(h)&&b(c)},o),o.g={}}Z.prototype.N=function(){Z.Z.N.call(this),Et(this)},Z.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var dt=a.JSON.stringify,Wt=a.JSON.parse,Qt=class{stringify(o){return a.JSON.stringify(o,void 0)}parse(o){return a.JSON.parse(o,void 0)}};function he(){}function fe(){}var we={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function sr(){w.call(this,"d")}p(sr,w);function qt(){w.call(this,"c")}p(qt,w);var Ut={},Lr=null;function Mn(){return Lr=Lr||new U}Ut.Ia="serverreachability";function zl(o){w.call(this,Ut.Ia,o)}p(zl,w);function Fr(o){const c=Mn();L(c,new zl(c))}Ut.STAT_EVENT="statevent";function Kl(o,c){w.call(this,Ut.STAT_EVENT,o),this.stat=c}p(Kl,w);function ee(o){const c=Mn();L(c,new Kl(c,o))}Ut.Ja="timingevent";function Gl(o,c){w.call(this,Ut.Ja,o),this.size=c}p(Gl,w);function Ur(o,c){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){o()},c)}function Br(){this.g=!0}Br.prototype.ua=function(){this.g=!1};function pp(o,c,h,m,S,C){o.info(function(){if(o.g)if(C){var j="",ot=C.split("&");for(let Tt=0;Tt<ot.length;Tt++){var kt=ot[Tt].split("=");if(kt.length>1){const Bt=kt[0];kt=kt[1];const Ne=Bt.split("_");j=Ne.length>=2&&Ne[1]=="type"?j+(Bt+"="+kt+"&"):j+(Bt+"=redacted&")}}}else j=null;else j=C;return"XMLHTTP REQ ("+m+") [attempt "+S+"]: "+c+`
`+h+`
`+j})}function mp(o,c,h,m,S,C,j){o.info(function(){return"XMLHTTP RESP ("+m+") [ attempt "+S+"]: "+c+`
`+h+`
`+C+" "+j})}function ir(o,c,h,m){o.info(function(){return"XMLHTTP TEXT ("+c+"): "+_p(o,h)+(m?" "+m:"")})}function gp(o,c){o.info(function(){return"TIMEOUT: "+c})}Br.prototype.info=function(){};function _p(o,c){if(!o.g)return c;if(!c)return null;try{const C=JSON.parse(c);if(C){for(o=0;o<C.length;o++)if(Array.isArray(C[o])){var h=C[o];if(!(h.length<2)){var m=h[1];if(Array.isArray(m)&&!(m.length<1)){var S=m[0];if(S!="noop"&&S!="stop"&&S!="close")for(let j=1;j<m.length;j++)m[j]=""}}}}return dt(C)}catch{return c}}var $s={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Wl={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Ql;function Io(){}p(Io,he),Io.prototype.g=function(){return new XMLHttpRequest},Ql=new Io;function jr(o){return encodeURIComponent(String(o))}function yp(o){var c=1;o=o.split(":");const h=[];for(;c>0&&o.length;)h.push(o.shift()),c--;return o.length&&h.push(o.join(":")),h}function an(o,c,h,m){this.j=o,this.i=c,this.l=h,this.S=m||1,this.V=new Z(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Yl}function Yl(){this.i=null,this.g="",this.h=!1}var Xl={},Ao={};function bo(o,c,h){o.M=1,o.A=Hs(xe(c)),o.u=h,o.R=!0,Jl(o,null)}function Jl(o,c){o.F=Date.now(),qs(o),o.B=xe(o.A);var h=o.B,m=o.S;Array.isArray(m)||(m=[String(m)]),hc(h.i,"t",m),o.C=0,h=o.j.L,o.h=new Yl,o.g=Pc(o.j,h?c:null,!o.u),o.P>0&&(o.O=new X(f(o.Y,o,o.g),o.P)),c=o.V,h=o.g,m=o.ba;var S="readystatechange";Array.isArray(S)||(S&&(at[0]=S.toString()),S=at);for(let C=0;C<S.length;C++){const j=kr(h,S[C],m||c.handleEvent,!1,c.h||c);if(!j)break;c.g[j.key]=j}c=o.J?De(o.J):{},o.u?(o.v||(o.v="POST"),c["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.B,o.v,o.u,c)):(o.v="GET",o.g.ea(o.B,o.v,null,c)),Fr(),pp(o.i,o.v,o.B,o.l,o.S,o.u)}an.prototype.ba=function(o){o=o.target;const c=this.O;c&&un(o)==3?c.j():this.Y(o)},an.prototype.Y=function(o){try{if(o==this.g)t:{const ot=un(this.g),kt=this.g.ya(),Tt=this.g.ca();if(!(ot<3)&&(ot!=3||this.g&&(this.h.h||this.g.la()||yc(this.g)))){this.K||ot!=4||kt==7||(kt==8||Tt<=0?Fr(3):Fr(2)),Ro(this);var c=this.g.ca();this.X=c;var h=Ep(this);if(this.o=c==200,mp(this.i,this.v,this.B,this.l,this.S,ot,c),this.o){if(this.U&&!this.L){e:{if(this.g){var m,S=this.g;if((m=S.g?S.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!y(m)){var C=m;break e}}C=null}if(o=C)ir(this.i,this.l,o,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,So(this,o);else{this.o=!1,this.m=3,ee(12),kn(this),$r(this);break t}}if(this.R){o=!0;let Bt;for(;!this.K&&this.C<h.length;)if(Bt=Tp(this,h),Bt==Ao){ot==4&&(this.m=4,ee(14),o=!1),ir(this.i,this.l,null,"[Incomplete Response]");break}else if(Bt==Xl){this.m=4,ee(15),ir(this.i,this.l,h,"[Invalid Chunk]"),o=!1;break}else ir(this.i,this.l,Bt,null),So(this,Bt);if(Zl(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ot!=4||h.length!=0||this.h.h||(this.m=1,ee(16),o=!1),this.o=this.o&&o,!o)ir(this.i,this.l,h,"[Invalid Chunked Response]"),kn(this),$r(this);else if(h.length>0&&!this.W){this.W=!0;var j=this.j;j.g==this&&j.aa&&!j.P&&(j.j.info("Great, no buffering proxy detected. Bytes received: "+h.length),Mo(j),j.P=!0,ee(11))}}else ir(this.i,this.l,h,null),So(this,h);ot==4&&kn(this),this.o&&!this.K&&(ot==4?bc(this.j,this):(this.o=!1,qs(this)))}else Op(this.g),c==400&&h.indexOf("Unknown SID")>0?(this.m=3,ee(12)):(this.m=0,ee(13)),kn(this),$r(this)}}}catch{}finally{}};function Ep(o){if(!Zl(o))return o.g.la();const c=yc(o.g);if(c==="")return"";let h="";const m=c.length,S=un(o.g)==4;if(!o.h.i){if(typeof TextDecoder>"u")return kn(o),$r(o),"";o.h.i=new a.TextDecoder}for(let C=0;C<m;C++)o.h.h=!0,h+=o.h.i.decode(c[C],{stream:!(S&&C==m-1)});return c.length=0,o.h.g+=h,o.C=0,o.h.g}function Zl(o){return o.g?o.v=="GET"&&o.M!=2&&o.j.Aa:!1}function Tp(o,c){var h=o.C,m=c.indexOf(`
`,h);return m==-1?Ao:(h=Number(c.substring(h,m)),isNaN(h)?Xl:(m+=1,m+h>c.length?Ao:(c=c.slice(m,m+h),o.C=m+h,c)))}an.prototype.cancel=function(){this.K=!0,kn(this)};function qs(o){o.T=Date.now()+o.H,tc(o,o.H)}function tc(o,c){if(o.D!=null)throw Error("WatchDog timer not null");o.D=Ur(f(o.aa,o),c)}function Ro(o){o.D&&(a.clearTimeout(o.D),o.D=null)}an.prototype.aa=function(){this.D=null;const o=Date.now();o-this.T>=0?(gp(this.i,this.B),this.M!=2&&(Fr(),ee(17)),kn(this),this.m=2,$r(this)):tc(this,this.T-o)};function $r(o){o.j.I==0||o.K||bc(o.j,o)}function kn(o){Ro(o);var c=o.O;c&&typeof c.dispose=="function"&&c.dispose(),o.O=null,Et(o.V),o.g&&(c=o.g,o.g=null,c.abort(),c.dispose())}function So(o,c){try{var h=o.j;if(h.I!=0&&(h.g==o||Co(h.h,o))){if(!o.L&&Co(h.h,o)&&h.I==3){try{var m=h.Ba.g.parse(c)}catch{m=null}if(Array.isArray(m)&&m.length==3){var S=m;if(S[0]==0){t:if(!h.v){if(h.g)if(h.g.F+3e3<o.F)Qs(h),Gs(h);else break t;Oo(h),ee(18)}}else h.xa=S[1],0<h.xa-h.K&&S[2]<37500&&h.F&&h.A==0&&!h.C&&(h.C=Ur(f(h.Va,h),6e3));rc(h.h)<=1&&h.ta&&(h.ta=void 0)}else Fn(h,11)}else if((o.L||h.g==o)&&Qs(h),!y(c))for(S=h.Ba.g.parse(c),c=0;c<S.length;c++){let Tt=S[c];const Bt=Tt[0];if(!(Bt<=h.K))if(h.K=Bt,Tt=Tt[1],h.I==2)if(Tt[0]=="c"){h.M=Tt[1],h.ba=Tt[2];const Ne=Tt[3];Ne!=null&&(h.ka=Ne,h.j.info("VER="+h.ka));const Un=Tt[4];Un!=null&&(h.za=Un,h.j.info("SVER="+h.za));const hn=Tt[5];hn!=null&&typeof hn=="number"&&hn>0&&(m=1.5*hn,h.O=m,h.j.info("backChannelRequestTimeoutMs_="+m)),m=h;const fn=o.g;if(fn){const Xs=fn.g?fn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Xs){var C=m.h;C.g||Xs.indexOf("spdy")==-1&&Xs.indexOf("quic")==-1&&Xs.indexOf("h2")==-1||(C.j=C.l,C.g=new Set,C.h&&(Po(C,C.h),C.h=null))}if(m.G){const ko=fn.g?fn.g.getResponseHeader("X-HTTP-Session-Id"):null;ko&&(m.wa=ko,Rt(m.J,m.G,ko))}}h.I=3,h.l&&h.l.ra(),h.aa&&(h.T=Date.now()-o.F,h.j.info("Handshake RTT: "+h.T+"ms")),m=h;var j=o;if(m.na=Cc(m,m.L?m.ba:null,m.W),j.L){sc(m.h,j);var ot=j,kt=m.O;kt&&(ot.H=kt),ot.D&&(Ro(ot),qs(ot)),m.g=j}else Ic(m);h.i.length>0&&Ws(h)}else Tt[0]!="stop"&&Tt[0]!="close"||Fn(h,7);else h.I==3&&(Tt[0]=="stop"||Tt[0]=="close"?Tt[0]=="stop"?Fn(h,7):No(h):Tt[0]!="noop"&&h.l&&h.l.qa(Tt),h.A=0)}}Fr(4)}catch{}}var vp=class{constructor(o,c){this.g=o,this.map=c}};function ec(o){this.l=o||10,a.PerformanceNavigationTiming?(o=a.performance.getEntriesByType("navigation"),o=o.length>0&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function nc(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function rc(o){return o.h?1:o.g?o.g.size:0}function Co(o,c){return o.h?o.h==c:o.g?o.g.has(c):!1}function Po(o,c){o.g?o.g.add(c):o.h=c}function sc(o,c){o.h&&o.h==c?o.h=null:o.g&&o.g.has(c)&&o.g.delete(c)}ec.prototype.cancel=function(){if(this.i=ic(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const o of this.g.values())o.cancel();this.g.clear()}};function ic(o){if(o.h!=null)return o.i.concat(o.h.G);if(o.g!=null&&o.g.size!==0){let c=o.i;for(const h of o.g.values())c=c.concat(h.G);return c}return v(o.i)}var oc=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function wp(o,c){if(o){o=o.split("&");for(let h=0;h<o.length;h++){const m=o[h].indexOf("=");let S,C=null;m>=0?(S=o[h].substring(0,m),C=o[h].substring(m+1)):S=o[h],c(S,C?decodeURIComponent(C.replace(/\+/g," ")):"")}}}function ln(o){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let c;o instanceof ln?(this.l=o.l,qr(this,o.j),this.o=o.o,this.g=o.g,Hr(this,o.u),this.h=o.h,Vo(this,fc(o.i)),this.m=o.m):o&&(c=String(o).match(oc))?(this.l=!1,qr(this,c[1]||"",!0),this.o=zr(c[2]||""),this.g=zr(c[3]||"",!0),Hr(this,c[4]),this.h=zr(c[5]||"",!0),Vo(this,c[6]||"",!0),this.m=zr(c[7]||"")):(this.l=!1,this.i=new Gr(null,this.l))}ln.prototype.toString=function(){const o=[];var c=this.j;c&&o.push(Kr(c,ac,!0),":");var h=this.g;return(h||c=="file")&&(o.push("//"),(c=this.o)&&o.push(Kr(c,ac,!0),"@"),o.push(jr(h).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h=this.u,h!=null&&o.push(":",String(h))),(h=this.h)&&(this.g&&h.charAt(0)!="/"&&o.push("/"),o.push(Kr(h,h.charAt(0)=="/"?bp:Ap,!0))),(h=this.i.toString())&&o.push("?",h),(h=this.m)&&o.push("#",Kr(h,Sp)),o.join("")},ln.prototype.resolve=function(o){const c=xe(this);let h=!!o.j;h?qr(c,o.j):h=!!o.o,h?c.o=o.o:h=!!o.g,h?c.g=o.g:h=o.u!=null;var m=o.h;if(h)Hr(c,o.u);else if(h=!!o.h){if(m.charAt(0)!="/")if(this.g&&!this.h)m="/"+m;else{var S=c.h.lastIndexOf("/");S!=-1&&(m=c.h.slice(0,S+1)+m)}if(S=m,S==".."||S==".")m="";else if(S.indexOf("./")!=-1||S.indexOf("/.")!=-1){m=S.lastIndexOf("/",0)==0,S=S.split("/");const C=[];for(let j=0;j<S.length;){const ot=S[j++];ot=="."?m&&j==S.length&&C.push(""):ot==".."?((C.length>1||C.length==1&&C[0]!="")&&C.pop(),m&&j==S.length&&C.push("")):(C.push(ot),m=!0)}m=C.join("/")}else m=S}return h?c.h=m:h=o.i.toString()!=="",h?Vo(c,fc(o.i)):h=!!o.m,h&&(c.m=o.m),c};function xe(o){return new ln(o)}function qr(o,c,h){o.j=h?zr(c,!0):c,o.j&&(o.j=o.j.replace(/:$/,""))}function Hr(o,c){if(c){if(c=Number(c),isNaN(c)||c<0)throw Error("Bad port number "+c);o.u=c}else o.u=null}function Vo(o,c,h){c instanceof Gr?(o.i=c,Cp(o.i,o.l)):(h||(c=Kr(c,Rp)),o.i=new Gr(c,o.l))}function Rt(o,c,h){o.i.set(c,h)}function Hs(o){return Rt(o,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),o}function zr(o,c){return o?c?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function Kr(o,c,h){return typeof o=="string"?(o=encodeURI(o).replace(c,Ip),h&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function Ip(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var ac=/[#\/\?@]/g,Ap=/[#\?:]/g,bp=/[#\?]/g,Rp=/[#\?@]/g,Sp=/#/g;function Gr(o,c){this.h=this.g=null,this.i=o||null,this.j=!!c}function Ln(o){o.g||(o.g=new Map,o.h=0,o.i&&wp(o.i,function(c,h){o.add(decodeURIComponent(c.replace(/\+/g," ")),h)}))}e=Gr.prototype,e.add=function(o,c){Ln(this),this.i=null,o=or(this,o);let h=this.g.get(o);return h||this.g.set(o,h=[]),h.push(c),this.h+=1,this};function lc(o,c){Ln(o),c=or(o,c),o.g.has(c)&&(o.i=null,o.h-=o.g.get(c).length,o.g.delete(c))}function cc(o,c){return Ln(o),c=or(o,c),o.g.has(c)}e.forEach=function(o,c){Ln(this),this.g.forEach(function(h,m){h.forEach(function(S){o.call(c,S,m,this)},this)},this)};function uc(o,c){Ln(o);let h=[];if(typeof c=="string")cc(o,c)&&(h=h.concat(o.g.get(or(o,c))));else for(o=Array.from(o.g.values()),c=0;c<o.length;c++)h=h.concat(o[c]);return h}e.set=function(o,c){return Ln(this),this.i=null,o=or(this,o),cc(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[c]),this.h+=1,this},e.get=function(o,c){return o?(o=uc(this,o),o.length>0?String(o[0]):c):c};function hc(o,c,h){lc(o,c),h.length>0&&(o.i=null,o.g.set(or(o,c),v(h)),o.h+=h.length)}e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const o=[],c=Array.from(this.g.keys());for(let m=0;m<c.length;m++){var h=c[m];const S=jr(h);h=uc(this,h);for(let C=0;C<h.length;C++){let j=S;h[C]!==""&&(j+="="+jr(h[C])),o.push(j)}}return this.i=o.join("&")};function fc(o){const c=new Gr;return c.i=o.i,o.g&&(c.g=new Map(o.g),c.h=o.h),c}function or(o,c){return c=String(c),o.j&&(c=c.toLowerCase()),c}function Cp(o,c){c&&!o.j&&(Ln(o),o.i=null,o.g.forEach(function(h,m){const S=m.toLowerCase();m!=S&&(lc(this,m),hc(this,S,h))},o)),o.j=c}function Pp(o,c){const h=new Br;if(a.Image){const m=new Image;m.onload=d(cn,h,"TestLoadImage: loaded",!0,c,m),m.onerror=d(cn,h,"TestLoadImage: error",!1,c,m),m.onabort=d(cn,h,"TestLoadImage: abort",!1,c,m),m.ontimeout=d(cn,h,"TestLoadImage: timeout",!1,c,m),a.setTimeout(function(){m.ontimeout&&m.ontimeout()},1e4),m.src=o}else c(!1)}function Vp(o,c){const h=new Br,m=new AbortController,S=setTimeout(()=>{m.abort(),cn(h,"TestPingServer: timeout",!1,c)},1e4);fetch(o,{signal:m.signal}).then(C=>{clearTimeout(S),C.ok?cn(h,"TestPingServer: ok",!0,c):cn(h,"TestPingServer: server error",!1,c)}).catch(()=>{clearTimeout(S),cn(h,"TestPingServer: error",!1,c)})}function cn(o,c,h,m,S){try{S&&(S.onload=null,S.onerror=null,S.onabort=null,S.ontimeout=null),m(h)}catch{}}function Dp(){this.g=new Qt}function Do(o){this.i=o.Sb||null,this.h=o.ab||!1}p(Do,he),Do.prototype.g=function(){return new zs(this.i,this.h)};function zs(o,c){U.call(this),this.H=o,this.o=c,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}p(zs,U),e=zs.prototype,e.open=function(o,c){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=o,this.D=c,this.readyState=1,Qr(this)},e.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const c={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};o&&(c.body=o),(this.H||a).fetch(new Request(this.D,c)).then(this.Pa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Wr(this)),this.readyState=0},e.Pa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,Qr(this)),this.g&&(this.readyState=3,Qr(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;dc(this)}else o.text().then(this.Oa.bind(this),this.ga.bind(this))};function dc(o){o.j.read().then(o.Ma.bind(o)).catch(o.ga.bind(o))}e.Ma=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var c=o.value?o.value:new Uint8Array(0);(c=this.B.decode(c,{stream:!o.done}))&&(this.response=this.responseText+=c)}o.done?Wr(this):Qr(this),this.readyState==3&&dc(this)}},e.Oa=function(o){this.g&&(this.response=this.responseText=o,Wr(this))},e.Na=function(o){this.g&&(this.response=o,Wr(this))},e.ga=function(){this.g&&Wr(this)};function Wr(o){o.readyState=4,o.l=null,o.j=null,o.B=null,Qr(o)}e.setRequestHeader=function(o,c){this.A.append(o,c)},e.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const o=[],c=this.h.entries();for(var h=c.next();!h.done;)h=h.value,o.push(h[0]+": "+h[1]),h=c.next();return o.join(`\r
`)};function Qr(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(zs.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function pc(o){let c="";return _e(o,function(h,m){c+=m,c+=":",c+=h,c+=`\r
`}),c}function xo(o,c,h){t:{for(m in h){var m=!1;break t}m=!0}m||(h=pc(h),typeof o=="string"?h!=null&&jr(h):Rt(o,c,h))}function Pt(o){U.call(this),this.headers=new Map,this.L=o||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}p(Pt,U);var xp=/^https?$/i,Np=["POST","PUT"];e=Pt.prototype,e.Fa=function(o){this.H=o},e.ea=function(o,c,h,m){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);c=c?c.toUpperCase():"GET",this.D=o,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Ql.g(),this.g.onreadystatechange=g(f(this.Ca,this));try{this.B=!0,this.g.open(c,String(o),!0),this.B=!1}catch(C){mc(this,C);return}if(o=h||"",h=new Map(this.headers),m)if(Object.getPrototypeOf(m)===Object.prototype)for(var S in m)h.set(S,m[S]);else if(typeof m.keys=="function"&&typeof m.get=="function")for(const C of m.keys())h.set(C,m.get(C));else throw Error("Unknown input type for opt_headers: "+String(m));m=Array.from(h.keys()).find(C=>C.toLowerCase()=="content-type"),S=a.FormData&&o instanceof a.FormData,!(Array.prototype.indexOf.call(Np,c,void 0)>=0)||m||S||h.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[C,j]of h)this.g.setRequestHeader(C,j);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(o),this.v=!1}catch(C){mc(this,C)}};function mc(o,c){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=c,o.o=5,gc(o),Ks(o)}function gc(o){o.A||(o.A=!0,L(o,"complete"),L(o,"error"))}e.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=o||7,L(this,"complete"),L(this,"abort"),Ks(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ks(this,!0)),Pt.Z.N.call(this)},e.Ca=function(){this.u||(this.B||this.v||this.j?_c(this):this.Xa())},e.Xa=function(){_c(this)};function _c(o){if(o.h&&typeof i<"u"){if(o.v&&un(o)==4)setTimeout(o.Ca.bind(o),0);else if(L(o,"readystatechange"),un(o)==4){o.h=!1;try{const C=o.ca();t:switch(C){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break t;default:c=!1}var h;if(!(h=c)){var m;if(m=C===0){let j=String(o.D).match(oc)[1]||null;!j&&a.self&&a.self.location&&(j=a.self.location.protocol.slice(0,-1)),m=!xp.test(j?j.toLowerCase():"")}h=m}if(h)L(o,"complete"),L(o,"success");else{o.o=6;try{var S=un(o)>2?o.g.statusText:""}catch{S=""}o.l=S+" ["+o.ca()+"]",gc(o)}}finally{Ks(o)}}}}function Ks(o,c){if(o.g){o.m&&(clearTimeout(o.m),o.m=null);const h=o.g;o.g=null,c||L(o,"ready");try{h.onreadystatechange=null}catch{}}}e.isActive=function(){return!!this.g};function un(o){return o.g?o.g.readyState:0}e.ca=function(){try{return un(this)>2?this.g.status:-1}catch{return-1}},e.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},e.La=function(o){if(this.g){var c=this.g.responseText;return o&&c.indexOf(o)==0&&(c=c.substring(o.length)),Wt(c)}};function yc(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.F){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function Op(o){const c={};o=(o.g&&un(o)>=2&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let m=0;m<o.length;m++){if(y(o[m]))continue;var h=yp(o[m]);const S=h[0];if(h=h[1],typeof h!="string")continue;h=h.trim();const C=c[S]||[];c[S]=C,C.push(h)}nr(c,function(m){return m.join(", ")})}e.ya=function(){return this.o},e.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Yr(o,c,h){return h&&h.internalChannelParams&&h.internalChannelParams[o]||c}function Ec(o){this.za=0,this.i=[],this.j=new Br,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Yr("failFast",!1,o),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Yr("baseRetryDelayMs",5e3,o),this.Za=Yr("retryDelaySeedMs",1e4,o),this.Ta=Yr("forwardChannelMaxRetries",2,o),this.va=Yr("forwardChannelRequestTimeoutMs",2e4,o),this.ma=o&&o.xmlHttpFactory||void 0,this.Ua=o&&o.Rb||void 0,this.Aa=o&&o.useFetchStreams||!1,this.O=void 0,this.L=o&&o.supportsCrossDomainXhr||!1,this.M="",this.h=new ec(o&&o.concurrentRequestLimit),this.Ba=new Dp,this.S=o&&o.fastHandshake||!1,this.R=o&&o.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=o&&o.Pb||!1,o&&o.ua&&this.j.ua(),o&&o.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&o&&o.detectBufferingProxy||!1,this.ia=void 0,o&&o.longPollingTimeout&&o.longPollingTimeout>0&&(this.ia=o.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}e=Ec.prototype,e.ka=8,e.I=1,e.connect=function(o,c,h,m){ee(0),this.W=o,this.H=c||{},h&&m!==void 0&&(this.H.OSID=h,this.H.OAID=m),this.F=this.X,this.J=Cc(this,null,this.W),Ws(this)};function No(o){if(Tc(o),o.I==3){var c=o.V++,h=xe(o.J);if(Rt(h,"SID",o.M),Rt(h,"RID",c),Rt(h,"TYPE","terminate"),Xr(o,h),c=new an(o,o.j,c),c.M=2,c.A=Hs(xe(h)),h=!1,a.navigator&&a.navigator.sendBeacon)try{h=a.navigator.sendBeacon(c.A.toString(),"")}catch{}!h&&a.Image&&(new Image().src=c.A,h=!0),h||(c.g=Pc(c.j,null),c.g.ea(c.A)),c.F=Date.now(),qs(c)}Sc(o)}function Gs(o){o.g&&(Mo(o),o.g.cancel(),o.g=null)}function Tc(o){Gs(o),o.v&&(a.clearTimeout(o.v),o.v=null),Qs(o),o.h.cancel(),o.m&&(typeof o.m=="number"&&a.clearTimeout(o.m),o.m=null)}function Ws(o){if(!nc(o.h)&&!o.m){o.m=!0;var c=o.Ea;ut||_(),yt||(ut(),yt=!0),I.add(c,o),o.D=0}}function Mp(o,c){return rc(o.h)>=o.h.j-(o.m?1:0)?!1:o.m?(o.i=c.G.concat(o.i),!0):o.I==1||o.I==2||o.D>=(o.Sa?0:o.Ta)?!1:(o.m=Ur(f(o.Ea,o,c),Rc(o,o.D)),o.D++,!0)}e.Ea=function(o){if(this.m)if(this.m=null,this.I==1){if(!o){this.V=Math.floor(Math.random()*1e5),o=this.V++;const S=new an(this,this.j,o);let C=this.o;if(this.U&&(C?(C=De(C),Or(C,this.U)):C=this.U),this.u!==null||this.R||(S.J=C,C=null),this.S)t:{for(var c=0,h=0;h<this.i.length;h++){e:{var m=this.i[h];if("__data__"in m.map&&(m=m.map.__data__,typeof m=="string")){m=m.length;break e}m=void 0}if(m===void 0)break;if(c+=m,c>4096){c=h;break t}if(c===4096||h===this.i.length-1){c=h+1;break t}}c=1e3}else c=1e3;c=wc(this,S,c),h=xe(this.J),Rt(h,"RID",o),Rt(h,"CVER",22),this.G&&Rt(h,"X-HTTP-Session-Id",this.G),Xr(this,h),C&&(this.R?c="headers="+jr(pc(C))+"&"+c:this.u&&xo(h,this.u,C)),Po(this.h,S),this.Ra&&Rt(h,"TYPE","init"),this.S?(Rt(h,"$req",c),Rt(h,"SID","null"),S.U=!0,bo(S,h,null)):bo(S,h,c),this.I=2}}else this.I==3&&(o?vc(this,o):this.i.length==0||nc(this.h)||vc(this))};function vc(o,c){var h;c?h=c.l:h=o.V++;const m=xe(o.J);Rt(m,"SID",o.M),Rt(m,"RID",h),Rt(m,"AID",o.K),Xr(o,m),o.u&&o.o&&xo(m,o.u,o.o),h=new an(o,o.j,h,o.D+1),o.u===null&&(h.J=o.o),c&&(o.i=c.G.concat(o.i)),c=wc(o,h,1e3),h.H=Math.round(o.va*.5)+Math.round(o.va*.5*Math.random()),Po(o.h,h),bo(h,m,c)}function Xr(o,c){o.H&&_e(o.H,function(h,m){Rt(c,m,h)}),o.l&&_e({},function(h,m){Rt(c,m,h)})}function wc(o,c,h){h=Math.min(o.i.length,h);const m=o.l?f(o.l.Ka,o.l,o):null;t:{var S=o.i;let ot=-1;for(;;){const kt=["count="+h];ot==-1?h>0?(ot=S[0].g,kt.push("ofs="+ot)):ot=0:kt.push("ofs="+ot);let Tt=!0;for(let Bt=0;Bt<h;Bt++){var C=S[Bt].g;const Ne=S[Bt].map;if(C-=ot,C<0)ot=Math.max(0,S[Bt].g-100),Tt=!1;else try{C="req"+C+"_"||"";try{var j=Ne instanceof Map?Ne:Object.entries(Ne);for(const[Un,hn]of j){let fn=hn;l(hn)&&(fn=dt(hn)),kt.push(C+Un+"="+encodeURIComponent(fn))}}catch(Un){throw kt.push(C+"type="+encodeURIComponent("_badmap")),Un}}catch{m&&m(Ne)}}if(Tt){j=kt.join("&");break t}}j=void 0}return o=o.i.splice(0,h),c.G=o,j}function Ic(o){if(!o.g&&!o.v){o.Y=1;var c=o.Da;ut||_(),yt||(ut(),yt=!0),I.add(c,o),o.A=0}}function Oo(o){return o.g||o.v||o.A>=3?!1:(o.Y++,o.v=Ur(f(o.Da,o),Rc(o,o.A)),o.A++,!0)}e.Da=function(){if(this.v=null,Ac(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var o=4*this.T;this.j.info("BP detection timer enabled: "+o),this.B=Ur(f(this.Wa,this),o)}},e.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,ee(10),Gs(this),Ac(this))};function Mo(o){o.B!=null&&(a.clearTimeout(o.B),o.B=null)}function Ac(o){o.g=new an(o,o.j,"rpc",o.Y),o.u===null&&(o.g.J=o.o),o.g.P=0;var c=xe(o.na);Rt(c,"RID","rpc"),Rt(c,"SID",o.M),Rt(c,"AID",o.K),Rt(c,"CI",o.F?"0":"1"),!o.F&&o.ia&&Rt(c,"TO",o.ia),Rt(c,"TYPE","xmlhttp"),Xr(o,c),o.u&&o.o&&xo(c,o.u,o.o),o.O&&(o.g.H=o.O);var h=o.g;o=o.ba,h.M=1,h.A=Hs(xe(c)),h.u=null,h.R=!0,Jl(h,o)}e.Va=function(){this.C!=null&&(this.C=null,Gs(this),Oo(this),ee(19))};function Qs(o){o.C!=null&&(a.clearTimeout(o.C),o.C=null)}function bc(o,c){var h=null;if(o.g==c){Qs(o),Mo(o),o.g=null;var m=2}else if(Co(o.h,c))h=c.G,sc(o.h,c),m=1;else return;if(o.I!=0){if(c.o)if(m==1){h=c.u?c.u.length:0,c=Date.now()-c.F;var S=o.D;m=Mn(),L(m,new Gl(m,h)),Ws(o)}else Ic(o);else if(S=c.m,S==3||S==0&&c.X>0||!(m==1&&Mp(o,c)||m==2&&Oo(o)))switch(h&&h.length>0&&(c=o.h,c.i=c.i.concat(h)),S){case 1:Fn(o,5);break;case 4:Fn(o,10);break;case 3:Fn(o,6);break;default:Fn(o,2)}}}function Rc(o,c){let h=o.Qa+Math.floor(Math.random()*o.Za);return o.isActive()||(h*=2),h*c}function Fn(o,c){if(o.j.info("Error code "+c),c==2){var h=f(o.bb,o),m=o.Ua;const S=!m;m=new ln(m||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||qr(m,"https"),Hs(m),S?Pp(m.toString(),h):Vp(m.toString(),h)}else ee(2);o.I=0,o.l&&o.l.pa(c),Sc(o),Tc(o)}e.bb=function(o){o?(this.j.info("Successfully pinged google.com"),ee(2)):(this.j.info("Failed to ping google.com"),ee(1))};function Sc(o){if(o.I=0,o.ja=[],o.l){const c=ic(o.h);(c.length!=0||o.i.length!=0)&&(V(o.ja,c),V(o.ja,o.i),o.h.i.length=0,v(o.i),o.i.length=0),o.l.oa()}}function Cc(o,c,h){var m=h instanceof ln?xe(h):new ln(h);if(m.g!="")c&&(m.g=c+"."+m.g),Hr(m,m.u);else{var S=a.location;m=S.protocol,c=c?c+"."+S.hostname:S.hostname,S=+S.port;const C=new ln(null);m&&qr(C,m),c&&(C.g=c),S&&Hr(C,S),h&&(C.h=h),m=C}return h=o.G,c=o.wa,h&&c&&Rt(m,h,c),Rt(m,"VER",o.ka),Xr(o,m),m}function Pc(o,c,h){if(c&&!o.L)throw Error("Can't create secondary domain capable XhrIo object.");return c=o.Aa&&!o.ma?new Pt(new Do({ab:h})):new Pt(o.ma),c.Fa(o.L),c}e.isActive=function(){return!!this.l&&this.l.isActive(this)};function Vc(){}e=Vc.prototype,e.ra=function(){},e.qa=function(){},e.pa=function(){},e.oa=function(){},e.isActive=function(){return!0},e.Ka=function(){};function Ys(){}Ys.prototype.g=function(o,c){return new de(o,c)};function de(o,c){U.call(this),this.g=new Ec(c),this.l=o,this.h=c&&c.messageUrlParams||null,o=c&&c.messageHeaders||null,c&&c.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=c&&c.initMessageHeaders||null,c&&c.messageContentType&&(o?o["X-WebChannel-Content-Type"]=c.messageContentType:o={"X-WebChannel-Content-Type":c.messageContentType}),c&&c.sa&&(o?o["X-WebChannel-Client-Profile"]=c.sa:o={"X-WebChannel-Client-Profile":c.sa}),this.g.U=o,(o=c&&c.Qb)&&!y(o)&&(this.g.u=o),this.A=c&&c.supportsCrossDomainXhr||!1,this.v=c&&c.sendRawJson||!1,(c=c&&c.httpSessionIdParam)&&!y(c)&&(this.g.G=c,o=this.h,o!==null&&c in o&&(o=this.h,c in o&&delete o[c])),this.j=new ar(this)}p(de,U),de.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},de.prototype.close=function(){No(this.g)},de.prototype.o=function(o){var c=this.g;if(typeof o=="string"){var h={};h.__data__=o,o=h}else this.v&&(h={},h.__data__=dt(o),o=h);c.i.push(new vp(c.Ya++,o)),c.I==3&&Ws(c)},de.prototype.N=function(){this.g.l=null,delete this.j,No(this.g),delete this.g,de.Z.N.call(this)};function Dc(o){sr.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var c=o.__sm__;if(c){t:{for(const h in c){o=h;break t}o=void 0}(this.i=o)&&(o=this.i,c=c!==null&&o in c?c[o]:void 0),this.data=c}else this.data=o}p(Dc,sr);function xc(){qt.call(this),this.status=1}p(xc,qt);function ar(o){this.g=o}p(ar,Vc),ar.prototype.ra=function(){L(this.g,"a")},ar.prototype.qa=function(o){L(this.g,new Dc(o))},ar.prototype.pa=function(o){L(this.g,new xc)},ar.prototype.oa=function(){L(this.g,"b")},Ys.prototype.createWebChannel=Ys.prototype.g,de.prototype.send=de.prototype.o,de.prototype.open=de.prototype.m,de.prototype.close=de.prototype.close,jf=function(){return new Ys},Bf=function(){return Mn()},Uf=Ut,ya={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},$s.NO_ERROR=0,$s.TIMEOUT=8,$s.HTTP_ERROR=6,di=$s,Wl.COMPLETE="complete",Ff=Wl,fe.EventType=we,we.OPEN="a",we.CLOSE="b",we.ERROR="c",we.MESSAGE="d",U.prototype.listen=U.prototype.J,rs=fe,Pt.prototype.listenOnce=Pt.prototype.K,Pt.prototype.getLastError=Pt.prototype.Ha,Pt.prototype.getLastErrorCode=Pt.prototype.ya,Pt.prototype.getStatus=Pt.prototype.ca,Pt.prototype.getResponseJson=Pt.prototype.La,Pt.prototype.getResponseText=Pt.prototype.la,Pt.prototype.send=Pt.prototype.ea,Pt.prototype.setWithCredentials=Pt.prototype.Fa,Lf=Pt}).apply(typeof ri<"u"?ri:typeof self<"u"?self:typeof window<"u"?window:{});const wu="@firebase/firestore",Iu="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xt{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Xt.UNAUTHENTICATED=new Xt(null),Xt.GOOGLE_CREDENTIALS=new Xt("google-credentials-uid"),Xt.FIRST_PARTY=new Xt("first-party-uid"),Xt.MOCK_USER=new Xt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vr="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qn=new Vf("@firebase/firestore");function ur(){return Qn.logLevel}function K(e,...t){if(Qn.logLevel<=ft.DEBUG){const n=t.map(al);Qn.debug(`Firestore (${Vr}): ${e}`,...n)}}function nn(e,...t){if(Qn.logLevel<=ft.ERROR){const n=t.map(al);Qn.error(`Firestore (${Vr}): ${e}`,...n)}}function Ir(e,...t){if(Qn.logLevel<=ft.WARN){const n=t.map(al);Qn.warn(`Firestore (${Vr}): ${e}`,...n)}}function al(e){if(typeof e=="string")return e;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(e)}catch{return e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tt(e,t,n){let r="Unexpected state";typeof t=="string"?r=t:n=t,$f(e,r,n)}function $f(e,t,n){let r=`FIRESTORE (${Vr}) INTERNAL ASSERTION FAILED: ${t} (ID: ${e.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw nn(r),new Error(r)}function _t(e,t,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,e||$f(t,s,r)}function rt(e,t){return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class z extends Pr{constructor(t,n){super(t,n),this.code=t,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tn{constructor(){this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qf{constructor(t,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class nE{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,n){t.enqueueRetryable(()=>n(Xt.UNAUTHENTICATED))}shutdown(){}}class rE{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,n){this.changeListener=n,t.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class sE{constructor(t){this.t=t,this.currentUser=Xt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,n){_t(this.o===void 0,42304);let r=this.i;const s=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let i=new Tn;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Tn,t.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const u=i;t.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},l=u=>{K("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(K("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Tn)}},0),a()}getToken(){const t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==t?(K("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(_t(typeof r.accessToken=="string",31837,{l:r}),new qf(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return _t(t===null||typeof t=="string",2055,{h:t}),new Xt(t)}}class iE{constructor(t,n,r){this.P=t,this.T=n,this.I=r,this.type="FirstParty",this.user=Xt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const t=this.R();return t&&this.A.set("Authorization",t),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class oE{constructor(t,n,r){this.P=t,this.T=n,this.I=r}getToken(){return Promise.resolve(new iE(this.P,this.T,this.I))}start(t,n){t.enqueueRetryable(()=>n(Xt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Au{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class aE{constructor(t,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,jy(t)&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,n){_t(this.o===void 0,3512);const r=i=>{i.error!=null&&K("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.m;return this.m=i.token,K("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?n(i.token):Promise.resolve()};this.o=i=>{t.enqueueRetryable(()=>r(i))};const s=i=>{K("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):K("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Au(this.p));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(n=>n?(_t(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new Au(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lE(e){const t=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ll{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=lE(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=t.charAt(s[i]%62))}return r}}function lt(e,t){return e<t?-1:e>t?1:0}function Ea(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const s=e.charAt(r),i=t.charAt(r);if(s!==i)return Xo(s)===Xo(i)?lt(s,i):Xo(s)?1:-1}return lt(e.length,t.length)}const cE=55296,uE=57343;function Xo(e){const t=e.charCodeAt(0);return t>=cE&&t<=uE}function Ar(e,t,n){return e.length===t.length&&e.every((r,s)=>n(r,t[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bu="__name__";class ke{constructor(t,n,r){n===void 0?n=0:n>t.length&&tt(637,{offset:n,range:t.length}),r===void 0?r=t.length-n:r>t.length-n&&tt(1746,{length:r,range:t.length-n}),this.segments=t,this.offset=n,this.len=r}get length(){return this.len}isEqual(t){return ke.comparator(this,t)===0}child(t){const n=this.segments.slice(this.offset,this.limit());return t instanceof ke?t.forEach(r=>{n.push(r)}):n.push(t),this.construct(n)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}forEach(t){for(let n=this.offset,r=this.limit();n<r;n++)t(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,n){const r=Math.min(t.length,n.length);for(let s=0;s<r;s++){const i=ke.compareSegments(t.get(s),n.get(s));if(i!==0)return i}return lt(t.length,n.length)}static compareSegments(t,n){const r=ke.isNumericId(t),s=ke.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?ke.extractNumericId(t).compare(ke.extractNumericId(n)):Ea(t,n)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return En.fromString(t.substring(4,t.length-2))}}class It extends ke{construct(t,n,r){return new It(t,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const n=[];for(const r of t){if(r.indexOf("//")>=0)throw new z(N.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new It(n)}static emptyPath(){return new It([])}}const hE=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Kt extends ke{construct(t,n,r){return new Kt(t,n,r)}static isValidIdentifier(t){return hE.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Kt.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===bu}static keyField(){return new Kt([bu])}static fromServerFormat(t){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new z(N.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let a=!1;for(;s<t.length;){const l=t[s];if(l==="\\"){if(s+1===t.length)throw new z(N.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const u=t[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new z(N.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,s+=2}else l==="`"?(a=!a,s++):l!=="."||a?(r+=l,s++):(i(),s++)}if(i(),a)throw new z(N.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Kt(n)}static emptyPath(){return new Kt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y{constructor(t){this.path=t}static fromPath(t){return new Y(It.fromString(t))}static fromName(t){return new Y(It.fromString(t).popFirst(5))}static empty(){return new Y(It.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&It.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,n){return It.comparator(t.path,n.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Y(new It(t.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hf(e,t,n){if(!n)throw new z(N.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function fE(e,t,n,r){if(t===!0&&r===!0)throw new z(N.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function Ru(e){if(!Y.isDocumentKey(e))throw new z(N.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function Su(e){if(Y.isDocumentKey(e))throw new z(N.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function zf(e){return typeof e=="object"&&e!==null&&(Object.getPrototypeOf(e)===Object.prototype||Object.getPrototypeOf(e)===null)}function ao(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e=="number"||typeof e=="boolean")return""+e;if(typeof e=="object"){if(e instanceof Array)return"an array";{const t=function(r){return r.constructor?r.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return typeof e=="function"?"a function":tt(12329,{type:typeof e})}function Ue(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new z(N.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=ao(e);throw new z(N.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nt(e,t){const n={typeString:e};return t&&(n.value=t),n}function Ms(e,t){if(!zf(e))throw new z(N.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in t)if(t[r]){const s=t[r].typeString,i="value"in t[r]?{value:t[r].value}:void 0;if(!(r in e)){n=`JSON missing required field: '${r}'`;break}const a=e[r];if(s&&typeof a!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&a!==i.value){n=`Expected '${r}' field to equal '${i.value}'`;break}}if(n)throw new z(N.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cu=-62135596800,Pu=1e6;class St{static now(){return St.fromMillis(Date.now())}static fromDate(t){return St.fromMillis(t.getTime())}static fromMillis(t){const n=Math.floor(t/1e3),r=Math.floor((t-1e3*n)*Pu);return new St(n,r)}constructor(t,n){if(this.seconds=t,this.nanoseconds=n,n<0)throw new z(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new z(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<Cu)throw new z(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new z(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Pu}_compareTo(t){return this.seconds===t.seconds?lt(this.nanoseconds,t.nanoseconds):lt(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:St._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if(Ms(t,St._jsonSchema))return new St(t.seconds,t.nanoseconds)}valueOf(){const t=this.seconds-Cu;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}St._jsonSchemaVersion="firestore/timestamp/1.0",St._jsonSchema={type:Nt("string",St._jsonSchemaVersion),seconds:Nt("number"),nanoseconds:Nt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nt{static fromTimestamp(t){return new nt(t)}static min(){return new nt(new St(0,0))}static max(){return new nt(new St(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rs=-1;function dE(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,s=nt.fromTimestamp(r===1e9?new St(n+1,0):new St(n,r));return new bn(s,Y.empty(),t)}function pE(e){return new bn(e.readTime,e.key,Rs)}class bn{constructor(t,n,r){this.readTime=t,this.documentKey=n,this.largestBatchId=r}static min(){return new bn(nt.min(),Y.empty(),Rs)}static max(){return new bn(nt.max(),Y.empty(),Rs)}}function mE(e,t){let n=e.readTime.compareTo(t.readTime);return n!==0?n:(n=Y.comparator(e.documentKey,t.documentKey),n!==0?n:lt(e.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gE="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class _E{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dr(e){if(e.code!==N.FAILED_PRECONDITION||e.message!==gE)throw e;K("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(t){return this.next(void 0,t)}next(t,n){return this.callbackAttached&&tt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new O((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(t,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((t,n)=>{this.next(t,n)})}wrapUserFunction(t){try{const n=t();return n instanceof O?n:O.resolve(n)}catch(n){return O.reject(n)}}wrapSuccess(t,n){return t?this.wrapUserFunction(()=>t(n)):O.resolve(n)}wrapFailure(t,n){return t?this.wrapUserFunction(()=>t(n)):O.reject(n)}static resolve(t){return new O((n,r)=>{n(t)})}static reject(t){return new O((n,r)=>{r(t)})}static waitFor(t){return new O((n,r)=>{let s=0,i=0,a=!1;t.forEach(l=>{++s,l.next(()=>{++i,a&&i===s&&n()},u=>r(u))}),a=!0,i===s&&n()})}static or(t){let n=O.resolve(!1);for(const r of t)n=n.next(s=>s?O.resolve(s):r());return n}static forEach(t,n){const r=[];return t.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(t,n){return new O((r,s)=>{const i=t.length,a=new Array(i);let l=0;for(let u=0;u<i;u++){const f=u;n(t[f]).next(d=>{a[f]=d,++l,l===i&&r(a)},d=>s(d))}})}static doWhile(t,n){return new O((r,s)=>{const i=()=>{t()===!0?n().next(()=>{i()},s):r()};i()})}}function yE(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function xr(e){return e.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lo{constructor(t,n){this.previousValue=t,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ue&&this.ue(t),t}}lo.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cl=-1;function co(e){return e==null}function ki(e){return e===0&&1/e==-1/0}function EE(e){return typeof e=="number"&&Number.isInteger(e)&&!ki(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kf="";function TE(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=Vu(t)),t=vE(e.get(n),t);return Vu(t)}function vE(e,t){let n=t;const r=e.length;for(let s=0;s<r;s++){const i=e.charAt(s);switch(i){case"\0":n+="";break;case Kf:n+="";break;default:n+=i}}return n}function Vu(e){return e+Kf+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Du(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Dn(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Gf(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ct{constructor(t,n){this.comparator=t,this.root=n||Ht.EMPTY}insert(t,n){return new Ct(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,Ht.BLACK,null,null))}remove(t){return new Ct(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Ht.BLACK,null,null))}get(t){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(t,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(t){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(t,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((n,r)=>(t(n,r),!1))}toString(){const t=[];return this.inorderTraversal((n,r)=>(t.push(`${n}:${r}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new si(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new si(this.root,t,this.comparator,!1)}getReverseIterator(){return new si(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new si(this.root,t,this.comparator,!0)}}class si{constructor(t,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!t.isEmpty();)if(i=n?r(t.key,n):1,n&&s&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(i===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const n={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Ht{constructor(t,n,r,s,i){this.key=t,this.value=n,this.color=r??Ht.RED,this.left=s??Ht.EMPTY,this.right=i??Ht.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,n,r,s,i){return new Ht(t??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,n,r){let s=this;const i=r(t,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(t,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(t,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Ht.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,n){let r,s=this;if(n(t,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(t,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(t,s.key)===0){if(s.right.isEmpty())return Ht.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(t,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Ht.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Ht.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,n)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw tt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw tt(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw tt(27949);return t+(this.isRed()?0:1)}}Ht.EMPTY=null,Ht.RED=!0,Ht.BLACK=!1;Ht.EMPTY=new class{constructor(){this.size=0}get key(){throw tt(57766)}get value(){throw tt(16141)}get color(){throw tt(16727)}get left(){throw tt(29726)}get right(){throw tt(36894)}copy(t,n,r,s,i){return this}insert(t,n,r){return new Ht(t,n)}remove(t,n){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lt{constructor(t){this.comparator=t,this.data=new Ct(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((n,r)=>(t(n),!1))}forEachInRange(t,n){const r=this.data.getIteratorFrom(t[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,t[1])>=0)return;n(s.key)}}forEachWhile(t,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!t(r.getNext().key))return}firstAfterOrEqual(t){const n=this.data.getIteratorFrom(t);return n.hasNext()?n.getNext().key:null}getIterator(){return new xu(this.data.getIterator())}getIteratorFrom(t){return new xu(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let n=this;return n.size<t.size&&(n=t,t=this),t.forEach(r=>{n=n.add(r)}),n}isEqual(t){if(!(t instanceof Lt)||this.size!==t.size)return!1;const n=this.data.getIterator(),r=t.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(n=>{t.push(n)}),t}toString(){const t=[];return this.forEach(n=>t.push(n)),"SortedSet("+t.toString()+")"}copy(t){const n=new Lt(this.comparator);return n.data=t,n}}class xu{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ge{constructor(t){this.fields=t,t.sort(Kt.comparator)}static empty(){return new ge([])}unionWith(t){let n=new Lt(Kt.comparator);for(const r of this.fields)n=n.add(r);for(const r of t)n=n.add(r);return new ge(n.toArray())}covers(t){for(const n of this.fields)if(n.isPrefixOf(t))return!0;return!1}isEqual(t){return Ar(this.fields,t.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wf extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gt{constructor(t){this.binaryString=t}static fromBase64String(t){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new Wf("Invalid base64 string: "+i):i}}(t);return new Gt(n)}static fromUint8Array(t){const n=function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i}(t);return new Gt(n)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return lt(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Gt.EMPTY_BYTE_STRING=new Gt("");const wE=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Rn(e){if(_t(!!e,39018),typeof e=="string"){let t=0;const n=wE.exec(e);if(_t(!!n,46558,{timestamp:e}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),t=Number(s)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:Vt(e.seconds),nanos:Vt(e.nanos)}}function Vt(e){return typeof e=="number"?e:typeof e=="string"?Number(e):0}function Sn(e){return typeof e=="string"?Gt.fromBase64String(e):Gt.fromUint8Array(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qf="server_timestamp",Yf="__type__",Xf="__previous_value__",Jf="__local_write_time__";function ul(e){var n,r;return((r=(((n=e==null?void 0:e.mapValue)==null?void 0:n.fields)||{})[Yf])==null?void 0:r.stringValue)===Qf}function uo(e){const t=e.mapValue.fields[Xf];return ul(t)?uo(t):t}function Ss(e){const t=Rn(e.mapValue.fields[Jf].timestampValue);return new St(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IE{constructor(t,n,r,s,i,a,l,u,f,d){this.databaseId=t,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=f,this.isUsingEmulator=d}}const Li="(default)";class Cs{constructor(t,n){this.projectId=t,this.database=n||Li}static empty(){return new Cs("","")}get isDefaultDatabase(){return this.database===Li}isEqual(t){return t instanceof Cs&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zf="__type__",AE="__max__",ii={mapValue:{}},td="__vector__",Fi="value";function Cn(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?ul(e)?4:RE(e)?9007199254740991:bE(e)?10:11:tt(28295,{value:e})}function Ge(e,t){if(e===t)return!0;const n=Cn(e);if(n!==Cn(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Ss(e).isEqual(Ss(t));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=Rn(s.timestampValue),l=Rn(i.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(s,i){return Sn(s.bytesValue).isEqual(Sn(i.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(s,i){return Vt(s.geoPointValue.latitude)===Vt(i.geoPointValue.latitude)&&Vt(s.geoPointValue.longitude)===Vt(i.geoPointValue.longitude)}(e,t);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Vt(s.integerValue)===Vt(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=Vt(s.doubleValue),l=Vt(i.doubleValue);return a===l?ki(a)===ki(l):isNaN(a)&&isNaN(l)}return!1}(e,t);case 9:return Ar(e.arrayValue.values||[],t.arrayValue.values||[],Ge);case 10:case 11:return function(s,i){const a=s.mapValue.fields||{},l=i.mapValue.fields||{};if(Du(a)!==Du(l))return!1;for(const u in a)if(a.hasOwnProperty(u)&&(l[u]===void 0||!Ge(a[u],l[u])))return!1;return!0}(e,t);default:return tt(52216,{left:e})}}function Ps(e,t){return(e.values||[]).find(n=>Ge(n,t))!==void 0}function br(e,t){if(e===t)return 0;const n=Cn(e),r=Cn(t);if(n!==r)return lt(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return lt(e.booleanValue,t.booleanValue);case 2:return function(i,a){const l=Vt(i.integerValue||i.doubleValue),u=Vt(a.integerValue||a.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(e,t);case 3:return Nu(e.timestampValue,t.timestampValue);case 4:return Nu(Ss(e),Ss(t));case 5:return Ea(e.stringValue,t.stringValue);case 6:return function(i,a){const l=Sn(i),u=Sn(a);return l.compareTo(u)}(e.bytesValue,t.bytesValue);case 7:return function(i,a){const l=i.split("/"),u=a.split("/");for(let f=0;f<l.length&&f<u.length;f++){const d=lt(l[f],u[f]);if(d!==0)return d}return lt(l.length,u.length)}(e.referenceValue,t.referenceValue);case 8:return function(i,a){const l=lt(Vt(i.latitude),Vt(a.latitude));return l!==0?l:lt(Vt(i.longitude),Vt(a.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return Ou(e.arrayValue,t.arrayValue);case 10:return function(i,a){var g,v,V,P;const l=i.fields||{},u=a.fields||{},f=(g=l[Fi])==null?void 0:g.arrayValue,d=(v=u[Fi])==null?void 0:v.arrayValue,p=lt(((V=f==null?void 0:f.values)==null?void 0:V.length)||0,((P=d==null?void 0:d.values)==null?void 0:P.length)||0);return p!==0?p:Ou(f,d)}(e.mapValue,t.mapValue);case 11:return function(i,a){if(i===ii.mapValue&&a===ii.mapValue)return 0;if(i===ii.mapValue)return 1;if(a===ii.mapValue)return-1;const l=i.fields||{},u=Object.keys(l),f=a.fields||{},d=Object.keys(f);u.sort(),d.sort();for(let p=0;p<u.length&&p<d.length;++p){const g=Ea(u[p],d[p]);if(g!==0)return g;const v=br(l[u[p]],f[d[p]]);if(v!==0)return v}return lt(u.length,d.length)}(e.mapValue,t.mapValue);default:throw tt(23264,{he:n})}}function Nu(e,t){if(typeof e=="string"&&typeof t=="string"&&e.length===t.length)return lt(e,t);const n=Rn(e),r=Rn(t),s=lt(n.seconds,r.seconds);return s!==0?s:lt(n.nanos,r.nanos)}function Ou(e,t){const n=e.values||[],r=t.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=br(n[s],r[s]);if(i)return i}return lt(n.length,r.length)}function Rr(e){return Ta(e)}function Ta(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(n){const r=Rn(n);return`time(${r.seconds},${r.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(n){return Sn(n).toBase64()}(e.bytesValue):"referenceValue"in e?function(n){return Y.fromName(n).toString()}(e.referenceValue):"geoPointValue"in e?function(n){return`geo(${n.latitude},${n.longitude})`}(e.geoPointValue):"arrayValue"in e?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=Ta(i);return r+"]"}(e.arrayValue):"mapValue"in e?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const a of r)i?i=!1:s+=",",s+=`${a}:${Ta(n.fields[a])}`;return s+"}"}(e.mapValue):tt(61005,{value:e})}function pi(e){switch(Cn(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=uo(e);return t?16+pi(t):16;case 5:return 2*e.stringValue.length;case 6:return Sn(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+pi(i),0)}(e.arrayValue);case 10:case 11:return function(r){let s=0;return Dn(r.fields,(i,a)=>{s+=i.length+pi(a)}),s}(e.mapValue);default:throw tt(13486,{value:e})}}function Mu(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function va(e){return!!e&&"integerValue"in e}function hl(e){return!!e&&"arrayValue"in e}function ku(e){return!!e&&"nullValue"in e}function Lu(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function mi(e){return!!e&&"mapValue"in e}function bE(e){var n,r;return((r=(((n=e==null?void 0:e.mapValue)==null?void 0:n.fields)||{})[Zf])==null?void 0:r.stringValue)===td}function ms(e){if(e.geoPointValue)return{geoPointValue:{...e.geoPointValue}};if(e.timestampValue&&typeof e.timestampValue=="object")return{timestampValue:{...e.timestampValue}};if(e.mapValue){const t={mapValue:{fields:{}}};return Dn(e.mapValue.fields,(n,r)=>t.mapValue.fields[n]=ms(r)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=ms(e.arrayValue.values[n]);return t}return{...e}}function RE(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===AE}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ce{constructor(t){this.value=t}static empty(){return new ce({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let n=this.value;for(let r=0;r<t.length-1;++r)if(n=(n.mapValue.fields||{})[t.get(r)],!mi(n))return null;return n=(n.mapValue.fields||{})[t.lastSegment()],n||null}}set(t,n){this.getFieldsMap(t.popLast())[t.lastSegment()]=ms(n)}setAll(t){let n=Kt.emptyPath(),r={},s=[];t.forEach((a,l)=>{if(!n.isImmediateParentOf(l)){const u=this.getFieldsMap(n);this.applyChanges(u,r,s),r={},s=[],n=l.popLast()}a?r[l.lastSegment()]=ms(a):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(t){const n=this.field(t.popLast());mi(n)&&n.mapValue.fields&&delete n.mapValue.fields[t.lastSegment()]}isEqual(t){return Ge(this.value,t.value)}getFieldsMap(t){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<t.length;++r){let s=n.mapValue.fields[t.get(r)];mi(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[t.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(t,n,r){Dn(n,(s,i)=>t[s]=i);for(const s of r)delete t[s]}clone(){return new ce(ms(this.value))}}function ed(e){const t=[];return Dn(e.fields,(n,r)=>{const s=new Kt([n]);if(mi(r)){const i=ed(r.mapValue).fields;if(i.length===0)t.push(s);else for(const a of i)t.push(s.child(a))}else t.push(s)}),new ge(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zt{constructor(t,n,r,s,i,a,l){this.key=t,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=a,this.documentState=l}static newInvalidDocument(t){return new Zt(t,0,nt.min(),nt.min(),nt.min(),ce.empty(),0)}static newFoundDocument(t,n,r,s){return new Zt(t,1,n,nt.min(),r,s,0)}static newNoDocument(t,n){return new Zt(t,2,n,nt.min(),nt.min(),ce.empty(),0)}static newUnknownDocument(t,n){return new Zt(t,3,n,nt.min(),nt.min(),ce.empty(),2)}convertToFoundDocument(t,n){return!this.createTime.isEqual(nt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=ce.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=ce.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=nt.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof Zt&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Zt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ui{constructor(t,n){this.position=t,this.inclusive=n}}function Fu(e,t,n){let r=0;for(let s=0;s<e.position.length;s++){const i=t[s],a=e.position[s];if(i.field.isKeyField()?r=Y.comparator(Y.fromName(a.referenceValue),n.key):r=br(a,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function Uu(e,t){if(e===null)return t===null;if(t===null||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Ge(e.position[n],t.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bi{constructor(t,n="asc"){this.field=t,this.dir=n}}function SE(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nd{}class xt extends nd{constructor(t,n,r){super(),this.field=t,this.op=n,this.value=r}static create(t,n,r){return t.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(t,n,r):new PE(t,n,r):n==="array-contains"?new xE(t,r):n==="in"?new NE(t,r):n==="not-in"?new OE(t,r):n==="array-contains-any"?new ME(t,r):new xt(t,n,r)}static createKeyFieldInFilter(t,n,r){return n==="in"?new VE(t,r):new DE(t,r)}matches(t){const n=t.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(br(n,this.value)):n!==null&&Cn(this.value)===Cn(n)&&this.matchesComparison(br(n,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return tt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Pe extends nd{constructor(t,n){super(),this.filters=t,this.op=n,this.Pe=null}static create(t,n){return new Pe(t,n)}matches(t){return rd(this)?this.filters.find(n=>!n.matches(t))===void 0:this.filters.find(n=>n.matches(t))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((t,n)=>t.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function rd(e){return e.op==="and"}function sd(e){return CE(e)&&rd(e)}function CE(e){for(const t of e.filters)if(t instanceof Pe)return!1;return!0}function wa(e){if(e instanceof xt)return e.field.canonicalString()+e.op.toString()+Rr(e.value);if(sd(e))return e.filters.map(t=>wa(t)).join(",");{const t=e.filters.map(n=>wa(n)).join(",");return`${e.op}(${t})`}}function id(e,t){return e instanceof xt?function(r,s){return s instanceof xt&&r.op===s.op&&r.field.isEqual(s.field)&&Ge(r.value,s.value)}(e,t):e instanceof Pe?function(r,s){return s instanceof Pe&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,a,l)=>i&&id(a,s.filters[l]),!0):!1}(e,t):void tt(19439)}function od(e){return e instanceof xt?function(n){return`${n.field.canonicalString()} ${n.op} ${Rr(n.value)}`}(e):e instanceof Pe?function(n){return n.op.toString()+" {"+n.getFilters().map(od).join(" ,")+"}"}(e):"Filter"}class PE extends xt{constructor(t,n,r){super(t,n,r),this.key=Y.fromName(r.referenceValue)}matches(t){const n=Y.comparator(t.key,this.key);return this.matchesComparison(n)}}class VE extends xt{constructor(t,n){super(t,"in",n),this.keys=ad("in",n)}matches(t){return this.keys.some(n=>n.isEqual(t.key))}}class DE extends xt{constructor(t,n){super(t,"not-in",n),this.keys=ad("not-in",n)}matches(t){return!this.keys.some(n=>n.isEqual(t.key))}}function ad(e,t){var n;return(((n=t.arrayValue)==null?void 0:n.values)||[]).map(r=>Y.fromName(r.referenceValue))}class xE extends xt{constructor(t,n){super(t,"array-contains",n)}matches(t){const n=t.data.field(this.field);return hl(n)&&Ps(n.arrayValue,this.value)}}class NE extends xt{constructor(t,n){super(t,"in",n)}matches(t){const n=t.data.field(this.field);return n!==null&&Ps(this.value.arrayValue,n)}}class OE extends xt{constructor(t,n){super(t,"not-in",n)}matches(t){if(Ps(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=t.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Ps(this.value.arrayValue,n)}}class ME extends xt{constructor(t,n){super(t,"array-contains-any",n)}matches(t){const n=t.data.field(this.field);return!(!hl(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Ps(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kE{constructor(t,n=null,r=[],s=[],i=null,a=null,l=null){this.path=t,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=a,this.endAt=l,this.Te=null}}function Bu(e,t=null,n=[],r=[],s=null,i=null,a=null){return new kE(e,t,n,r,s,i,a)}function fl(e){const t=rt(e);if(t.Te===null){let n=t.path.canonicalString();t.collectionGroup!==null&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map(r=>wa(r)).join(","),n+="|ob:",n+=t.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),co(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(r=>Rr(r)).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(r=>Rr(r)).join(",")),t.Te=n}return t.Te}function dl(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!SE(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!id(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Uu(e.startAt,t.startAt)&&Uu(e.endAt,t.endAt)}function Ia(e){return Y.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ks{constructor(t,n=null,r=[],s=[],i=null,a="F",l=null,u=null){this.path=t,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=a,this.startAt=l,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function LE(e,t,n,r,s,i,a,l){return new ks(e,t,n,r,s,i,a,l)}function pl(e){return new ks(e)}function ju(e){return e.filters.length===0&&e.limit===null&&e.startAt==null&&e.endAt==null&&(e.explicitOrderBy.length===0||e.explicitOrderBy.length===1&&e.explicitOrderBy[0].field.isKeyField())}function ld(e){return e.collectionGroup!==null}function gs(e){const t=rt(e);if(t.Ie===null){t.Ie=[];const n=new Set;for(const i of t.explicitOrderBy)t.Ie.push(i),n.add(i.field.canonicalString());const r=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(a){let l=new Lt(Kt.comparator);return a.filters.forEach(u=>{u.getFlattenedFilters().forEach(f=>{f.isInequality()&&(l=l.add(f.field))})}),l})(t).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||t.Ie.push(new Bi(i,r))}),n.has(Kt.keyField().canonicalString())||t.Ie.push(new Bi(Kt.keyField(),r))}return t.Ie}function Be(e){const t=rt(e);return t.Ee||(t.Ee=FE(t,gs(e))),t.Ee}function FE(e,t){if(e.limitType==="F")return Bu(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Bi(s.field,i)});const n=e.endAt?new Ui(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new Ui(e.startAt.position,e.startAt.inclusive):null;return Bu(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function Aa(e,t){const n=e.filters.concat([t]);return new ks(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function ba(e,t,n){return new ks(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function ho(e,t){return dl(Be(e),Be(t))&&e.limitType===t.limitType}function cd(e){return`${fl(Be(e))}|lt:${e.limitType}`}function hr(e){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>od(s)).join(", ")}]`),co(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>Rr(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>Rr(s)).join(",")),`Target(${r})`}(Be(e))}; limitType=${e.limitType})`}function fo(e,t){return t.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):Y.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(e,t)&&function(r,s){for(const i of gs(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(e,t)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(e,t)&&function(r,s){return!(r.startAt&&!function(a,l,u){const f=Fu(a,l,u);return a.inclusive?f<=0:f<0}(r.startAt,gs(r),s)||r.endAt&&!function(a,l,u){const f=Fu(a,l,u);return a.inclusive?f>=0:f>0}(r.endAt,gs(r),s))}(e,t)}function UE(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function ud(e){return(t,n)=>{let r=!1;for(const s of gs(e)){const i=BE(s,t,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function BE(e,t,n){const r=e.field.isKeyField()?Y.comparator(t.key,n.key):function(i,a,l){const u=a.data.field(i),f=l.data.field(i);return u!==null&&f!==null?br(u,f):tt(42886)}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return tt(19790,{direction:e.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zn{constructor(t,n){this.mapKeyFn=t,this.equalsFn=n,this.inner={},this.innerSize=0}get(t){const n=this.mapKeyFn(t),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,t))return i}}has(t){return this.get(t)!==void 0}set(t,n){const r=this.mapKeyFn(t),s=this.inner[r];if(s===void 0)return this.inner[r]=[[t,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],t))return void(s[i]=[t,n]);s.push([t,n]),this.innerSize++}delete(t){const n=this.mapKeyFn(t),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],t))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(t){Dn(this.inner,(n,r)=>{for(const[s,i]of r)t(s,i)})}isEmpty(){return Gf(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jE=new Ct(Y.comparator);function rn(){return jE}const hd=new Ct(Y.comparator);function ss(...e){let t=hd;for(const n of e)t=t.insert(n.key,n);return t}function fd(e){let t=hd;return e.forEach((n,r)=>t=t.insert(n,r.overlayedDocument)),t}function zn(){return _s()}function dd(){return _s()}function _s(){return new Zn(e=>e.toString(),(e,t)=>e.isEqual(t))}const $E=new Ct(Y.comparator),qE=new Lt(Y.comparator);function ct(...e){let t=qE;for(const n of e)t=t.add(n);return t}const HE=new Lt(lt);function zE(){return HE}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ml(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ki(t)?"-0":t}}function pd(e){return{integerValue:""+e}}function KE(e,t){return EE(t)?pd(t):ml(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class po{constructor(){this._=void 0}}function GE(e,t,n){return e instanceof ji?function(s,i){const a={fields:{[Yf]:{stringValue:Qf},[Jf]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&ul(i)&&(i=uo(i)),i&&(a.fields[Xf]=i),{mapValue:a}}(n,t):e instanceof Vs?gd(e,t):e instanceof Ds?_d(e,t):function(s,i){const a=md(s,i),l=$u(a)+$u(s.Ae);return va(a)&&va(s.Ae)?pd(l):ml(s.serializer,l)}(e,t)}function WE(e,t,n){return e instanceof Vs?gd(e,t):e instanceof Ds?_d(e,t):n}function md(e,t){return e instanceof $i?function(r){return va(r)||function(i){return!!i&&"doubleValue"in i}(r)}(t)?t:{integerValue:0}:null}class ji extends po{}class Vs extends po{constructor(t){super(),this.elements=t}}function gd(e,t){const n=yd(t);for(const r of e.elements)n.some(s=>Ge(s,r))||n.push(r);return{arrayValue:{values:n}}}class Ds extends po{constructor(t){super(),this.elements=t}}function _d(e,t){let n=yd(t);for(const r of e.elements)n=n.filter(s=>!Ge(s,r));return{arrayValue:{values:n}}}class $i extends po{constructor(t,n){super(),this.serializer=t,this.Ae=n}}function $u(e){return Vt(e.integerValue||e.doubleValue)}function yd(e){return hl(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}function QE(e,t){return e.field.isEqual(t.field)&&function(r,s){return r instanceof Vs&&s instanceof Vs||r instanceof Ds&&s instanceof Ds?Ar(r.elements,s.elements,Ge):r instanceof $i&&s instanceof $i?Ge(r.Ae,s.Ae):r instanceof ji&&s instanceof ji}(e.transform,t.transform)}class YE{constructor(t,n){this.version=t,this.transformResults=n}}class Ce{constructor(t,n){this.updateTime=t,this.exists=n}static none(){return new Ce}static exists(t){return new Ce(void 0,t)}static updateTime(t){return new Ce(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function gi(e,t){return e.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(e.updateTime):e.exists===void 0||e.exists===t.isFoundDocument()}class mo{}function Ed(e,t){if(!e.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return e.isNoDocument()?new gl(e.key,Ce.none()):new Ls(e.key,e.data,Ce.none());{const n=e.data,r=ce.empty();let s=new Lt(Kt.comparator);for(let i of t.fields)if(!s.has(i)){let a=n.field(i);a===null&&i.length>1&&(i=i.popLast(),a=n.field(i)),a===null?r.delete(i):r.set(i,a),s=s.add(i)}return new xn(e.key,r,new ge(s.toArray()),Ce.none())}}function XE(e,t,n){e instanceof Ls?function(s,i,a){const l=s.value.clone(),u=Hu(s.fieldTransforms,i,a.transformResults);l.setAll(u),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(e,t,n):e instanceof xn?function(s,i,a){if(!gi(s.precondition,i))return void i.convertToUnknownDocument(a.version);const l=Hu(s.fieldTransforms,i,a.transformResults),u=i.data;u.setAll(Td(s)),u.setAll(l),i.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(e,t,n):function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()}(0,t,n)}function ys(e,t,n,r){return e instanceof Ls?function(i,a,l,u){if(!gi(i.precondition,a))return l;const f=i.value.clone(),d=zu(i.fieldTransforms,u,a);return f.setAll(d),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),null}(e,t,n,r):e instanceof xn?function(i,a,l,u){if(!gi(i.precondition,a))return l;const f=zu(i.fieldTransforms,u,a),d=a.data;return d.setAll(Td(i)),d.setAll(f),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(p=>p.field))}(e,t,n,r):function(i,a,l){return gi(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l}(e,t,n)}function JE(e,t){let n=null;for(const r of e.fieldTransforms){const s=t.data.field(r.field),i=md(r.transform,s||null);i!=null&&(n===null&&(n=ce.empty()),n.set(r.field,i))}return n||null}function qu(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Ar(r,s,(i,a)=>QE(i,a))}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Ls extends mo{constructor(t,n,r,s=[]){super(),this.key=t,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class xn extends mo{constructor(t,n,r,s,i=[]){super(),this.key=t,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Td(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function Hu(e,t,n){const r=new Map;_t(e.length===n.length,32656,{Re:n.length,Ve:e.length});for(let s=0;s<n.length;s++){const i=e[s],a=i.transform,l=t.data.field(i.field);r.set(i.field,WE(a,l,n[s]))}return r}function zu(e,t,n){const r=new Map;for(const s of e){const i=s.transform,a=n.data.field(s.field);r.set(s.field,GE(i,a,t))}return r}class gl extends mo{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class ZE extends mo{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tT{constructor(t,n,r,s){this.batchId=t,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(t,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(t.key)&&XE(i,t,r[s])}}applyToLocalView(t,n){for(const r of this.baseMutations)r.key.isEqual(t.key)&&(n=ys(r,t,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(t.key)&&(n=ys(r,t,n,this.localWriteTime));return n}applyToLocalDocumentSet(t,n){const r=dd();return this.mutations.forEach(s=>{const i=t.get(s.key),a=i.overlayedDocument;let l=this.applyToLocalView(a,i.mutatedFields);l=n.has(s.key)?null:l;const u=Ed(a,l);u!==null&&r.set(s.key,u),a.isValidDocument()||a.convertToNoDocument(nt.min())}),r}keys(){return this.mutations.reduce((t,n)=>t.add(n.key),ct())}isEqual(t){return this.batchId===t.batchId&&Ar(this.mutations,t.mutations,(n,r)=>qu(n,r))&&Ar(this.baseMutations,t.baseMutations,(n,r)=>qu(n,r))}}class _l{constructor(t,n,r,s){this.batch=t,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(t,n,r){_t(t.mutations.length===r.length,58842,{me:t.mutations.length,fe:r.length});let s=function(){return $E}();const i=t.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,r[a].version);return new _l(t,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eT{constructor(t,n){this.largestBatchId=t,this.mutation=n}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nT{constructor(t,n){this.count=t,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Dt,ht;function rT(e){switch(e){case N.OK:return tt(64938);case N.CANCELLED:case N.UNKNOWN:case N.DEADLINE_EXCEEDED:case N.RESOURCE_EXHAUSTED:case N.INTERNAL:case N.UNAVAILABLE:case N.UNAUTHENTICATED:return!1;case N.INVALID_ARGUMENT:case N.NOT_FOUND:case N.ALREADY_EXISTS:case N.PERMISSION_DENIED:case N.FAILED_PRECONDITION:case N.ABORTED:case N.OUT_OF_RANGE:case N.UNIMPLEMENTED:case N.DATA_LOSS:return!0;default:return tt(15467,{code:e})}}function vd(e){if(e===void 0)return nn("GRPC error has no .code"),N.UNKNOWN;switch(e){case Dt.OK:return N.OK;case Dt.CANCELLED:return N.CANCELLED;case Dt.UNKNOWN:return N.UNKNOWN;case Dt.DEADLINE_EXCEEDED:return N.DEADLINE_EXCEEDED;case Dt.RESOURCE_EXHAUSTED:return N.RESOURCE_EXHAUSTED;case Dt.INTERNAL:return N.INTERNAL;case Dt.UNAVAILABLE:return N.UNAVAILABLE;case Dt.UNAUTHENTICATED:return N.UNAUTHENTICATED;case Dt.INVALID_ARGUMENT:return N.INVALID_ARGUMENT;case Dt.NOT_FOUND:return N.NOT_FOUND;case Dt.ALREADY_EXISTS:return N.ALREADY_EXISTS;case Dt.PERMISSION_DENIED:return N.PERMISSION_DENIED;case Dt.FAILED_PRECONDITION:return N.FAILED_PRECONDITION;case Dt.ABORTED:return N.ABORTED;case Dt.OUT_OF_RANGE:return N.OUT_OF_RANGE;case Dt.UNIMPLEMENTED:return N.UNIMPLEMENTED;case Dt.DATA_LOSS:return N.DATA_LOSS;default:return tt(39323,{code:e})}}(ht=Dt||(Dt={}))[ht.OK=0]="OK",ht[ht.CANCELLED=1]="CANCELLED",ht[ht.UNKNOWN=2]="UNKNOWN",ht[ht.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ht[ht.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ht[ht.NOT_FOUND=5]="NOT_FOUND",ht[ht.ALREADY_EXISTS=6]="ALREADY_EXISTS",ht[ht.PERMISSION_DENIED=7]="PERMISSION_DENIED",ht[ht.UNAUTHENTICATED=16]="UNAUTHENTICATED",ht[ht.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ht[ht.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ht[ht.ABORTED=10]="ABORTED",ht[ht.OUT_OF_RANGE=11]="OUT_OF_RANGE",ht[ht.UNIMPLEMENTED=12]="UNIMPLEMENTED",ht[ht.INTERNAL=13]="INTERNAL",ht[ht.UNAVAILABLE=14]="UNAVAILABLE",ht[ht.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sT(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iT=new En([4294967295,4294967295],0);function Ku(e){const t=sT().encode(e),n=new kf;return n.update(t),new Uint8Array(n.digest())}function Gu(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),s=t.getUint32(8,!0),i=t.getUint32(12,!0);return[new En([n,r],0),new En([s,i],0)]}class yl{constructor(t,n,r){if(this.bitmap=t,this.padding=n,this.hashCount=r,n<0||n>=8)throw new is(`Invalid padding: ${n}`);if(r<0)throw new is(`Invalid hash count: ${r}`);if(t.length>0&&this.hashCount===0)throw new is(`Invalid hash count: ${r}`);if(t.length===0&&n!==0)throw new is(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*t.length-n,this.pe=En.fromNumber(this.ge)}ye(t,n,r){let s=t.add(n.multiply(En.fromNumber(r)));return s.compare(iT)===1&&(s=new En([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(this.ge===0)return!1;const n=Ku(t),[r,s]=Gu(n);for(let i=0;i<this.hashCount;i++){const a=this.ye(r,s,i);if(!this.we(a))return!1}return!0}static create(t,n,r){const s=t%8==0?0:8-t%8,i=new Uint8Array(Math.ceil(t/8)),a=new yl(i,s,n);return r.forEach(l=>a.insert(l)),a}insert(t){if(this.ge===0)return;const n=Ku(t),[r,s]=Gu(n);for(let i=0;i<this.hashCount;i++){const a=this.ye(r,s,i);this.Se(a)}}Se(t){const n=Math.floor(t/8),r=t%8;this.bitmap[n]|=1<<r}}class is extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class go{constructor(t,n,r,s,i){this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(t,n,r){const s=new Map;return s.set(t,Fs.createSynthesizedTargetChangeForCurrentChange(t,n,r)),new go(nt.min(),s,new Ct(lt),rn(),ct())}}class Fs{constructor(t,n,r,s,i){this.resumeToken=t,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(t,n,r){return new Fs(r,n,ct(),ct(),ct())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i{constructor(t,n,r,s){this.be=t,this.removedTargetIds=n,this.key=r,this.De=s}}class wd{constructor(t,n){this.targetId=t,this.Ce=n}}class Id{constructor(t,n,r=Gt.EMPTY_BYTE_STRING,s=null){this.state=t,this.targetIds=n,this.resumeToken=r,this.cause=s}}class Wu{constructor(){this.ve=0,this.Fe=Qu(),this.Me=Gt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(t){t.approximateByteSize()>0&&(this.Oe=!0,this.Me=t)}ke(){let t=ct(),n=ct(),r=ct();return this.Fe.forEach((s,i)=>{switch(i){case 0:t=t.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:tt(38017,{changeType:i})}}),new Fs(this.Me,this.xe,t,n,r)}qe(){this.Oe=!1,this.Fe=Qu()}Qe(t,n){this.Oe=!0,this.Fe=this.Fe.insert(t,n)}$e(t){this.Oe=!0,this.Fe=this.Fe.remove(t)}Ue(){this.ve+=1}Ke(){this.ve-=1,_t(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class oT{constructor(t){this.Ge=t,this.ze=new Map,this.je=rn(),this.Je=oi(),this.He=oi(),this.Ye=new Ct(lt)}Ze(t){for(const n of t.be)t.De&&t.De.isFoundDocument()?this.Xe(n,t.De):this.et(n,t.key,t.De);for(const n of t.removedTargetIds)this.et(n,t.key,t.De)}tt(t){this.forEachTarget(t,n=>{const r=this.nt(n);switch(t.state){case 0:this.rt(n)&&r.Le(t.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(t.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(t.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(t.resumeToken));break;default:tt(56790,{state:t.state})}})}forEachTarget(t,n){t.targetIds.length>0?t.targetIds.forEach(n):this.ze.forEach((r,s)=>{this.rt(s)&&n(s)})}st(t){const n=t.targetId,r=t.Ce.count,s=this.ot(n);if(s){const i=s.target;if(Ia(i))if(r===0){const a=new Y(i.path);this.et(n,a,Zt.newNoDocument(a,nt.min()))}else _t(r===1,20013,{expectedCount:r});else{const a=this._t(n);if(a!==r){const l=this.ut(t),u=l?this.ct(l,t,a):1;if(u!==0){this.it(n);const f=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,f)}}}}}ut(t){const n=t.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let a,l;try{a=Sn(r).toUint8Array()}catch(u){if(u instanceof Wf)return Ir("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new yl(a,s,i)}catch(u){return Ir(u instanceof is?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.ge===0?null:l}ct(t,n,r){return n.Ce.count===r-this.Pt(t,n.targetId)?0:2}Pt(t,n){const r=this.Ge.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const a=this.Ge.ht(),l=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;t.mightContain(l)||(this.et(n,i,null),s++)}),s}Tt(t){const n=new Map;this.ze.forEach((i,a)=>{const l=this.ot(a);if(l){if(i.current&&Ia(l.target)){const u=new Y(l.target.path);this.It(u).has(a)||this.Et(a,u)||this.et(a,u,Zt.newNoDocument(u,t))}i.Be&&(n.set(a,i.ke()),i.qe())}});let r=ct();this.He.forEach((i,a)=>{let l=!0;a.forEachWhile(u=>{const f=this.ot(u);return!f||f.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.je.forEach((i,a)=>a.setReadTime(t));const s=new go(t,n,this.Ye,this.je,r);return this.je=rn(),this.Je=oi(),this.He=oi(),this.Ye=new Ct(lt),s}Xe(t,n){if(!this.rt(t))return;const r=this.Et(t,n.key)?2:0;this.nt(t).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(t)),this.He=this.He.insert(n.key,this.dt(n.key).add(t))}et(t,n,r){if(!this.rt(t))return;const s=this.nt(t);this.Et(t,n)?s.Qe(n,1):s.$e(n),this.He=this.He.insert(n,this.dt(n).delete(t)),this.He=this.He.insert(n,this.dt(n).add(t)),r&&(this.je=this.je.insert(n,r))}removeTarget(t){this.ze.delete(t)}_t(t){const n=this.nt(t).ke();return this.Ge.getRemoteKeysForTarget(t).size+n.addedDocuments.size-n.removedDocuments.size}Ue(t){this.nt(t).Ue()}nt(t){let n=this.ze.get(t);return n||(n=new Wu,this.ze.set(t,n)),n}dt(t){let n=this.He.get(t);return n||(n=new Lt(lt),this.He=this.He.insert(t,n)),n}It(t){let n=this.Je.get(t);return n||(n=new Lt(lt),this.Je=this.Je.insert(t,n)),n}rt(t){const n=this.ot(t)!==null;return n||K("WatchChangeAggregator","Detected inactive target",t),n}ot(t){const n=this.ze.get(t);return n&&n.Ne?null:this.Ge.At(t)}it(t){this.ze.set(t,new Wu),this.Ge.getRemoteKeysForTarget(t).forEach(n=>{this.et(t,n,null)})}Et(t,n){return this.Ge.getRemoteKeysForTarget(t).has(n)}}function oi(){return new Ct(Y.comparator)}function Qu(){return new Ct(Y.comparator)}const aT={asc:"ASCENDING",desc:"DESCENDING"},lT={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},cT={and:"AND",or:"OR"};class uT{constructor(t,n){this.databaseId=t,this.useProto3Json=n}}function Ra(e,t){return e.useProto3Json||co(t)?t:{value:t}}function qi(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Ad(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function hT(e,t){return qi(e,t.toTimestamp())}function je(e){return _t(!!e,49232),nt.fromTimestamp(function(n){const r=Rn(n);return new St(r.seconds,r.nanos)}(e))}function El(e,t){return Sa(e,t).canonicalString()}function Sa(e,t){const n=function(s){return new It(["projects",s.projectId,"databases",s.database])}(e).child("documents");return t===void 0?n:n.child(t)}function bd(e){const t=It.fromString(e);return _t(Vd(t),10190,{key:t.toString()}),t}function Ca(e,t){return El(e.databaseId,t.path)}function Jo(e,t){const n=bd(t);if(n.get(1)!==e.databaseId.projectId)throw new z(N.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new z(N.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new Y(Sd(n))}function Rd(e,t){return El(e.databaseId,t)}function fT(e){const t=bd(e);return t.length===4?It.emptyPath():Sd(t)}function Pa(e){return new It(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Sd(e){return _t(e.length>4&&e.get(4)==="documents",29091,{key:e.toString()}),e.popFirst(5)}function Yu(e,t,n){return{name:Ca(e,t),fields:n.value.mapValue.fields}}function dT(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(f){return f==="NO_CHANGE"?0:f==="ADD"?1:f==="REMOVE"?2:f==="CURRENT"?3:f==="RESET"?4:tt(39313,{state:f})}(t.targetChange.targetChangeType||"NO_CHANGE"),s=t.targetChange.targetIds||[],i=function(f,d){return f.useProto3Json?(_t(d===void 0||typeof d=="string",58123),Gt.fromBase64String(d||"")):(_t(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),Gt.fromUint8Array(d||new Uint8Array))}(e,t.targetChange.resumeToken),a=t.targetChange.cause,l=a&&function(f){const d=f.code===void 0?N.UNKNOWN:vd(f.code);return new z(d,f.message||"")}(a);n=new Id(r,s,i,l||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const s=Jo(e,r.document.name),i=je(r.document.updateTime),a=r.document.createTime?je(r.document.createTime):nt.min(),l=new ce({mapValue:{fields:r.document.fields}}),u=Zt.newFoundDocument(s,i,a,l),f=r.targetIds||[],d=r.removedTargetIds||[];n=new _i(f,d,u.key,u)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const s=Jo(e,r.document),i=r.readTime?je(r.readTime):nt.min(),a=Zt.newNoDocument(s,i),l=r.removedTargetIds||[];n=new _i([],l,a.key,a)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const s=Jo(e,r.document),i=r.removedTargetIds||[];n=new _i([],i,s,null)}else{if(!("filter"in t))return tt(11601,{Rt:t});{t.filter;const r=t.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,a=new nT(s,i),l=r.targetId;n=new wd(l,a)}}return n}function pT(e,t){let n;if(t instanceof Ls)n={update:Yu(e,t.key,t.value)};else if(t instanceof gl)n={delete:Ca(e,t.key)};else if(t instanceof xn)n={update:Yu(e,t.key,t.data),updateMask:IT(t.fieldMask)};else{if(!(t instanceof ZE))return tt(16599,{Vt:t.type});n={verify:Ca(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(r=>function(i,a){const l=a.transform;if(l instanceof ji)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Vs)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Ds)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof $i)return{fieldPath:a.field.canonicalString(),increment:l.Ae};throw tt(20930,{transform:a.transform})}(0,r))),t.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:hT(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:tt(27497)}(e,t.precondition)),n}function mT(e,t){return e&&e.length>0?(_t(t!==void 0,14353),e.map(n=>function(s,i){let a=s.updateTime?je(s.updateTime):je(i);return a.isEqual(nt.min())&&(a=je(i)),new YE(a,s.transformResults||[])}(n,t))):[]}function gT(e,t){return{documents:[Rd(e,t.path)]}}function _T(e,t){const n={structuredQuery:{}},r=t.path;let s;t.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Rd(e,s);const i=function(f){if(f.length!==0)return Pd(Pe.create(f,"and"))}(t.filters);i&&(n.structuredQuery.where=i);const a=function(f){if(f.length!==0)return f.map(d=>function(g){return{field:fr(g.field),direction:TT(g.dir)}}(d))}(t.orderBy);a&&(n.structuredQuery.orderBy=a);const l=Ra(e,t.limit);return l!==null&&(n.structuredQuery.limit=l),t.startAt&&(n.structuredQuery.startAt=function(f){return{before:f.inclusive,values:f.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(f){return{before:!f.inclusive,values:f.position}}(t.endAt)),{ft:n,parent:s}}function yT(e){let t=fT(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){_t(r===1,65062);const d=n.from[0];d.allDescendants?s=d.collectionId:t=t.child(d.collectionId)}let i=[];n.where&&(i=function(p){const g=Cd(p);return g instanceof Pe&&sd(g)?g.getFilters():[g]}(n.where));let a=[];n.orderBy&&(a=function(p){return p.map(g=>function(V){return new Bi(dr(V.field),function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(V.direction))}(g))}(n.orderBy));let l=null;n.limit&&(l=function(p){let g;return g=typeof p=="object"?p.value:p,co(g)?null:g}(n.limit));let u=null;n.startAt&&(u=function(p){const g=!!p.before,v=p.values||[];return new Ui(v,g)}(n.startAt));let f=null;return n.endAt&&(f=function(p){const g=!p.before,v=p.values||[];return new Ui(v,g)}(n.endAt)),LE(t,s,a,i,l,"F",u,f)}function ET(e,t){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return tt(28987,{purpose:s})}}(t.purpose);return n==null?null:{"goog-listen-tags":n}}function Cd(e){return e.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=dr(n.unaryFilter.field);return xt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=dr(n.unaryFilter.field);return xt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=dr(n.unaryFilter.field);return xt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=dr(n.unaryFilter.field);return xt.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return tt(61313);default:return tt(60726)}}(e):e.fieldFilter!==void 0?function(n){return xt.create(dr(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return tt(58110);default:return tt(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(e):e.compositeFilter!==void 0?function(n){return Pe.create(n.compositeFilter.filters.map(r=>Cd(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return tt(1026)}}(n.compositeFilter.op))}(e):tt(30097,{filter:e})}function TT(e){return aT[e]}function vT(e){return lT[e]}function wT(e){return cT[e]}function fr(e){return{fieldPath:e.canonicalString()}}function dr(e){return Kt.fromServerFormat(e.fieldPath)}function Pd(e){return e instanceof xt?function(n){if(n.op==="=="){if(Lu(n.value))return{unaryFilter:{field:fr(n.field),op:"IS_NAN"}};if(ku(n.value))return{unaryFilter:{field:fr(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Lu(n.value))return{unaryFilter:{field:fr(n.field),op:"IS_NOT_NAN"}};if(ku(n.value))return{unaryFilter:{field:fr(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:fr(n.field),op:vT(n.op),value:n.value}}}(e):e instanceof Pe?function(n){const r=n.getFilters().map(s=>Pd(s));return r.length===1?r[0]:{compositeFilter:{op:wT(n.op),filters:r}}}(e):tt(54877,{filter:e})}function IT(e){const t=[];return e.fields.forEach(n=>t.push(n.canonicalString())),{fieldPaths:t}}function Vd(e){return e.length>=4&&e.get(0)==="projects"&&e.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mn{constructor(t,n,r,s,i=nt.min(),a=nt.min(),l=Gt.EMPTY_BYTE_STRING,u=null){this.target=t,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(t){return new mn(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,n){return new mn(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new mn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new mn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AT{constructor(t){this.yt=t}}function bT(e){const t=yT({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType==="LAST"?ba(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RT{constructor(){this.Cn=new ST}addToCollectionParentIndex(t,n){return this.Cn.add(n),O.resolve()}getCollectionParents(t,n){return O.resolve(this.Cn.getEntries(n))}addFieldIndex(t,n){return O.resolve()}deleteFieldIndex(t,n){return O.resolve()}deleteAllFieldIndexes(t){return O.resolve()}createTargetIndexes(t,n){return O.resolve()}getDocumentsMatchingTarget(t,n){return O.resolve(null)}getIndexType(t,n){return O.resolve(0)}getFieldIndexes(t,n){return O.resolve([])}getNextCollectionGroupToUpdate(t){return O.resolve(null)}getMinOffset(t,n){return O.resolve(bn.min())}getMinOffsetFromCollectionGroup(t,n){return O.resolve(bn.min())}updateCollectionGroup(t,n,r){return O.resolve()}updateIndexEntries(t,n){return O.resolve()}}class ST{constructor(){this.index={}}add(t){const n=t.lastSegment(),r=t.popLast(),s=this.index[n]||new Lt(It.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(t){const n=t.lastSegment(),r=t.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(t){return(this.index[t]||new Lt(It.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xu={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Dd=41943040;class le{static withCacheSize(t){return new le(t,le.DEFAULT_COLLECTION_PERCENTILE,le.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,n,r){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */le.DEFAULT_COLLECTION_PERCENTILE=10,le.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,le.DEFAULT=new le(Dd,le.DEFAULT_COLLECTION_PERCENTILE,le.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),le.DISABLED=new le(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{constructor(t){this.ar=t}next(){return this.ar+=2,this.ar}static ur(){return new Sr(0)}static cr(){return new Sr(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ju="LruGarbageCollector",CT=1048576;function Zu([e,t],[n,r]){const s=lt(e,n);return s===0?lt(t,r):s}class PT{constructor(t){this.Ir=t,this.buffer=new Lt(Zu),this.Er=0}dr(){return++this.Er}Ar(t){const n=[t,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();Zu(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class VT{constructor(t,n,r){this.garbageCollector=t,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(t){K(Ju,`Garbage collection scheduled in ${t}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){xr(n)?K(Ju,"Ignoring IndexedDB error during garbage collection: ",n):await Dr(n)}await this.Vr(3e5)})}}class DT{constructor(t,n){this.mr=t,this.params=n}calculateTargetCount(t,n){return this.mr.gr(t).next(r=>Math.floor(n/100*r))}nthSequenceNumber(t,n){if(n===0)return O.resolve(lo.ce);const r=new PT(n);return this.mr.forEachTarget(t,s=>r.Ar(s.sequenceNumber)).next(()=>this.mr.pr(t,s=>r.Ar(s))).next(()=>r.maxValue)}removeTargets(t,n,r){return this.mr.removeTargets(t,n,r)}removeOrphanedDocuments(t,n){return this.mr.removeOrphanedDocuments(t,n)}collect(t,n){return this.params.cacheSizeCollectionThreshold===-1?(K("LruGarbageCollector","Garbage collection skipped; disabled"),O.resolve(Xu)):this.getCacheSize(t).next(r=>r<this.params.cacheSizeCollectionThreshold?(K("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Xu):this.yr(t,n))}getCacheSize(t){return this.mr.getCacheSize(t)}yr(t,n){let r,s,i,a,l,u,f;const d=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(K("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),s=this.params.maximumSequenceNumbersToCollect):s=p,a=Date.now(),this.nthSequenceNumber(t,s))).next(p=>(r=p,l=Date.now(),this.removeTargets(t,r,n))).next(p=>(i=p,u=Date.now(),this.removeOrphanedDocuments(t,r))).next(p=>(f=Date.now(),ur()<=ft.DEBUG&&K("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-d}ms
	Determined least recently used ${s} in `+(l-a)+`ms
	Removed ${i} targets in `+(u-l)+`ms
	Removed ${p} documents in `+(f-u)+`ms
Total Duration: ${f-d}ms`),O.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:p})))}}function xT(e,t){return new DT(e,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NT{constructor(){this.changes=new Zn(t=>t.toString(),(t,n)=>t.isEqual(n)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,n){this.assertNotApplied(),this.changes.set(t,Zt.newInvalidDocument(t).setReadTime(n))}getEntry(t,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?O.resolve(r):this.getFromCache(t,n)}getEntries(t,n){return this.getAllFromCache(t,n)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OT{constructor(t,n){this.overlayedDocument=t,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MT{constructor(t,n,r,s){this.remoteDocumentCache=t,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(t,n){let r=null;return this.documentOverlayCache.getOverlay(t,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(t,n))).next(s=>(r!==null&&ys(r.mutation,s,ge.empty(),St.now()),s))}getDocuments(t,n){return this.remoteDocumentCache.getEntries(t,n).next(r=>this.getLocalViewOfDocuments(t,r,ct()).next(()=>r))}getLocalViewOfDocuments(t,n,r=ct()){const s=zn();return this.populateOverlays(t,s,n).next(()=>this.computeViews(t,n,s,r).next(i=>{let a=ss();return i.forEach((l,u)=>{a=a.insert(l,u.overlayedDocument)}),a}))}getOverlayedDocuments(t,n){const r=zn();return this.populateOverlays(t,r,n).next(()=>this.computeViews(t,n,r,ct()))}populateOverlays(t,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(t,s).next(i=>{i.forEach((a,l)=>{n.set(a,l)})})}computeViews(t,n,r,s){let i=rn();const a=_s(),l=function(){return _s()}();return n.forEach((u,f)=>{const d=r.get(f.key);s.has(f.key)&&(d===void 0||d.mutation instanceof xn)?i=i.insert(f.key,f):d!==void 0?(a.set(f.key,d.mutation.getFieldMask()),ys(d.mutation,f,d.mutation.getFieldMask(),St.now())):a.set(f.key,ge.empty())}),this.recalculateAndSaveOverlays(t,i).next(u=>(u.forEach((f,d)=>a.set(f,d)),n.forEach((f,d)=>l.set(f,new OT(d,a.get(f)??null))),l))}recalculateAndSaveOverlays(t,n){const r=_s();let s=new Ct((a,l)=>a-l),i=ct();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,n).next(a=>{for(const l of a)l.keys().forEach(u=>{const f=n.get(u);if(f===null)return;let d=r.get(u)||ge.empty();d=l.applyToLocalView(f,d),r.set(u,d);const p=(s.get(l.batchId)||ct()).add(u);s=s.insert(l.batchId,p)})}).next(()=>{const a=[],l=s.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),f=u.key,d=u.value,p=dd();d.forEach(g=>{if(!i.has(g)){const v=Ed(n.get(g),r.get(g));v!==null&&p.set(g,v),i=i.add(g)}}),a.push(this.documentOverlayCache.saveOverlays(t,f,p))}return O.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(t,n){return this.remoteDocumentCache.getEntries(t,n).next(r=>this.recalculateAndSaveOverlays(t,r))}getDocumentsMatchingQuery(t,n,r,s){return function(a){return Y.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(t,n.path):ld(n)?this.getDocumentsMatchingCollectionGroupQuery(t,n,r,s):this.getDocumentsMatchingCollectionQuery(t,n,r,s)}getNextDocuments(t,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(t,n,r,s).next(i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,n,r.largestBatchId,s-i.size):O.resolve(zn());let l=Rs,u=i;return a.next(f=>O.forEach(f,(d,p)=>(l<p.largestBatchId&&(l=p.largestBatchId),i.get(d)?O.resolve():this.remoteDocumentCache.getEntry(t,d).next(g=>{u=u.insert(d,g)}))).next(()=>this.populateOverlays(t,f,i)).next(()=>this.computeViews(t,u,f,ct())).next(d=>({batchId:l,changes:fd(d)})))})}getDocumentsMatchingDocumentQuery(t,n){return this.getDocument(t,new Y(n)).next(r=>{let s=ss();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(t,n,r,s){const i=n.collectionGroup;let a=ss();return this.indexManager.getCollectionParents(t,i).next(l=>O.forEach(l,u=>{const f=function(p,g){return new ks(g,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(n,u.child(i));return this.getDocumentsMatchingCollectionQuery(t,f,r,s).next(d=>{d.forEach((p,g)=>{a=a.insert(p,g)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(t,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(t,n.path,r.largestBatchId).next(a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(t,n,r,i,s))).next(a=>{i.forEach((u,f)=>{const d=f.getKey();a.get(d)===null&&(a=a.insert(d,Zt.newInvalidDocument(d)))});let l=ss();return a.forEach((u,f)=>{const d=i.get(u);d!==void 0&&ys(d.mutation,f,ge.empty(),St.now()),fo(n,f)&&(l=l.insert(u,f))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kT{constructor(t){this.serializer=t,this.Lr=new Map,this.kr=new Map}getBundleMetadata(t,n){return O.resolve(this.Lr.get(n))}saveBundleMetadata(t,n){return this.Lr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:je(s.createTime)}}(n)),O.resolve()}getNamedQuery(t,n){return O.resolve(this.kr.get(n))}saveNamedQuery(t,n){return this.kr.set(n.name,function(s){return{name:s.name,query:bT(s.bundledQuery),readTime:je(s.readTime)}}(n)),O.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LT{constructor(){this.overlays=new Ct(Y.comparator),this.qr=new Map}getOverlay(t,n){return O.resolve(this.overlays.get(n))}getOverlays(t,n){const r=zn();return O.forEach(n,s=>this.getOverlay(t,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(t,n,r){return r.forEach((s,i)=>{this.St(t,n,i)}),O.resolve()}removeOverlaysForBatchId(t,n,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(r)),O.resolve()}getOverlaysForCollection(t,n,r){const s=zn(),i=n.length+1,a=new Y(n.child("")),l=this.overlays.getIteratorFrom(a);for(;l.hasNext();){const u=l.getNext().value,f=u.getKey();if(!n.isPrefixOf(f.path))break;f.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return O.resolve(s)}getOverlaysForCollectionGroup(t,n,r,s){let i=new Ct((f,d)=>f-d);const a=this.overlays.getIterator();for(;a.hasNext();){const f=a.getNext().value;if(f.getKey().getCollectionGroup()===n&&f.largestBatchId>r){let d=i.get(f.largestBatchId);d===null&&(d=zn(),i=i.insert(f.largestBatchId,d)),d.set(f.getKey(),f)}}const l=zn(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((f,d)=>l.set(f,d)),!(l.size()>=s)););return O.resolve(l)}St(t,n,r){const s=this.overlays.get(r.key);if(s!==null){const a=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new eT(n,r));let i=this.qr.get(n);i===void 0&&(i=ct(),this.qr.set(n,i)),this.qr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FT{constructor(){this.sessionToken=Gt.EMPTY_BYTE_STRING}getSessionToken(t){return O.resolve(this.sessionToken)}setSessionToken(t,n){return this.sessionToken=n,O.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tl{constructor(){this.Qr=new Lt(jt.$r),this.Ur=new Lt(jt.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(t,n){const r=new jt(t,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(t,n){t.forEach(r=>this.addReference(r,n))}removeReference(t,n){this.Gr(new jt(t,n))}zr(t,n){t.forEach(r=>this.removeReference(r,n))}jr(t){const n=new Y(new It([])),r=new jt(n,t),s=new jt(n,t+1),i=[];return this.Ur.forEachInRange([r,s],a=>{this.Gr(a),i.push(a.key)}),i}Jr(){this.Qr.forEach(t=>this.Gr(t))}Gr(t){this.Qr=this.Qr.delete(t),this.Ur=this.Ur.delete(t)}Hr(t){const n=new Y(new It([])),r=new jt(n,t),s=new jt(n,t+1);let i=ct();return this.Ur.forEachInRange([r,s],a=>{i=i.add(a.key)}),i}containsKey(t){const n=new jt(t,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&t.isEqual(r.key)}}class jt{constructor(t,n){this.key=t,this.Yr=n}static $r(t,n){return Y.comparator(t.key,n.key)||lt(t.Yr,n.Yr)}static Kr(t,n){return lt(t.Yr,n.Yr)||Y.comparator(t.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UT{constructor(t,n){this.indexManager=t,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new Lt(jt.$r)}checkEmpty(t){return O.resolve(this.mutationQueue.length===0)}addMutationBatch(t,n,r,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new tT(i,n,r,s);this.mutationQueue.push(a);for(const l of s)this.Zr=this.Zr.add(new jt(l.key,i)),this.indexManager.addToCollectionParentIndex(t,l.key.path.popLast());return O.resolve(a)}lookupMutationBatch(t,n){return O.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(t,n){const r=n+1,s=this.ei(r),i=s<0?0:s;return O.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return O.resolve(this.mutationQueue.length===0?cl:this.tr-1)}getAllMutationBatches(t){return O.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,n){const r=new jt(n,0),s=new jt(n,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([r,s],a=>{const l=this.Xr(a.Yr);i.push(l)}),O.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(t,n){let r=new Lt(lt);return n.forEach(s=>{const i=new jt(s,0),a=new jt(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,a],l=>{r=r.add(l.Yr)})}),O.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(t,n){const r=n.path,s=r.length+1;let i=r;Y.isDocumentKey(i)||(i=i.child(""));const a=new jt(new Y(i),0);let l=new Lt(lt);return this.Zr.forEachWhile(u=>{const f=u.key.path;return!!r.isPrefixOf(f)&&(f.length===s&&(l=l.add(u.Yr)),!0)},a),O.resolve(this.ti(l))}ti(t){const n=[];return t.forEach(r=>{const s=this.Xr(r);s!==null&&n.push(s)}),n}removeMutationBatch(t,n){_t(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return O.forEach(n.mutations,s=>{const i=new jt(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(t,s.key)}).next(()=>{this.Zr=r})}ir(t){}containsKey(t,n){const r=new jt(n,0),s=this.Zr.firstAfterOrEqual(r);return O.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(t){return this.mutationQueue.length,O.resolve()}ni(t,n){return this.ei(t)}ei(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Xr(t){const n=this.ei(t);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BT{constructor(t){this.ri=t,this.docs=function(){return new Ct(Y.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,a=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(t,r.path.popLast())}removeEntry(t){const n=this.docs.get(t);n&&(this.docs=this.docs.remove(t),this.size-=n.size)}getEntry(t,n){const r=this.docs.get(n);return O.resolve(r?r.document.mutableCopy():Zt.newInvalidDocument(n))}getEntries(t,n){let r=rn();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Zt.newInvalidDocument(s))}),O.resolve(r)}getDocumentsMatchingQuery(t,n,r,s){let i=rn();const a=n.path,l=new Y(a.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:f,value:{document:d}}=u.getNext();if(!a.isPrefixOf(f.path))break;f.path.length>a.length+1||mE(pE(d),r)<=0||(s.has(d.key)||fo(n,d))&&(i=i.insert(d.key,d.mutableCopy()))}return O.resolve(i)}getAllFromCollectionGroup(t,n,r,s){tt(9500)}ii(t,n){return O.forEach(this.docs,r=>n(r))}newChangeBuffer(t){return new jT(this)}getSize(t){return O.resolve(this.size)}}class jT extends NT{constructor(t){super(),this.Nr=t}applyChanges(t){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Nr.addEntry(t,s)):this.Nr.removeEntry(r)}),O.waitFor(n)}getFromCache(t,n){return this.Nr.getEntry(t,n)}getAllFromCache(t,n){return this.Nr.getEntries(t,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $T{constructor(t){this.persistence=t,this.si=new Zn(n=>fl(n),dl),this.lastRemoteSnapshotVersion=nt.min(),this.highestTargetId=0,this.oi=0,this._i=new Tl,this.targetCount=0,this.ai=Sr.ur()}forEachTarget(t,n){return this.si.forEach((r,s)=>n(s)),O.resolve()}getLastRemoteSnapshotVersion(t){return O.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return O.resolve(this.oi)}allocateTargetId(t){return this.highestTargetId=this.ai.next(),O.resolve(this.highestTargetId)}setTargetsMetadata(t,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),O.resolve()}Pr(t){this.si.set(t.target,t);const n=t.targetId;n>this.highestTargetId&&(this.ai=new Sr(n),this.highestTargetId=n),t.sequenceNumber>this.oi&&(this.oi=t.sequenceNumber)}addTargetData(t,n){return this.Pr(n),this.targetCount+=1,O.resolve()}updateTargetData(t,n){return this.Pr(n),O.resolve()}removeTargetData(t,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,O.resolve()}removeTargets(t,n,r){let s=0;const i=[];return this.si.forEach((a,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.si.delete(a),i.push(this.removeMatchingKeysForTargetId(t,l.targetId)),s++)}),O.waitFor(i).next(()=>s)}getTargetCount(t){return O.resolve(this.targetCount)}getTargetData(t,n){const r=this.si.get(n)||null;return O.resolve(r)}addMatchingKeys(t,n,r){return this._i.Wr(n,r),O.resolve()}removeMatchingKeys(t,n,r){this._i.zr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(a=>{i.push(s.markPotentiallyOrphaned(t,a))}),O.waitFor(i)}removeMatchingKeysForTargetId(t,n){return this._i.jr(n),O.resolve()}getMatchingKeysForTargetId(t,n){const r=this._i.Hr(n);return O.resolve(r)}containsKey(t,n){return O.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xd{constructor(t,n){this.ui={},this.overlays={},this.ci=new lo(0),this.li=!1,this.li=!0,this.hi=new FT,this.referenceDelegate=t(this),this.Pi=new $T(this),this.indexManager=new RT,this.remoteDocumentCache=function(s){return new BT(s)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new AT(n),this.Ii=new kT(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let n=this.overlays[t.toKey()];return n||(n=new LT,this.overlays[t.toKey()]=n),n}getMutationQueue(t,n){let r=this.ui[t.toKey()];return r||(r=new UT(n,this.referenceDelegate),this.ui[t.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(t,n,r){K("MemoryPersistence","Starting transaction:",t);const s=new qT(this.ci.next());return this.referenceDelegate.Ei(),r(s).next(i=>this.referenceDelegate.di(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ai(t,n){return O.or(Object.values(this.ui).map(r=>()=>r.containsKey(t,n)))}}class qT extends _E{constructor(t){super(),this.currentSequenceNumber=t}}class vl{constructor(t){this.persistence=t,this.Ri=new Tl,this.Vi=null}static mi(t){return new vl(t)}get fi(){if(this.Vi)return this.Vi;throw tt(60996)}addReference(t,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),O.resolve()}removeReference(t,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),O.resolve()}markPotentiallyOrphaned(t,n){return this.fi.add(n.toString()),O.resolve()}removeTarget(t,n){this.Ri.jr(n.targetId).forEach(s=>this.fi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,n.targetId).next(s=>{s.forEach(i=>this.fi.add(i.toString()))}).next(()=>r.removeTargetData(t,n))}Ei(){this.Vi=new Set}di(t){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return O.forEach(this.fi,r=>{const s=Y.fromPath(r);return this.gi(t,s).next(i=>{i||n.removeEntry(s,nt.min())})}).next(()=>(this.Vi=null,n.apply(t)))}updateLimboDocument(t,n){return this.gi(t,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(t){return 0}gi(t,n){return O.or([()=>O.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(t,n),()=>this.persistence.Ai(t,n)])}}class Hi{constructor(t,n){this.persistence=t,this.pi=new Zn(r=>TE(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=xT(this,n)}static mi(t,n){return new Hi(t,n)}Ei(){}di(t){return O.resolve()}forEachTarget(t,n){return this.persistence.getTargetCache().forEachTarget(t,n)}gr(t){const n=this.wr(t);return this.persistence.getTargetCache().getTargetCount(t).next(r=>n.next(s=>r+s))}wr(t){let n=0;return this.pr(t,r=>{n++}).next(()=>n)}pr(t,n){return O.forEach(this.pi,(r,s)=>this.br(t,r,s).next(i=>i?O.resolve():n(s)))}removeTargets(t,n,r){return this.persistence.getTargetCache().removeTargets(t,n,r)}removeOrphanedDocuments(t,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(t,a=>this.br(t,a,n).next(l=>{l||(r++,i.removeEntry(a,nt.min()))})).next(()=>i.apply(t)).next(()=>r)}markPotentiallyOrphaned(t,n){return this.pi.set(n,t.currentSequenceNumber),O.resolve()}removeTarget(t,n){const r=n.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,r)}addReference(t,n,r){return this.pi.set(r,t.currentSequenceNumber),O.resolve()}removeReference(t,n,r){return this.pi.set(r,t.currentSequenceNumber),O.resolve()}updateLimboDocument(t,n){return this.pi.set(n,t.currentSequenceNumber),O.resolve()}Ti(t){let n=t.key.toString().length;return t.isFoundDocument()&&(n+=pi(t.data.value)),n}br(t,n,r){return O.or([()=>this.persistence.Ai(t,n),()=>this.persistence.getTargetCache().containsKey(t,n),()=>{const s=this.pi.get(n);return O.resolve(s!==void 0&&s>r)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wl{constructor(t,n,r,s){this.targetId=t,this.fromCache=n,this.Es=r,this.ds=s}static As(t,n){let r=ct(),s=ct();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new wl(t,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HT{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zT{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return F_()?8:yE(k_())>0?6:4}()}initialize(t,n){this.ps=t,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(t,n,r,s){const i={result:null};return this.ys(t,n).next(a=>{i.result=a}).next(()=>{if(!i.result)return this.ws(t,n,s,r).next(a=>{i.result=a})}).next(()=>{if(i.result)return;const a=new HT;return this.Ss(t,n,a).next(l=>{if(i.result=l,this.Vs)return this.bs(t,n,a,l.size)})}).next(()=>i.result)}bs(t,n,r,s){return r.documentReadCount<this.fs?(ur()<=ft.DEBUG&&K("QueryEngine","SDK will not create cache indexes for query:",hr(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),O.resolve()):(ur()<=ft.DEBUG&&K("QueryEngine","Query:",hr(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(ur()<=ft.DEBUG&&K("QueryEngine","The SDK decides to create cache indexes for query:",hr(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Be(n))):O.resolve())}ys(t,n){if(ju(n))return O.resolve(null);let r=Be(n);return this.indexManager.getIndexType(t,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=ba(n,null,"F"),r=Be(n)),this.indexManager.getDocumentsMatchingTarget(t,r).next(i=>{const a=ct(...i);return this.ps.getDocuments(t,a).next(l=>this.indexManager.getMinOffset(t,r).next(u=>{const f=this.Ds(n,l);return this.Cs(n,f,a,u.readTime)?this.ys(t,ba(n,null,"F")):this.vs(t,f,n,u)}))})))}ws(t,n,r,s){return ju(n)||s.isEqual(nt.min())?O.resolve(null):this.ps.getDocuments(t,r).next(i=>{const a=this.Ds(n,i);return this.Cs(n,a,r,s)?O.resolve(null):(ur()<=ft.DEBUG&&K("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),hr(n)),this.vs(t,a,n,dE(s,Rs)).next(l=>l))})}Ds(t,n){let r=new Lt(ud(t));return n.forEach((s,i)=>{fo(t,i)&&(r=r.add(i))}),r}Cs(t,n,r,s){if(t.limit===null)return!1;if(r.size!==n.size)return!0;const i=t.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(t,n,r){return ur()<=ft.DEBUG&&K("QueryEngine","Using full collection scan to execute query:",hr(n)),this.ps.getDocumentsMatchingQuery(t,n,bn.min(),r)}vs(t,n,r,s){return this.ps.getDocumentsMatchingQuery(t,r,s).next(i=>(n.forEach(a=>{i=i.insert(a.key,a)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Il="LocalStore",KT=3e8;class GT{constructor(t,n,r,s){this.persistence=t,this.Fs=n,this.serializer=s,this.Ms=new Ct(lt),this.xs=new Zn(i=>fl(i),dl),this.Os=new Map,this.Ns=t.getRemoteDocumentCache(),this.Pi=t.getTargetCache(),this.Ii=t.getBundleCache(),this.Bs(r)}Bs(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new MT(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>t.collect(n,this.Ms))}}function WT(e,t,n,r){return new GT(e,t,n,r)}async function Nd(e,t){const n=rt(e);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Bs(t),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const a=[],l=[];let u=ct();for(const f of s){a.push(f.batchId);for(const d of f.mutations)u=u.add(d.key)}for(const f of i){l.push(f.batchId);for(const d of f.mutations)u=u.add(d.key)}return n.localDocuments.getDocuments(r,u).next(f=>({Ls:f,removedBatchIds:a,addedBatchIds:l}))})})}function QT(e,t){const n=rt(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=t.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(l,u,f,d){const p=f.batch,g=p.keys();let v=O.resolve();return g.forEach(V=>{v=v.next(()=>d.getEntry(u,V)).next(P=>{const x=f.docVersions.get(V);_t(x!==null,48541),P.version.compareTo(x)<0&&(p.applyToRemoteDocument(P,f),P.isValidDocument()&&(P.setReadTime(f.commitVersion),d.addEntry(P)))})}),v.next(()=>l.mutationQueue.removeMutationBatch(u,p))}(n,r,t,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let u=ct();for(let f=0;f<l.mutationResults.length;++f)l.mutationResults[f].transformResults.length>0&&(u=u.add(l.batch.mutations[f].key));return u}(t))).next(()=>n.localDocuments.getDocuments(r,s))})}function Od(e){const t=rt(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",n=>t.Pi.getLastRemoteSnapshotVersion(n))}function YT(e,t){const n=rt(e),r=t.snapshotVersion;let s=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const a=n.Ns.newChangeBuffer({trackRemovals:!0});s=n.Ms;const l=[];t.targetChanges.forEach((d,p)=>{const g=s.get(p);if(!g)return;l.push(n.Pi.removeMatchingKeys(i,d.removedDocuments,p).next(()=>n.Pi.addMatchingKeys(i,d.addedDocuments,p)));let v=g.withSequenceNumber(i.currentSequenceNumber);t.targetMismatches.get(p)!==null?v=v.withResumeToken(Gt.EMPTY_BYTE_STRING,nt.min()).withLastLimboFreeSnapshotVersion(nt.min()):d.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(d.resumeToken,r)),s=s.insert(p,v),function(P,x,$){return P.resumeToken.approximateByteSize()===0||x.snapshotVersion.toMicroseconds()-P.snapshotVersion.toMicroseconds()>=KT?!0:$.addedDocuments.size+$.modifiedDocuments.size+$.removedDocuments.size>0}(g,v,d)&&l.push(n.Pi.updateTargetData(i,v))});let u=rn(),f=ct();if(t.documentUpdates.forEach(d=>{t.resolvedLimboDocuments.has(d)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,d))}),l.push(XT(i,a,t.documentUpdates).next(d=>{u=d.ks,f=d.qs})),!r.isEqual(nt.min())){const d=n.Pi.getLastRemoteSnapshotVersion(i).next(p=>n.Pi.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(d)}return O.waitFor(l).next(()=>a.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,u,f)).next(()=>u)}).then(i=>(n.Ms=s,i))}function XT(e,t,n){let r=ct(),s=ct();return n.forEach(i=>r=r.add(i)),t.getEntries(e,r).next(i=>{let a=rn();return n.forEach((l,u)=>{const f=i.get(l);u.isFoundDocument()!==f.isFoundDocument()&&(s=s.add(l)),u.isNoDocument()&&u.version.isEqual(nt.min())?(t.removeEntry(l,u.readTime),a=a.insert(l,u)):!f.isValidDocument()||u.version.compareTo(f.version)>0||u.version.compareTo(f.version)===0&&f.hasPendingWrites?(t.addEntry(u),a=a.insert(l,u)):K(Il,"Ignoring outdated watch update for ",l,". Current version:",f.version," Watch version:",u.version)}),{ks:a,qs:s}})}function JT(e,t){const n=rt(e);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(t===void 0&&(t=cl),n.mutationQueue.getNextMutationBatchAfterBatchId(r,t)))}function ZT(e,t){const n=rt(e);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Pi.getTargetData(r,t).next(i=>i?(s=i,O.resolve(s)):n.Pi.allocateTargetId(r).next(a=>(s=new mn(t,a,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(t,r.targetId)),r})}async function Va(e,t,n){const r=rt(e),s=r.Ms.get(t),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,a=>r.persistence.referenceDelegate.removeTarget(a,s))}catch(a){if(!xr(a))throw a;K(Il,`Failed to update sequence numbers for target ${t}: ${a}`)}r.Ms=r.Ms.remove(t),r.xs.delete(s.target)}function th(e,t,n){const r=rt(e);let s=nt.min(),i=ct();return r.persistence.runTransaction("Execute query","readwrite",a=>function(u,f,d){const p=rt(u),g=p.xs.get(d);return g!==void 0?O.resolve(p.Ms.get(g)):p.Pi.getTargetData(f,d)}(r,a,Be(t)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(a,l.targetId).next(u=>{i=u})}).next(()=>r.Fs.getDocumentsMatchingQuery(a,t,n?s:nt.min(),n?i:ct())).next(l=>(tv(r,UE(t),l),{documents:l,Qs:i})))}function tv(e,t,n){let r=e.Os.get(t)||nt.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),e.Os.set(t,r)}class eh{constructor(){this.activeTargetIds=zE()}zs(t){this.activeTargetIds=this.activeTargetIds.add(t)}js(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Gs(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class ev{constructor(){this.Mo=new eh,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,n,r){}addLocalQueryTarget(t,n=!0){return n&&this.Mo.zs(t),this.xo[t]||"not-current"}updateQueryState(t,n,r){this.xo[t]=n}removeLocalQueryTarget(t){this.Mo.js(t)}isLocalQueryTarget(t){return this.Mo.activeTargetIds.has(t)}clearQueryState(t){delete this.xo[t]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(t){return this.Mo.activeTargetIds.has(t)}start(){return this.Mo=new eh,Promise.resolve()}handleUserChange(t,n,r){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nv{Oo(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nh="ConnectivityMonitor";class rh{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(t){this.qo.push(t)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){K(nh,"Network connectivity changed: AVAILABLE");for(const t of this.qo)t(0)}ko(){K(nh,"Network connectivity changed: UNAVAILABLE");for(const t of this.qo)t(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ai=null;function Da(){return ai===null?ai=function(){return 268435456+Math.round(2147483648*Math.random())}():ai++,"0x"+ai.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zo="RestConnection",rv={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class sv{get $o(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const n=t.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+t.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===Li?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(t,n,r,s,i){const a=Da(),l=this.zo(t,n.toUriEncodedString());K(Zo,`Sending RPC '${t}' ${a}:`,l,r);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,s,i);const{host:f}=new URL(l),d=il(f);return this.Jo(t,l,u,r,d).then(p=>(K(Zo,`Received RPC '${t}' ${a}: `,p),p),p=>{throw Ir(Zo,`RPC '${t}' ${a} failed with error: `,p,"url: ",l,"request:",r),p})}Ho(t,n,r,s,i,a){return this.Go(t,n,r,s,i)}jo(t,n,r){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Vr}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>t[i]=s),r&&r.headers.forEach((s,i)=>t[i]=s)}zo(t,n){const r=rv[t];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iv{constructor(t){this.Yo=t.Yo,this.Zo=t.Zo}Xo(t){this.e_=t}t_(t){this.n_=t}r_(t){this.i_=t}onMessage(t){this.s_=t}close(){this.Zo()}send(t){this.Yo(t)}o_(){this.e_()}__(){this.n_()}a_(t){this.i_(t)}u_(t){this.s_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yt="WebChannelConnection";class ov extends sv{constructor(t){super(t),this.c_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Jo(t,n,r,s,i){const a=Da();return new Promise((l,u)=>{const f=new Lf;f.setWithCredentials(!0),f.listenOnce(Ff.COMPLETE,()=>{try{switch(f.getLastErrorCode()){case di.NO_ERROR:const p=f.getResponseJson();K(Yt,`XHR for RPC '${t}' ${a} received:`,JSON.stringify(p)),l(p);break;case di.TIMEOUT:K(Yt,`RPC '${t}' ${a} timed out`),u(new z(N.DEADLINE_EXCEEDED,"Request time out"));break;case di.HTTP_ERROR:const g=f.getStatus();if(K(Yt,`RPC '${t}' ${a} failed with status:`,g,"response text:",f.getResponseText()),g>0){let v=f.getResponseJson();Array.isArray(v)&&(v=v[0]);const V=v==null?void 0:v.error;if(V&&V.status&&V.message){const P=function($){const W=$.toLowerCase().replace(/_/g,"-");return Object.values(N).indexOf(W)>=0?W:N.UNKNOWN}(V.status);u(new z(P,V.message))}else u(new z(N.UNKNOWN,"Server responded with status "+f.getStatus()))}else u(new z(N.UNAVAILABLE,"Connection failed."));break;default:tt(9055,{l_:t,streamId:a,h_:f.getLastErrorCode(),P_:f.getLastError()})}}finally{K(Yt,`RPC '${t}' ${a} completed.`)}});const d=JSON.stringify(s);K(Yt,`RPC '${t}' ${a} sending request:`,s),f.send(n,"POST",d,r,15)})}T_(t,n,r){const s=Da(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",t,"/channel"],a=jf(),l=Bf(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},f=this.longPollingOptions.timeoutSeconds;f!==void 0&&(u.longPollingTimeout=Math.round(1e3*f)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const d=i.join("");K(Yt,`Creating RPC '${t}' stream ${s}: ${d}`,u);const p=a.createWebChannel(d,u);this.I_(p);let g=!1,v=!1;const V=new iv({Yo:x=>{v?K(Yt,`Not sending because RPC '${t}' stream ${s} is closed:`,x):(g||(K(Yt,`Opening RPC '${t}' stream ${s} transport.`),p.open(),g=!0),K(Yt,`RPC '${t}' stream ${s} sending:`,x),p.send(x))},Zo:()=>p.close()}),P=(x,$,W)=>{x.listen($,Q=>{try{W(Q)}catch(G){setTimeout(()=>{throw G},0)}})};return P(p,rs.EventType.OPEN,()=>{v||(K(Yt,`RPC '${t}' stream ${s} transport opened.`),V.o_())}),P(p,rs.EventType.CLOSE,()=>{v||(v=!0,K(Yt,`RPC '${t}' stream ${s} transport closed`),V.a_(),this.E_(p))}),P(p,rs.EventType.ERROR,x=>{v||(v=!0,Ir(Yt,`RPC '${t}' stream ${s} transport errored. Name:`,x.name,"Message:",x.message),V.a_(new z(N.UNAVAILABLE,"The operation could not be completed")))}),P(p,rs.EventType.MESSAGE,x=>{var $;if(!v){const W=x.data[0];_t(!!W,16349);const Q=W,G=(Q==null?void 0:Q.error)||(($=Q[0])==null?void 0:$.error);if(G){K(Yt,`RPC '${t}' stream ${s} received error:`,G);const ut=G.status;let yt=function(T){const A=Dt[T];if(A!==void 0)return vd(A)}(ut),I=G.message;yt===void 0&&(yt=N.INTERNAL,I="Unknown error status: "+ut+" with message "+G.message),v=!0,V.a_(new z(yt,I)),p.close()}else K(Yt,`RPC '${t}' stream ${s} received:`,W),V.u_(W)}}),P(l,Uf.STAT_EVENT,x=>{x.stat===ya.PROXY?K(Yt,`RPC '${t}' stream ${s} detected buffering proxy`):x.stat===ya.NOPROXY&&K(Yt,`RPC '${t}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{V.__()},0),V}terminate(){this.c_.forEach(t=>t.close()),this.c_=[]}I_(t){this.c_.push(t)}E_(t){this.c_=this.c_.filter(n=>n===t)}}function ta(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _o(e){return new uT(e,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Md{constructor(t,n,r=1e3,s=1.5,i=6e4){this.Mi=t,this.timerId=n,this.d_=r,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(t){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,n-r);s>0&&K("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),t())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sh="PersistentStream";class kd{constructor(t,n,r,s,i,a,l,u){this.Mi=t,this.S_=r,this.b_=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Md(t,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(t){this.Q_(),this.stream.send(t)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(t,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,t!==4?this.M_.reset():n&&n.code===N.RESOURCE_EXHAUSTED?(nn(n.toString()),nn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===N.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.r_(n)}K_(){}auth(){this.state=1;const t=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.D_===n&&this.G_(r,s)},r=>{t(()=>{const s=new z(N.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)})})}G_(t,n){const r=this.W_(this.D_);this.stream=this.j_(t,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(s=>{r(()=>this.z_(s))}),this.stream.onMessage(s=>{r(()=>++this.F_==1?this.J_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(t){return K(sh,`close with error: ${t}`),this.stream=null,this.close(4,t)}W_(t){return n=>{this.Mi.enqueueAndForget(()=>this.D_===t?n():(K(sh,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class av extends kd{constructor(t,n,r,s,i,a){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,a),this.serializer=i}j_(t,n){return this.connection.T_("Listen",t,n)}J_(t){return this.onNext(t)}onNext(t){this.M_.reset();const n=dT(this.serializer,t),r=function(i){if(!("targetChange"in i))return nt.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?nt.min():a.readTime?je(a.readTime):nt.min()}(t);return this.listener.H_(n,r)}Y_(t){const n={};n.database=Pa(this.serializer),n.addTarget=function(i,a){let l;const u=a.target;if(l=Ia(u)?{documents:gT(i,u)}:{query:_T(i,u).ft},l.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){l.resumeToken=Ad(i,a.resumeToken);const f=Ra(i,a.expectedCount);f!==null&&(l.expectedCount=f)}else if(a.snapshotVersion.compareTo(nt.min())>0){l.readTime=qi(i,a.snapshotVersion.toTimestamp());const f=Ra(i,a.expectedCount);f!==null&&(l.expectedCount=f)}return l}(this.serializer,t);const r=ET(this.serializer,t);r&&(n.labels=r),this.q_(n)}Z_(t){const n={};n.database=Pa(this.serializer),n.removeTarget=t,this.q_(n)}}class lv extends kd{constructor(t,n,r,s,i,a){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,a),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(t,n){return this.connection.T_("Write",t,n)}J_(t){return _t(!!t.streamToken,31322),this.lastStreamToken=t.streamToken,_t(!t.writeResults||t.writeResults.length===0,55816),this.listener.ta()}onNext(t){_t(!!t.streamToken,12678),this.lastStreamToken=t.streamToken,this.M_.reset();const n=mT(t.writeResults,t.commitTime),r=je(t.commitTime);return this.listener.na(r,n)}ra(){const t={};t.database=Pa(this.serializer),this.q_(t)}ea(t){const n={streamToken:this.lastStreamToken,writes:t.map(r=>pT(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cv{}class uv extends cv{constructor(t,n,r,s){super(),this.authCredentials=t,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new z(N.FAILED_PRECONDITION,"The client has already been terminated.")}Go(t,n,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.Go(t,Sa(n,r),s,i,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new z(N.UNKNOWN,i.toString())})}Ho(t,n,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,l])=>this.connection.Ho(t,Sa(n,r),s,a,l,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new z(N.UNKNOWN,a.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class hv{constructor(t,n){this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(t){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.ca("Offline")))}set(t){this.Pa(),this.oa=0,t==="Online"&&(this.aa=!1),this.ca(t)}ca(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}la(t){const n=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(nn(n),this.aa=!1):K("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yn="RemoteStore";class fv{constructor(t,n,r,s,i){this.localStore=t,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(a=>{r.enqueueAndForget(async()=>{tr(this)&&(K(Yn,"Restarting streams for network reachability change."),await async function(u){const f=rt(u);f.Ea.add(4),await Us(f),f.Ra.set("Unknown"),f.Ea.delete(4),await yo(f)}(this))})}),this.Ra=new hv(r,s)}}async function yo(e){if(tr(e))for(const t of e.da)await t(!0)}async function Us(e){for(const t of e.da)await t(!1)}function Ld(e,t){const n=rt(e);n.Ia.has(t.targetId)||(n.Ia.set(t.targetId,t),Sl(n)?Rl(n):Nr(n).O_()&&bl(n,t))}function Al(e,t){const n=rt(e),r=Nr(n);n.Ia.delete(t),r.O_()&&Fd(n,t),n.Ia.size===0&&(r.O_()?r.L_():tr(n)&&n.Ra.set("Unknown"))}function bl(e,t){if(e.Va.Ue(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(nt.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}Nr(e).Y_(t)}function Fd(e,t){e.Va.Ue(t),Nr(e).Z_(t)}function Rl(e){e.Va=new oT({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),At:t=>e.Ia.get(t)||null,ht:()=>e.datastore.serializer.databaseId}),Nr(e).start(),e.Ra.ua()}function Sl(e){return tr(e)&&!Nr(e).x_()&&e.Ia.size>0}function tr(e){return rt(e).Ea.size===0}function Ud(e){e.Va=void 0}async function dv(e){e.Ra.set("Online")}async function pv(e){e.Ia.forEach((t,n)=>{bl(e,t)})}async function mv(e,t){Ud(e),Sl(e)?(e.Ra.ha(t),Rl(e)):e.Ra.set("Unknown")}async function gv(e,t,n){if(e.Ra.set("Online"),t instanceof Id&&t.state===2&&t.cause)try{await async function(s,i){const a=i.cause;for(const l of i.targetIds)s.Ia.has(l)&&(await s.remoteSyncer.rejectListen(l,a),s.Ia.delete(l),s.Va.removeTarget(l))}(e,t)}catch(r){K(Yn,"Failed to remove targets %s: %s ",t.targetIds.join(","),r),await zi(e,r)}else if(t instanceof _i?e.Va.Ze(t):t instanceof wd?e.Va.st(t):e.Va.tt(t),!n.isEqual(nt.min()))try{const r=await Od(e.localStore);n.compareTo(r)>=0&&await function(i,a){const l=i.Va.Tt(a);return l.targetChanges.forEach((u,f)=>{if(u.resumeToken.approximateByteSize()>0){const d=i.Ia.get(f);d&&i.Ia.set(f,d.withResumeToken(u.resumeToken,a))}}),l.targetMismatches.forEach((u,f)=>{const d=i.Ia.get(u);if(!d)return;i.Ia.set(u,d.withResumeToken(Gt.EMPTY_BYTE_STRING,d.snapshotVersion)),Fd(i,u);const p=new mn(d.target,u,f,d.sequenceNumber);bl(i,p)}),i.remoteSyncer.applyRemoteEvent(l)}(e,n)}catch(r){K(Yn,"Failed to raise snapshot:",r),await zi(e,r)}}async function zi(e,t,n){if(!xr(t))throw t;e.Ea.add(1),await Us(e),e.Ra.set("Offline"),n||(n=()=>Od(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{K(Yn,"Retrying IndexedDB access"),await n(),e.Ea.delete(1),await yo(e)})}function Bd(e,t){return t().catch(n=>zi(e,n,t))}async function Eo(e){const t=rt(e),n=Pn(t);let r=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:cl;for(;_v(t);)try{const s=await JT(t.localStore,r);if(s===null){t.Ta.length===0&&n.L_();break}r=s.batchId,yv(t,s)}catch(s){await zi(t,s)}jd(t)&&$d(t)}function _v(e){return tr(e)&&e.Ta.length<10}function yv(e,t){e.Ta.push(t);const n=Pn(e);n.O_()&&n.X_&&n.ea(t.mutations)}function jd(e){return tr(e)&&!Pn(e).x_()&&e.Ta.length>0}function $d(e){Pn(e).start()}async function Ev(e){Pn(e).ra()}async function Tv(e){const t=Pn(e);for(const n of e.Ta)t.ea(n.mutations)}async function vv(e,t,n){const r=e.Ta.shift(),s=_l.from(r,t,n);await Bd(e,()=>e.remoteSyncer.applySuccessfulWrite(s)),await Eo(e)}async function wv(e,t){t&&Pn(e).X_&&await async function(r,s){if(function(a){return rT(a)&&a!==N.ABORTED}(s.code)){const i=r.Ta.shift();Pn(r).B_(),await Bd(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Eo(r)}}(e,t),jd(e)&&$d(e)}async function ih(e,t){const n=rt(e);n.asyncQueue.verifyOperationInProgress(),K(Yn,"RemoteStore received new credentials");const r=tr(n);n.Ea.add(3),await Us(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.Ea.delete(3),await yo(n)}async function Iv(e,t){const n=rt(e);t?(n.Ea.delete(2),await yo(n)):t||(n.Ea.add(2),await Us(n),n.Ra.set("Unknown"))}function Nr(e){return e.ma||(e.ma=function(n,r,s){const i=rt(n);return i.sa(),new av(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(e.datastore,e.asyncQueue,{Xo:dv.bind(null,e),t_:pv.bind(null,e),r_:mv.bind(null,e),H_:gv.bind(null,e)}),e.da.push(async t=>{t?(e.ma.B_(),Sl(e)?Rl(e):e.Ra.set("Unknown")):(await e.ma.stop(),Ud(e))})),e.ma}function Pn(e){return e.fa||(e.fa=function(n,r,s){const i=rt(n);return i.sa(),new lv(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(e.datastore,e.asyncQueue,{Xo:()=>Promise.resolve(),t_:Ev.bind(null,e),r_:wv.bind(null,e),ta:Tv.bind(null,e),na:vv.bind(null,e)}),e.da.push(async t=>{t?(e.fa.B_(),await Eo(e)):(await e.fa.stop(),e.Ta.length>0&&(K(Yn,`Stopping write stream with ${e.Ta.length} pending writes`),e.Ta=[]))})),e.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cl{constructor(t,n,r,s,i){this.asyncQueue=t,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Tn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,n,r,s,i){const a=Date.now()+r,l=new Cl(t,n,a,s,i);return l.start(r),l}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new z(N.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Pl(e,t){if(nn("AsyncQueue",`${t}: ${e}`),xr(e))return new z(N.UNAVAILABLE,`${t}: ${e}`);throw e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vr{static emptySet(t){return new vr(t.comparator)}constructor(t){this.comparator=t?(n,r)=>t(n,r)||Y.comparator(n.key,r.key):(n,r)=>Y.comparator(n.key,r.key),this.keyedMap=ss(),this.sortedSet=new Ct(this.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const n=this.keyedMap.get(t);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((n,r)=>(t(n),!1))}add(t){const n=this.delete(t.key);return n.copy(n.keyedMap.insert(t.key,t),n.sortedSet.insert(t,null))}delete(t){const n=this.get(t);return n?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(n)):this}isEqual(t){if(!(t instanceof vr)||this.size!==t.size)return!1;const n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const t=[];return this.forEach(n=>{t.push(n.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,n){const r=new vr;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oh{constructor(){this.ga=new Ct(Y.comparator)}track(t){const n=t.doc.key,r=this.ga.get(n);r?t.type!==0&&r.type===3?this.ga=this.ga.insert(n,t):t.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:t.doc}):t.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:t.doc}):t.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:t.doc}):t.type===1&&r.type===0?this.ga=this.ga.remove(n):t.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):t.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:t.doc}):tt(63341,{Rt:t,pa:r}):this.ga=this.ga.insert(n,t)}ya(){const t=[];return this.ga.inorderTraversal((n,r)=>{t.push(r)}),t}}class Cr{constructor(t,n,r,s,i,a,l,u,f){this.query=t,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=f}static fromInitialDocuments(t,n,r,s,i){const a=[];return n.forEach(l=>{a.push({type:0,doc:l})}),new Cr(t,n,vr.emptySet(n),a,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&ho(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const n=this.docChanges,r=t.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Av{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(t=>t.Da())}}class bv{constructor(){this.queries=ah(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const s=rt(n),i=s.queries;s.queries=ah(),i.forEach((a,l)=>{for(const u of l.Sa)u.onError(r)})})(this,new z(N.ABORTED,"Firestore shutting down"))}}function ah(){return new Zn(e=>cd(e),ho)}async function qd(e,t){const n=rt(e);let r=3;const s=t.query;let i=n.queries.get(s);i?!i.ba()&&t.Da()&&(r=2):(i=new Av,r=t.Da()?0:1);try{switch(r){case 0:i.wa=await n.onListen(s,!0);break;case 1:i.wa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(a){const l=Pl(a,`Initialization of query '${hr(t.query)}' failed`);return void t.onError(l)}n.queries.set(s,i),i.Sa.push(t),t.va(n.onlineState),i.wa&&t.Fa(i.wa)&&Vl(n)}async function Hd(e,t){const n=rt(e),r=t.query;let s=3;const i=n.queries.get(r);if(i){const a=i.Sa.indexOf(t);a>=0&&(i.Sa.splice(a,1),i.Sa.length===0?s=t.Da()?0:1:!i.ba()&&t.Da()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Rv(e,t){const n=rt(e);let r=!1;for(const s of t){const i=s.query,a=n.queries.get(i);if(a){for(const l of a.Sa)l.Fa(s)&&(r=!0);a.wa=s}}r&&Vl(n)}function Sv(e,t,n){const r=rt(e),s=r.queries.get(t);if(s)for(const i of s.Sa)i.onError(n);r.queries.delete(t)}function Vl(e){e.Ca.forEach(t=>{t.next()})}var xa,lh;(lh=xa||(xa={})).Ma="default",lh.Cache="cache";class zd{constructor(t,n,r){this.query=t,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(t){if(!this.options.includeMetadataChanges){const r=[];for(const s of t.docChanges)s.type!==3&&r.push(s);t=new Cr(t.query,t.docs,t.oldDocs,r,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let n=!1;return this.Oa?this.Ba(t)&&(this.xa.next(t),n=!0):this.La(t,this.onlineState)&&(this.ka(t),n=!0),this.Na=t,n}onError(t){this.xa.error(t)}va(t){this.onlineState=t;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,t)&&(this.ka(this.Na),n=!0),n}La(t,n){if(!t.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!t.docs.isEmpty()||t.hasCachedResults||n==="Offline")}Ba(t){if(t.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(t){t=Cr.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Oa=!0,this.xa.next(t)}Da(){return this.options.source!==xa.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kd{constructor(t){this.key=t}}class Gd{constructor(t){this.key=t}}class Cv{constructor(t,n){this.query=t,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=ct(),this.mutatedKeys=ct(),this.eu=ud(t),this.tu=new vr(this.eu)}get nu(){return this.Ya}ru(t,n){const r=n?n.iu:new oh,s=n?n.tu:this.tu;let i=n?n.mutatedKeys:this.mutatedKeys,a=s,l=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,f=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(t.inorderTraversal((d,p)=>{const g=s.get(d),v=fo(this.query,p)?p:null,V=!!g&&this.mutatedKeys.has(g.key),P=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations);let x=!1;g&&v?g.data.isEqual(v.data)?V!==P&&(r.track({type:3,doc:v}),x=!0):this.su(g,v)||(r.track({type:2,doc:v}),x=!0,(u&&this.eu(v,u)>0||f&&this.eu(v,f)<0)&&(l=!0)):!g&&v?(r.track({type:0,doc:v}),x=!0):g&&!v&&(r.track({type:1,doc:g}),x=!0,(u||f)&&(l=!0)),x&&(v?(a=a.add(v),i=P?i.add(d):i.delete(d)):(a=a.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const d=this.query.limitType==="F"?a.last():a.first();a=a.delete(d.key),i=i.delete(d.key),r.track({type:1,doc:d})}return{tu:a,iu:r,Cs:l,mutatedKeys:i}}su(t,n){return t.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(t,n,r,s){const i=this.tu;this.tu=t.tu,this.mutatedKeys=t.mutatedKeys;const a=t.iu.ya();a.sort((d,p)=>function(v,V){const P=x=>{switch(x){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return tt(20277,{Rt:x})}};return P(v)-P(V)}(d.type,p.type)||this.eu(d.doc,p.doc)),this.ou(r),s=s??!1;const l=n&&!s?this._u():[],u=this.Xa.size===0&&this.current&&!s?1:0,f=u!==this.Za;return this.Za=u,a.length!==0||f?{snapshot:new Cr(this.query,t.tu,i,a,t.mutatedKeys,u===0,f,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:l}:{au:l}}va(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new oh,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(t){return!this.Ya.has(t)&&!!this.tu.has(t)&&!this.tu.get(t).hasLocalMutations}ou(t){t&&(t.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),t.modifiedDocuments.forEach(n=>{}),t.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=t.current)}_u(){if(!this.current)return[];const t=this.Xa;this.Xa=ct(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return t.forEach(r=>{this.Xa.has(r)||n.push(new Gd(r))}),this.Xa.forEach(r=>{t.has(r)||n.push(new Kd(r))}),n}cu(t){this.Ya=t.Qs,this.Xa=ct();const n=this.ru(t.documents);return this.applyChanges(n,!0)}lu(){return Cr.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Dl="SyncEngine";class Pv{constructor(t,n,r){this.query=t,this.targetId=n,this.view=r}}class Vv{constructor(t){this.key=t,this.hu=!1}}class Dv{constructor(t,n,r,s,i,a){this.localStore=t,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new Zn(l=>cd(l),ho),this.Iu=new Map,this.Eu=new Set,this.du=new Ct(Y.comparator),this.Au=new Map,this.Ru=new Tl,this.Vu={},this.mu=new Map,this.fu=Sr.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function xv(e,t,n=!0){const r=Zd(e);let s;const i=r.Tu.get(t);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await Wd(r,t,n,!0),s}async function Nv(e,t){const n=Zd(e);await Wd(n,t,!0,!1)}async function Wd(e,t,n,r){const s=await ZT(e.localStore,Be(t)),i=s.targetId,a=e.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await Ov(e,t,i,a==="current",s.resumeToken)),e.isPrimaryClient&&n&&Ld(e.remoteStore,s),l}async function Ov(e,t,n,r,s){e.pu=(p,g,v)=>async function(P,x,$,W){let Q=x.view.ru($);Q.Cs&&(Q=await th(P.localStore,x.query,!1).then(({documents:I})=>x.view.ru(I,Q)));const G=W&&W.targetChanges.get(x.targetId),ut=W&&W.targetMismatches.get(x.targetId)!=null,yt=x.view.applyChanges(Q,P.isPrimaryClient,G,ut);return uh(P,x.targetId,yt.au),yt.snapshot}(e,p,g,v);const i=await th(e.localStore,t,!0),a=new Cv(t,i.Qs),l=a.ru(i.documents),u=Fs.createSynthesizedTargetChangeForCurrentChange(n,r&&e.onlineState!=="Offline",s),f=a.applyChanges(l,e.isPrimaryClient,u);uh(e,n,f.au);const d=new Pv(t,n,a);return e.Tu.set(t,d),e.Iu.has(n)?e.Iu.get(n).push(t):e.Iu.set(n,[t]),f.snapshot}async function Mv(e,t,n){const r=rt(e),s=r.Tu.get(t),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter(a=>!ho(a,t))),void r.Tu.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Va(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Al(r.remoteStore,s.targetId),Na(r,s.targetId)}).catch(Dr)):(Na(r,s.targetId),await Va(r.localStore,s.targetId,!0))}async function kv(e,t){const n=rt(e),r=n.Tu.get(t),s=n.Iu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Al(n.remoteStore,r.targetId))}async function Lv(e,t,n){const r=Hv(e);try{const s=await function(a,l){const u=rt(a),f=St.now(),d=l.reduce((v,V)=>v.add(V.key),ct());let p,g;return u.persistence.runTransaction("Locally write mutations","readwrite",v=>{let V=rn(),P=ct();return u.Ns.getEntries(v,d).next(x=>{V=x,V.forEach(($,W)=>{W.isValidDocument()||(P=P.add($))})}).next(()=>u.localDocuments.getOverlayedDocuments(v,V)).next(x=>{p=x;const $=[];for(const W of l){const Q=JE(W,p.get(W.key).overlayedDocument);Q!=null&&$.push(new xn(W.key,Q,ed(Q.value.mapValue),Ce.exists(!0)))}return u.mutationQueue.addMutationBatch(v,f,$,l)}).next(x=>{g=x;const $=x.applyToLocalDocumentSet(p,P);return u.documentOverlayCache.saveOverlays(v,x.batchId,$)})}).then(()=>({batchId:g.batchId,changes:fd(p)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(s.batchId),function(a,l,u){let f=a.Vu[a.currentUser.toKey()];f||(f=new Ct(lt)),f=f.insert(l,u),a.Vu[a.currentUser.toKey()]=f}(r,s.batchId,n),await Bs(r,s.changes),await Eo(r.remoteStore)}catch(s){const i=Pl(s,"Failed to persist write");n.reject(i)}}async function Qd(e,t){const n=rt(e);try{const r=await YT(n.localStore,t);t.targetChanges.forEach((s,i)=>{const a=n.Au.get(i);a&&(_t(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?a.hu=!0:s.modifiedDocuments.size>0?_t(a.hu,14607):s.removedDocuments.size>0&&(_t(a.hu,42227),a.hu=!1))}),await Bs(n,r,t)}catch(r){await Dr(r)}}function ch(e,t,n){const r=rt(e);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Tu.forEach((i,a)=>{const l=a.view.va(t);l.snapshot&&s.push(l.snapshot)}),function(a,l){const u=rt(a);u.onlineState=l;let f=!1;u.queries.forEach((d,p)=>{for(const g of p.Sa)g.va(l)&&(f=!0)}),f&&Vl(u)}(r.eventManager,t),s.length&&r.Pu.H_(s),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function Fv(e,t,n){const r=rt(e);r.sharedClientState.updateQueryState(t,"rejected",n);const s=r.Au.get(t),i=s&&s.key;if(i){let a=new Ct(Y.comparator);a=a.insert(i,Zt.newNoDocument(i,nt.min()));const l=ct().add(i),u=new go(nt.min(),new Map,new Ct(lt),a,l);await Qd(r,u),r.du=r.du.remove(i),r.Au.delete(t),xl(r)}else await Va(r.localStore,t,!1).then(()=>Na(r,t,n)).catch(Dr)}async function Uv(e,t){const n=rt(e),r=t.batch.batchId;try{const s=await QT(n.localStore,t);Xd(n,r,null),Yd(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Bs(n,s)}catch(s){await Dr(s)}}async function Bv(e,t,n){const r=rt(e);try{const s=await function(a,l){const u=rt(a);return u.persistence.runTransaction("Reject batch","readwrite-primary",f=>{let d;return u.mutationQueue.lookupMutationBatch(f,l).next(p=>(_t(p!==null,37113),d=p.keys(),u.mutationQueue.removeMutationBatch(f,p))).next(()=>u.mutationQueue.performConsistencyCheck(f)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(f,d,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(f,d)).next(()=>u.localDocuments.getDocuments(f,d))})}(r.localStore,t);Xd(r,t,n),Yd(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await Bs(r,s)}catch(s){await Dr(s)}}function Yd(e,t){(e.mu.get(t)||[]).forEach(n=>{n.resolve()}),e.mu.delete(t)}function Xd(e,t,n){const r=rt(e);let s=r.Vu[r.currentUser.toKey()];if(s){const i=s.get(t);i&&(n?i.reject(n):i.resolve(),s=s.remove(t)),r.Vu[r.currentUser.toKey()]=s}}function Na(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Iu.get(t))e.Tu.delete(r),n&&e.Pu.yu(r,n);e.Iu.delete(t),e.isPrimaryClient&&e.Ru.jr(t).forEach(r=>{e.Ru.containsKey(r)||Jd(e,r)})}function Jd(e,t){e.Eu.delete(t.path.canonicalString());const n=e.du.get(t);n!==null&&(Al(e.remoteStore,n),e.du=e.du.remove(t),e.Au.delete(n),xl(e))}function uh(e,t,n){for(const r of n)r instanceof Kd?(e.Ru.addReference(r.key,t),jv(e,r)):r instanceof Gd?(K(Dl,"Document no longer in limbo: "+r.key),e.Ru.removeReference(r.key,t),e.Ru.containsKey(r.key)||Jd(e,r.key)):tt(19791,{wu:r})}function jv(e,t){const n=t.key,r=n.path.canonicalString();e.du.get(n)||e.Eu.has(r)||(K(Dl,"New document in limbo: "+n),e.Eu.add(r),xl(e))}function xl(e){for(;e.Eu.size>0&&e.du.size<e.maxConcurrentLimboResolutions;){const t=e.Eu.values().next().value;e.Eu.delete(t);const n=new Y(It.fromString(t)),r=e.fu.next();e.Au.set(r,new Vv(n)),e.du=e.du.insert(n,r),Ld(e.remoteStore,new mn(Be(pl(n.path)),r,"TargetPurposeLimboResolution",lo.ce))}}async function Bs(e,t,n){const r=rt(e),s=[],i=[],a=[];r.Tu.isEmpty()||(r.Tu.forEach((l,u)=>{a.push(r.pu(u,t,n).then(f=>{var d;if((f||n)&&r.isPrimaryClient){const p=f?!f.fromCache:(d=n==null?void 0:n.targetChanges.get(u.targetId))==null?void 0:d.current;r.sharedClientState.updateQueryState(u.targetId,p?"current":"not-current")}if(f){s.push(f);const p=wl.As(u.targetId,f);i.push(p)}}))}),await Promise.all(a),r.Pu.H_(s),await async function(u,f){const d=rt(u);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>O.forEach(f,g=>O.forEach(g.Es,v=>d.persistence.referenceDelegate.addReference(p,g.targetId,v)).next(()=>O.forEach(g.ds,v=>d.persistence.referenceDelegate.removeReference(p,g.targetId,v)))))}catch(p){if(!xr(p))throw p;K(Il,"Failed to update sequence numbers: "+p)}for(const p of f){const g=p.targetId;if(!p.fromCache){const v=d.Ms.get(g),V=v.snapshotVersion,P=v.withLastLimboFreeSnapshotVersion(V);d.Ms=d.Ms.insert(g,P)}}}(r.localStore,i))}async function $v(e,t){const n=rt(e);if(!n.currentUser.isEqual(t)){K(Dl,"User change. New user:",t.toKey());const r=await Nd(n.localStore,t);n.currentUser=t,function(i,a){i.mu.forEach(l=>{l.forEach(u=>{u.reject(new z(N.CANCELLED,a))})}),i.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,r.removedBatchIds,r.addedBatchIds),await Bs(n,r.Ls)}}function qv(e,t){const n=rt(e),r=n.Au.get(t);if(r&&r.hu)return ct().add(r.key);{let s=ct();const i=n.Iu.get(t);if(!i)return s;for(const a of i){const l=n.Tu.get(a);s=s.unionWith(l.view.nu)}return s}}function Zd(e){const t=rt(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Qd.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=qv.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Fv.bind(null,t),t.Pu.H_=Rv.bind(null,t.eventManager),t.Pu.yu=Sv.bind(null,t.eventManager),t}function Hv(e){const t=rt(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Uv.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Bv.bind(null,t),t}class Ki{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=_o(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)}Fu(t,n){return null}Mu(t,n){return null}vu(t){return WT(this.persistence,new zT,t.initialUser,this.serializer)}Cu(t){return new xd(vl.mi,this.serializer)}Du(t){return new ev}async terminate(){var t,n;(t=this.gcScheduler)==null||t.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ki.provider={build:()=>new Ki};class zv extends Ki{constructor(t){super(),this.cacheSizeBytes=t}Fu(t,n){_t(this.persistence.referenceDelegate instanceof Hi,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new VT(r,t.asyncQueue,n)}Cu(t){const n=this.cacheSizeBytes!==void 0?le.withCacheSize(this.cacheSizeBytes):le.DEFAULT;return new xd(r=>Hi.mi(r,n),this.serializer)}}class Oa{async initialize(t,n){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>ch(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=$v.bind(null,this.syncEngine),await Iv(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new bv}()}createDatastore(t){const n=_o(t.databaseInfo.databaseId),r=function(i){return new ov(i)}(t.databaseInfo);return function(i,a,l,u){return new uv(i,a,l,u)}(t.authCredentials,t.appCheckCredentials,r,n)}createRemoteStore(t){return function(r,s,i,a,l){return new fv(r,s,i,a,l)}(this.localStore,this.datastore,t.asyncQueue,n=>ch(this.syncEngine,n,0),function(){return rh.v()?new rh:new nv}())}createSyncEngine(t,n){return function(s,i,a,l,u,f,d){const p=new Dv(s,i,a,l,u,f);return d&&(p.gu=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,n)}async terminate(){var t,n;await async function(s){const i=rt(s);K(Yn,"RemoteStore shutting down."),i.Ea.add(5),await Us(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(t=this.datastore)==null||t.terminate(),(n=this.eventManager)==null||n.terminate()}}Oa.provider={build:()=>new Oa};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tp{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.Ou(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.Ou(this.observer.error,t):nn("Uncaught Error in snapshot listener:",t.toString()))}Nu(){this.muted=!0}Ou(t,n){setTimeout(()=>{this.muted||t(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vn="FirestoreClient";class Kv{constructor(t,n,r,s,i){this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Xt.UNAUTHENTICATED,this.clientId=ll.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async a=>{K(Vn,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(r,a=>(K(Vn,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new Tn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(n){const r=Pl(n,"Failed to shutdown persistence");t.reject(r)}}),t.promise}}async function ea(e,t){e.asyncQueue.verifyOperationInProgress(),K(Vn,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async s=>{r.isEqual(s)||(await Nd(t.localStore,s),r=s)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function hh(e,t){e.asyncQueue.verifyOperationInProgress();const n=await Gv(e);K(Vn,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(r=>ih(t.remoteStore,r)),e.setAppCheckTokenChangeListener((r,s)=>ih(t.remoteStore,s)),e._onlineComponents=t}async function Gv(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){K(Vn,"Using user provided OfflineComponentProvider");try{await ea(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(s){return s.name==="FirebaseError"?s.code===N.FAILED_PRECONDITION||s.code===N.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;Ir("Error using user provided cache. Falling back to memory cache: "+n),await ea(e,new Ki)}}else K(Vn,"Using default OfflineComponentProvider"),await ea(e,new zv(void 0));return e._offlineComponents}async function ep(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(K(Vn,"Using user provided OnlineComponentProvider"),await hh(e,e._uninitializedComponentsProvider._online)):(K(Vn,"Using default OnlineComponentProvider"),await hh(e,new Oa))),e._onlineComponents}function Wv(e){return ep(e).then(t=>t.syncEngine)}async function Ma(e){const t=await ep(e),n=t.eventManager;return n.onListen=xv.bind(null,t.syncEngine),n.onUnlisten=Mv.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=Nv.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=kv.bind(null,t.syncEngine),n}function Qv(e,t,n={}){const r=new Tn;return e.asyncQueue.enqueueAndForget(async()=>function(i,a,l,u,f){const d=new tp({next:g=>{d.Nu(),a.enqueueAndForget(()=>Hd(i,p)),g.fromCache&&u.source==="server"?f.reject(new z(N.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):f.resolve(g)},error:g=>f.reject(g)}),p=new zd(l,d,{includeMetadataChanges:!0,qa:!0});return qd(i,p)}(await Ma(e),e.asyncQueue,t,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function np(e){const t={};return e.timeoutSeconds!==void 0&&(t.timeoutSeconds=e.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fh=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rp="firestore.googleapis.com",dh=!0;class ph{constructor(t){if(t.host===void 0){if(t.ssl!==void 0)throw new z(N.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=rp,this.ssl=dh}else this.host=t.host,this.ssl=t.ssl??dh;if(this.isUsingEmulator=t.emulatorOptions!==void 0,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=Dd;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<CT)throw new z(N.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}fE("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=np(t.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new z(N.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new z(N.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new z(N.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class To{constructor(t,n,r,s){this._authCredentials=t,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ph({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new z(N.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new z(N.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ph(t),this._emulatorOptions=t.emulatorOptions||{},t.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new nE;switch(r.type){case"firstParty":return new oE(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new z(N.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=fh.get(n);r&&(K("ComponentProvider","Removing Datastore"),fh.delete(n),r.terminate())}(this),Promise.resolve()}}function Yv(e,t,n,r={}){var f;e=Ue(e,To);const s=il(t),i=e._getSettings(),a={...i,emulatorOptions:e._getEmulatorOptions()},l=`${t}:${n}`;s&&(D_(`https://${l}`),M_("Firestore",!0)),i.host!==rp&&i.host!==l&&Ir("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...i,host:l,ssl:s,emulatorOptions:r};if(!Ni(u,a)&&(e._setSettings(u),r.mockUserToken)){let d,p;if(typeof r.mockUserToken=="string")d=r.mockUserToken,p=Xt.MOCK_USER;else{d=x_(r.mockUserToken,(f=e._app)==null?void 0:f.options.projectId);const g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new z(N.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new Xt(g)}e._authCredentials=new rE(new qf(d,p))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class er{constructor(t,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=t}withConverter(t){return new er(this.firestore,t,this._query)}}class Ot{constructor(t,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new vn(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Ot(this.firestore,t,this._key)}toJSON(){return{type:Ot._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,n,r){if(Ms(n,Ot._jsonSchema))return new Ot(t,r||null,new Y(It.fromString(n.referencePath)))}}Ot._jsonSchemaVersion="firestore/documentReference/1.0",Ot._jsonSchema={type:Nt("string",Ot._jsonSchemaVersion),referencePath:Nt("string")};class vn extends er{constructor(t,n,r){super(t,n,pl(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Ot(this.firestore,null,new Y(t))}withConverter(t){return new vn(this.firestore,t,this._path)}}function sp(e,t,...n){if(e=Ke(e),Hf("collection","path",t),e instanceof To){const r=It.fromString(t,...n);return Su(r),new vn(e,null,r)}{if(!(e instanceof Ot||e instanceof vn))throw new z(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(It.fromString(t,...n));return Su(r),new vn(e.firestore,null,r)}}function ka(e,t,...n){if(e=Ke(e),arguments.length===1&&(t=ll.newId()),Hf("doc","path",t),e instanceof To){const r=It.fromString(t,...n);return Ru(r),new Ot(e,null,new Y(r))}{if(!(e instanceof Ot||e instanceof vn))throw new z(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(It.fromString(t,...n));return Ru(r),new Ot(e.firestore,e instanceof vn?e.converter:null,new Y(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mh="AsyncQueue";class gh{constructor(t=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Md(this,"async_queue_retry"),this._c=()=>{const r=ta();r&&K(mh,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=t;const n=ta();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.uc(),this.cc(t)}enterRestrictedMode(t){if(!this.ec){this.ec=!0,this.sc=t||!1;const n=ta();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(t){if(this.uc(),this.ec)return new Promise(()=>{});const n=new Tn;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(t().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Xu.push(t),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(t){if(!xr(t))throw t;K(mh,"Operation failed with retryable error: "+t)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(t){const n=this.ac.then(()=>(this.rc=!0,t().catch(r=>{throw this.nc=r,this.rc=!1,nn("INTERNAL UNHANDLED ERROR: ",_h(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(t,n,r){this.uc(),this.oc.indexOf(t)>-1&&(n=0);const s=Cl.createAndSchedule(this,t,n,r,i=>this.hc(i));return this.tc.push(s),s}uc(){this.nc&&tt(47125,{Pc:_h(this.nc)})}verifyOperationInProgress(){}async Tc(){let t;do t=this.ac,await t;while(t!==this.ac)}Ic(t){for(const n of this.tc)if(n.timerId===t)return!0;return!1}Ec(t){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),t!=="all"&&n.timerId===t)break;return this.Tc()})}dc(t){this.oc.push(t)}hc(t){const n=this.tc.indexOf(t);this.tc.splice(n,1)}}function _h(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+`
`+e.stack),t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yh(e){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(e,["next","error","complete"])}class Xn extends To{constructor(t,n,r,s){super(t,n,r,s),this.type="firestore",this._queue=new gh,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new gh(t),this._firestoreClient=void 0,await t}}}function Xv(e,t){const n=typeof e=="object"?e:zy(),r=typeof e=="string"?e:Li,s=By(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=P_("firestore");i&&Yv(s,...i)}return s}function Nl(e){if(e._terminated)throw new z(N.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||Jv(e),e._firestoreClient}function Jv(e){var r,s,i;const t=e._freezeSettings(),n=function(l,u,f,d){return new IE(l,u,f,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,np(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)}(e._databaseId,((r=e._app)==null?void 0:r.options.appId)||"",e._persistenceKey,t);e._componentsProvider||(s=t.localCache)!=null&&s._offlineComponentProvider&&((i=t.localCache)!=null&&i._onlineComponentProvider)&&(e._componentsProvider={_offline:t.localCache._offlineComponentProvider,_online:t.localCache._onlineComponentProvider}),e._firestoreClient=new Kv(e._authCredentials,e._appCheckCredentials,e._queue,n,e._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(e._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ee{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Ee(Gt.fromBase64String(t))}catch(n){throw new z(N.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(t){return new Ee(Gt.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}toJSON(){return{type:Ee._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if(Ms(t,Ee._jsonSchema))return Ee.fromBase64String(t.bytes)}}Ee._jsonSchemaVersion="firestore/bytes/1.0",Ee._jsonSchema={type:Nt("string",Ee._jsonSchemaVersion),bytes:Nt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vo{constructor(...t){for(let n=0;n<t.length;++n)if(t[n].length===0)throw new z(N.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Kt(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ol{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $e{constructor(t,n){if(!isFinite(t)||t<-90||t>90)throw new z(N.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new z(N.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}_compareTo(t){return lt(this._lat,t._lat)||lt(this._long,t._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:$e._jsonSchemaVersion}}static fromJSON(t){if(Ms(t,$e._jsonSchema))return new $e(t.latitude,t.longitude)}}$e._jsonSchemaVersion="firestore/geoPoint/1.0",$e._jsonSchema={type:Nt("string",$e._jsonSchemaVersion),latitude:Nt("number"),longitude:Nt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qe{constructor(t){this._values=(t||[]).map(n=>n)}toArray(){return this._values.map(t=>t)}isEqual(t){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,t._values)}toJSON(){return{type:qe._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if(Ms(t,qe._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every(n=>typeof n=="number"))return new qe(t.vectorValues);throw new z(N.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}qe._jsonSchemaVersion="firestore/vectorValue/1.0",qe._jsonSchema={type:Nt("string",qe._jsonSchemaVersion),vectorValues:Nt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zv=/^__.*__$/;class tw{constructor(t,n,r){this.data=t,this.fieldMask=n,this.fieldTransforms=r}toMutation(t,n){return this.fieldMask!==null?new xn(t,this.data,this.fieldMask,n,this.fieldTransforms):new Ls(t,this.data,n,this.fieldTransforms)}}class ip{constructor(t,n,r){this.data=t,this.fieldMask=n,this.fieldTransforms=r}toMutation(t,n){return new xn(t,this.data,this.fieldMask,n,this.fieldTransforms)}}function op(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw tt(40011,{Ac:e})}}class Ml{constructor(t,n,r,s,i,a){this.settings=t,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(t){return new Ml({...this.settings,...t},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(t){var s;const n=(s=this.path)==null?void 0:s.child(t),r=this.Vc({path:n,fc:!1});return r.gc(t),r}yc(t){var s;const n=(s=this.path)==null?void 0:s.child(t),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(t){return this.Vc({path:void 0,fc:!0})}Sc(t){return Gi(t,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(t){return this.fieldMask.find(n=>t.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>t.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let t=0;t<this.path.length;t++)this.gc(this.path.get(t))}gc(t){if(t.length===0)throw this.Sc("Document fields must not be empty");if(op(this.Ac)&&Zv.test(t))throw this.Sc('Document fields cannot begin and end with "__"')}}class ew{constructor(t,n,r){this.databaseId=t,this.ignoreUndefinedProperties=n,this.serializer=r||_o(t)}Cc(t,n,r,s=!1){return new Ml({Ac:t,methodName:n,Dc:r,path:Kt.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function kl(e){const t=e._freezeSettings(),n=_o(e._databaseId);return new ew(e._databaseId,!!t.ignoreUndefinedProperties,n)}function nw(e,t,n,r,s,i={}){const a=e.Cc(i.merge||i.mergeFields?2:0,t,n,s);Ll("Data must be an object, but it was:",a,r);const l=ap(r,a);let u,f;if(i.merge)u=new ge(a.fieldMask),f=a.fieldTransforms;else if(i.mergeFields){const d=[];for(const p of i.mergeFields){const g=La(t,p,n);if(!a.contains(g))throw new z(N.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);cp(d,g)||d.push(g)}u=new ge(d),f=a.fieldTransforms.filter(p=>u.covers(p.field))}else u=null,f=a.fieldTransforms;return new tw(new ce(l),u,f)}class wo extends Ol{_toFieldTransform(t){if(t.Ac!==2)throw t.Ac===1?t.Sc(`${this._methodName}() can only appear at the top level of your update data`):t.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof wo}}function rw(e,t,n,r){const s=e.Cc(1,t,n);Ll("Data must be an object, but it was:",s,r);const i=[],a=ce.empty();Dn(r,(u,f)=>{const d=Fl(t,u,n);f=Ke(f);const p=s.yc(d);if(f instanceof wo)i.push(d);else{const g=js(f,p);g!=null&&(i.push(d),a.set(d,g))}});const l=new ge(i);return new ip(a,l,s.fieldTransforms)}function sw(e,t,n,r,s,i){const a=e.Cc(1,t,n),l=[La(t,r,n)],u=[s];if(i.length%2!=0)throw new z(N.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<i.length;g+=2)l.push(La(t,i[g])),u.push(i[g+1]);const f=[],d=ce.empty();for(let g=l.length-1;g>=0;--g)if(!cp(f,l[g])){const v=l[g];let V=u[g];V=Ke(V);const P=a.yc(v);if(V instanceof wo)f.push(v);else{const x=js(V,P);x!=null&&(f.push(v),d.set(v,x))}}const p=new ge(f);return new ip(d,p,a.fieldTransforms)}function iw(e,t,n,r=!1){return js(n,e.Cc(r?4:3,t))}function js(e,t){if(lp(e=Ke(e)))return Ll("Unsupported field value:",t,e),ap(e,t);if(e instanceof Ol)return function(r,s){if(!op(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.fc&&t.Ac!==4)throw t.Sc("Nested arrays are not supported");return function(r,s){const i=[];let a=0;for(const l of r){let u=js(l,s.wc(a));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),a++}return{arrayValue:{values:i}}}(e,t)}return function(r,s){if((r=Ke(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return KE(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=St.fromDate(r);return{timestampValue:qi(s.serializer,i)}}if(r instanceof St){const i=new St(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:qi(s.serializer,i)}}if(r instanceof $e)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ee)return{bytesValue:Ad(s.serializer,r._byteString)};if(r instanceof Ot){const i=s.databaseId,a=r.firestore._databaseId;if(!a.isEqual(i))throw s.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:El(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof qe)return function(a,l){return{mapValue:{fields:{[Zf]:{stringValue:td},[Fi]:{arrayValue:{values:a.toArray().map(f=>{if(typeof f!="number")throw l.Sc("VectorValues must only contain numeric values.");return ml(l.serializer,f)})}}}}}}(r,s);throw s.Sc(`Unsupported field value: ${ao(r)}`)}(e,t)}function ap(e,t){const n={};return Gf(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Dn(e,(r,s)=>{const i=js(s,t.mc(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function lp(e){return!(typeof e!="object"||e===null||e instanceof Array||e instanceof Date||e instanceof St||e instanceof $e||e instanceof Ee||e instanceof Ot||e instanceof Ol||e instanceof qe)}function Ll(e,t,n){if(!lp(n)||!zf(n)){const r=ao(n);throw r==="an object"?t.Sc(e+" a custom object"):t.Sc(e+" "+r)}}function La(e,t,n){if((t=Ke(t))instanceof vo)return t._internalPath;if(typeof t=="string")return Fl(e,t);throw Gi("Field path arguments must be of type string or ",e,!1,void 0,n)}const ow=new RegExp("[~\\*/\\[\\]]");function Fl(e,t,n){if(t.search(ow)>=0)throw Gi(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new vo(...t.split("."))._internalPath}catch{throw Gi(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function Gi(e,t,n,r,s){const i=r&&!r.isEmpty(),a=s!==void 0;let l=`Function ${t}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(i||a)&&(u+=" (found",i&&(u+=` in field ${r}`),a&&(u+=` in document ${s}`),u+=")"),new z(N.INVALID_ARGUMENT,l+e+u)}function cp(e,t){return e.some(n=>n.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class up{constructor(t,n,r,s,i){this._firestore=t,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Ot(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new aw(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const n=this._document.data.field(hp("DocumentSnapshot.get",t));if(n!==null)return this._userDataWriter.convertValue(n)}}}class aw extends up{data(){return super.data()}}function hp(e,t){return typeof t=="string"?Fl(e,t):t instanceof vo?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fp(e){if(e.limitType==="L"&&e.explicitOrderBy.length===0)throw new z(N.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Ul{}class lw extends Ul{}function cw(e,t,...n){let r=[];t instanceof Ul&&r.push(t),r=r.concat(n),function(i){const a=i.filter(u=>u instanceof jl).length,l=i.filter(u=>u instanceof Bl).length;if(a>1||a>0&&l>0)throw new z(N.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)e=s._apply(e);return e}class Bl extends lw{constructor(t,n,r){super(),this._field=t,this._op=n,this._value=r,this.type="where"}static _create(t,n,r){return new Bl(t,n,r)}_apply(t){const n=this._parse(t);return dp(t._query,n),new er(t.firestore,t.converter,Aa(t._query,n))}_parse(t){const n=kl(t.firestore);return function(i,a,l,u,f,d,p){let g;if(f.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new z(N.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){Th(p,d);const V=[];for(const P of p)V.push(Eh(u,i,P));g={arrayValue:{values:V}}}else g=Eh(u,i,p)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||Th(p,d),g=iw(l,a,p,d==="in"||d==="not-in");return xt.create(f,d,g)}(t._query,"where",n,t.firestore._databaseId,this._field,this._op,this._value)}}class jl extends Ul{constructor(t,n){super(),this.type=t,this._queryConstraints=n}static _create(t,n){return new jl(t,n)}_parse(t){const n=this._queryConstraints.map(r=>r._parse(t)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Pe.create(n,this._getOperator())}_apply(t){const n=this._parse(t);return n.getFilters().length===0?t:(function(s,i){let a=s;const l=i.getFlattenedFilters();for(const u of l)dp(a,u),a=Aa(a,u)}(t._query,n),new er(t.firestore,t.converter,Aa(t._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Eh(e,t,n){if(typeof(n=Ke(n))=="string"){if(n==="")throw new z(N.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!ld(t)&&n.indexOf("/")!==-1)throw new z(N.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(It.fromString(n));if(!Y.isDocumentKey(r))throw new z(N.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Mu(e,new Y(r))}if(n instanceof Ot)return Mu(e,n._key);throw new z(N.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ao(n)}.`)}function Th(e,t){if(!Array.isArray(e)||e.length===0)throw new z(N.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function dp(e,t){const n=function(s,i){for(const a of s)for(const l of a.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(e.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(n!==null)throw n===t.op?new z(N.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new z(N.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}class uw{convertValue(t,n="none"){switch(Cn(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Vt(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,n);case 5:return t.stringValue;case 6:return this.convertBytes(Sn(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,n);case 11:return this.convertObject(t.mapValue,n);case 10:return this.convertVectorValue(t.mapValue);default:throw tt(62114,{value:t})}}convertObject(t,n){return this.convertObjectMap(t.fields,n)}convertObjectMap(t,n="none"){const r={};return Dn(t,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(t){var r,s,i;const n=(i=(s=(r=t.fields)==null?void 0:r[Fi].arrayValue)==null?void 0:s.values)==null?void 0:i.map(a=>Vt(a.doubleValue));return new qe(n)}convertGeoPoint(t){return new $e(Vt(t.latitude),Vt(t.longitude))}convertArray(t,n){return(t.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(t,n){switch(n){case"previous":const r=uo(t);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Ss(t));default:return null}}convertTimestamp(t){const n=Rn(t);return new St(n.seconds,n.nanos)}convertDocumentKey(t,n){const r=It.fromString(t);_t(Vd(r),9688,{name:t});const s=new Cs(r.get(1),r.get(3)),i=new Y(r.popFirst(5));return s.isEqual(n)||nn(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hw(e,t,n){let r;return r=e?e.toFirestore(t):t,r}class os{constructor(t,n){this.hasPendingWrites=t,this.fromCache=n}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class Gn extends up{constructor(t,n,r,s,i,a){super(t,n,r,s,a),this._firestore=t,this._firestoreImpl=t,this.metadata=i}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const n=new yi(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,n={}){if(this._document){const r=this._document.data.field(hp("DocumentSnapshot.get",t));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new z(N.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t=this._document,n={};return n.type=Gn._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!t||!t.isValidDocument()||!t.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(t.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Gn._jsonSchemaVersion="firestore/documentSnapshot/1.0",Gn._jsonSchema={type:Nt("string",Gn._jsonSchemaVersion),bundleSource:Nt("string","DocumentSnapshot"),bundleName:Nt("string"),bundle:Nt("string")};class yi extends Gn{data(t={}){return super.data(t)}}class Wn{constructor(t,n,r,s){this._firestore=t,this._userDataWriter=n,this._snapshot=s,this.metadata=new os(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const t=[];return this.forEach(n=>t.push(n)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,n){this._snapshot.docs.forEach(r=>{t.call(n,new yi(this._firestore,this._userDataWriter,r.key,r,new os(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const n=!!t.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new z(N.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map(l=>{const u=new yi(s._firestore,s._userDataWriter,l.doc.key,l.doc,new os(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:a++}})}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const u=new yi(s._firestore,s._userDataWriter,l.doc.key,l.doc,new os(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let f=-1,d=-1;return l.type!==0&&(f=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),l.type!==1&&(a=a.add(l.doc),d=a.indexOf(l.doc.key)),{type:fw(l.type),doc:u,oldIndex:f,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new z(N.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t={};t.type=Wn._jsonSchemaVersion,t.bundleSource="QuerySnapshot",t.bundleName=ll.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(n.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),t.bundle=(this._firestore,this.query._query,t.bundleName,"NOT SUPPORTED"),t}}function fw(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return tt(61501,{type:e})}}Wn._jsonSchemaVersion="firestore/querySnapshot/1.0",Wn._jsonSchema={type:Nt("string",Wn._jsonSchemaVersion),bundleSource:Nt("string","QuerySnapshot"),bundleName:Nt("string"),bundle:Nt("string")};class $l extends uw{constructor(t){super(),this.firestore=t}convertBytes(t){return new Ee(t)}convertReference(t){const n=this.convertDocumentKey(t,this.firestore._databaseId);return new Ot(this.firestore,null,n)}}function dw(e){e=Ue(e,er);const t=Ue(e.firestore,Xn),n=Nl(t),r=new $l(t);return fp(e._query),Qv(n,e._query).then(s=>new Wn(t,r,e,s))}function pw(e,t,n,...r){e=Ue(e,Ot);const s=Ue(e.firestore,Xn),i=kl(s);let a;return a=typeof(t=Ke(t))=="string"||t instanceof vo?sw(i,"updateDoc",e._key,t,n,r):rw(i,"updateDoc",e._key,t),ql(s,[a.toMutation(e._key,Ce.exists(!0))])}function mw(e){return ql(Ue(e.firestore,Xn),[new gl(e._key,Ce.none())])}function gw(e,t){const n=Ue(e.firestore,Xn),r=ka(e),s=hw(e.converter,t);return ql(n,[nw(kl(e.firestore),"addDoc",r._key,s,e.converter!==null,{}).toMutation(r._key,Ce.exists(!1))]).then(()=>r)}function _w(e,...t){var u,f,d;e=Ke(e);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof t[r]!="object"||yh(t[r])||(n=t[r++]);const s={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(yh(t[r])){const p=t[r];t[r]=(u=p.next)==null?void 0:u.bind(p),t[r+1]=(f=p.error)==null?void 0:f.bind(p),t[r+2]=(d=p.complete)==null?void 0:d.bind(p)}let i,a,l;if(e instanceof Ot)a=Ue(e.firestore,Xn),l=pl(e._key.path),i={next:p=>{t[r]&&t[r](yw(a,e,p))},error:t[r+1],complete:t[r+2]};else{const p=Ue(e,er);a=Ue(p.firestore,Xn),l=p._query;const g=new $l(a);i={next:v=>{t[r]&&t[r](new Wn(a,g,p,v))},error:t[r+1],complete:t[r+2]},fp(e._query)}return function(g,v,V,P){const x=new tp(P),$=new zd(v,x,V);return g.asyncQueue.enqueueAndForget(async()=>qd(await Ma(g),$)),()=>{x.Nu(),g.asyncQueue.enqueueAndForget(async()=>Hd(await Ma(g),$))}}(Nl(a),l,s,i)}function ql(e,t){return function(r,s){const i=new Tn;return r.asyncQueue.enqueueAndForget(async()=>Lv(await Wv(r),s,i)),i.promise}(Nl(e),t)}function yw(e,t,n){const r=n.docs.get(t._key),s=new $l(e);return new Gn(e,s,t._key,r,new os(n.hasPendingWrites,n.fromCache),t.converter)}(function(t,n=!0){(function(s){Vr=s})(Hy),Mi(new As("firestore",(r,{instanceIdentifier:s,options:i})=>{const a=r.getProvider("app").getImmediate(),l=new Xn(new sE(r.getProvider("auth-internal")),new aE(a,r.getProvider("app-check-internal")),function(f,d){if(!Object.prototype.hasOwnProperty.apply(f.options,["projectId"]))throw new z(N.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Cs(f.options.projectId,d)}(a,s),a);return i={useFetchStreams:n,...i},l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),Tr(wu,Iu,t),Tr(wu,Iu,"esm2020")})();var Ew="firebase",Tw="12.4.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Tr(Ew,Tw,"app");const vw={apiKey:"AIzaSyBBG7ZK4k0dcqKaVRn2AXRrHDfhBj4am8k",authDomain:"hospitalsite-4da7c.firebaseapp.com",projectId:"hospitalsite-4da7c",storageBucket:"hospitalsite-4da7c.firebasestorage.app",messagingSenderId:"720953153589",appId:"1:720953153589:web:1d8cf2c23cf689b8b4797c",measurementId:"G-LJ2NWGVCYQ"},ww=Nf(vw),Ei=Xv(ww),Iw={class:"map-container"},Aw={class:"map-header"},bw={class:"hospital-list"},Rw={class:"list-items"},Sw=["onClick"],Cw={class:"item-info"},Pw={class:"recruitment-count"},Vw={class:"year-badge"},Dw=["onClick"],xw={__name:"HospitalMap",props:{hospitals:{type:Array,default:()=>[]}},emits:["deleteHospital"],setup(e,{emit:t}){const n=e,r=t,s=ae(null),i=ae(null);let a=null,l=[],u=null;function f(){l.forEach(v=>v.setMap(null)),l=[]}function d(){if(!(!a||!u)&&(f(),n.hospitals.forEach(v=>{const V=new u.maps.LatLng(v.lat,v.lng),P=new u.maps.Marker({position:V,map:a}),x=`
			<div style="padding:6px 8px;white-space:nowrap">
				<strong>${v.HOSPITAL_NM}</strong><br/>
				${v.ADDR}<br/>
				모집인원: ${v.NUM}명
			</div>
		`,$=new u.maps.InfoWindow({content:x});u.maps.event.addListener(P,"click",()=>{$.open(a,P),p(v)}),l.push(P)}),n.hospitals.length>0)){const v=new u.maps.LatLngBounds;n.hospitals.forEach(V=>v.extend(new u.maps.LatLng(V.lat,V.lng))),a.setBounds(v)}}function p(v){var V;i.value=((V=i.value)==null?void 0:V.id)===v.id?null:v}function g(v){confirm(`${v.HOSPITAL_NM}을(를) 삭제하시겠습니까?`)&&r("deleteHospital",v)}return Za(async()=>{const{kakao:v}=await Di();a=new v.maps.Map(s.value,{center:new v.maps.LatLng(37.5665,126.978),level:7});const V=await dw(sp(Ei,"hospitalData")),P=new v.maps.LatLngBounds;for(const x of V.docs){const{ADDR:$,HOSPITAL_NM:W}=x.data(),Q=await u_($);if(!Q){console.warn(`주소 변환 실패: ${address}`);continue}const G=new v.maps.LatLng(Q.lat,Q.lng),ut=new v.maps.Marker({map:a,position:G});new v.maps.InfoWindow({content:`<div style="width:150px;text-align:center;padding:6px 0;">${W}</div>`}).open(a,ut),P.extend(G)}P.isEmpty()||a.setBounds(P)}),ro(()=>{f(),a=null,u=null}),ui(()=>n.hospitals,()=>{d()},{deep:!0}),(v,V)=>(ye(),be("div",Iw,[st("div",Aw,[V[0]||(V[0]=st("h3",null,"병원 위치",-1)),st("p",null,"총 "+Ae(e.hospitals.length)+"개 병원이 등록되어 있습니다",1)]),st("div",{ref_key:"mapEl",ref:s,class:"map"},null,512),st("div",bw,[V[1]||(V[1]=st("h4",null,"병원 목록",-1)),st("div",Rw,[(ye(!0),be(Ie,null,tf(e.hospitals,P=>{var x;return ye(),be("div",{key:P.id,class:Ji(["list-item",{selected:((x=i.value)==null?void 0:x.id)===P.id}]),onClick:$=>p(P)},[st("div",Cw,[st("strong",null,Ae(P.HOSPITAL_NM),1),st("span",null,Ae(P.ADDR),1),st("span",Pw,"모집인원: "+Ae(P.NUM)+"명",1),st("span",Vw,Ae(P.YEAR)+"년",1)]),st("button",{onClick:bf($=>g(P),["stop"]),class:"delete-btn"},"삭제",8,Dw)],10,Sw)}),128))])])]))}},Nw=rl(xw,[["__scopeId","data-v-da7f87a2"]]);function Ow(){const e=ae([]),t=ae(!1),n=ae(null),r=ae("2024"),s=sp(Ei,"hospitalData");let i=null;function a(){t.value=!0;const d=cw(s);i=_w(d,p=>{const g=[];p.forEach(v=>{g.push({id:v.id,...v.data()})}),e.value=g,t.value=!1},p=>{console.error("Firestore 데이터 읽기 오류:",p),n.value="데이터를 불러오는 중 오류가 발생했습니다.",t.value=!1})}async function l(d){try{t.value=!0,n.value=null;const p=await gw(s,d);return location.reload(),p.id}catch(p){throw console.error("병원 추가 오류:",p),n.value="병원을 추가하는 중 오류가 발생했습니다.",p}finally{t.value=!1}}async function u(d,p){try{t.value=!0,n.value=null;const g=ka(Ei,"hospitalData",d);await pw(g,p)}catch(g){throw console.error("병원 업데이트 오류:",g),n.value="병원을 업데이트하는 중 오류가 발생했습니다.",g}finally{t.value=!1}}async function f(d){const p=ka(Ei,"hospitalData",d);try{t.value=!0,n.value=null,await mw(p),location.reload()}catch(g){throw console.error("병원 삭제 오류:",g),n.value="병원을 삭제하는 중 오류가 발생했습니다.",g}finally{t.value=!1}}return Za(()=>{a()}),ro(()=>{i&&i()}),{hospitals:e,loading:t,error:n,selectedYear:r,addHospital:l,updateHospital:u,deleteHospital:f}}const Mw={class:"container"},kw={key:0,class:"error-message"},Lw={key:1,class:"loading-message"},Fw={class:"layout"},Uw={class:"left"},Bw={class:"right"},jw={__name:"App",setup(e){const{hospitals:t,addHospital:n,deleteHospital:r,loading:s,error:i}=Ow();async function a(u){try{await n(u),console.log("병원이 성공적으로 추가되었습니다.")}catch(f){console.error("병원 추가 실패:",f)}}async function l(u){try{await r(u.id),console.log("병원이 성공적으로 삭제되었습니다.")}catch(f){console.error("병원 삭제 실패:",f)}}return(u,f)=>(ye(),be("div",Mw,[f[1]||(f[1]=st("h1",null,"병원 지원 지도",-1)),es(i)?(ye(),be("div",kw,Ae(es(i)),1)):Si("",!0),es(s)?(ye(),be("div",Lw," 데이터를 불러오는 중... ")):Si("",!0),st("div",Fw,[st("section",Uw,[f[0]||(f[0]=st("h2",null,"병원 등록",-1)),Se(y_,{onAdded:a})]),st("section",Bw,[Se(Nw,{hospitals:es(t),onDeleteHospital:l},null,8,["hospitals"])])])]))}},$w=rl(jw,[["__scopeId","data-v-e7997c42"]]);o_($w).mount("#app");
